var jQuery,pq,JSZip;"function"==typeof require?(jQuery=require("jquery-ui-pack"),pq={},JSZip=require("jszip"),module.exports=pq):(jQuery=window.jQuery,pq=window.pq=window.pq||{},JSZip=window.JSZip),function(p){var t=p.ui.autocomplete.prototype,o=t._renderMenu,n=t._renderItem;t._renderMenu=function(t,e){o.call(this,t,e);var r,e=this.options.selectItem;e&&e.on&&(e=void 0===(e=e.cls)?"ui-state-highlight":e,(r=this.element.val())&&e&&p("a",t).filter(function(){return p(this).text()===r}).addClass(e))},t._renderItem=function(t,e){var r,o=n.call(this,t,e),i=this.options.highlightText;return i&&i.on&&((r=this.element.val())&&(t=new RegExp("("+r+")","i"),r=e.label,t.test(r)&&(e=void 0===(e=i.style)?"font-weight:bold;":e,i=void 0===(i=i.cls)?"":i,r=r.replace(t,"<span style='"+e+"' class='"+i+"'>$1</span>"),o.find("a").html(r)))),o};function f(t,e,r,o){for(var i=e.slice(),n=[],a=0,l=i.length;a<l;a++){var s=i[a],d=s.cb,h=s.one;if(h){if(s._oncerun)continue;s._oncerun=!0}if(!1===d.call(t,r,o)&&(r.preventDefault(),r.stopPropagation()),h&&n.push(a),r.isImmediatePropagationStopped())break}if(n.length)for(a=n.length-1;0<=a;a--)i.splice(n[a],1)}t=p.paramquery=p.paramquery||{};t._trigger=function(t,e,r){var o,i,n=this,a=n.listeners,l=a[t],s=n.options,d=s.allEvents,h=s.bubble,c=n.element,u=s[t];if(r=r||{},(e=p.Event(e)).type=n.widgetName+":"+t,e.target=c[0],i=e.originalEvent)for(o in i)o in e||(e[o]=i[o]);return d&&"function"==typeof d&&d.call(n,e,r),l&&l.length&&(f(n,l,e,r),e.isImmediatePropagationStopped())||s.trigger&&(c[h?"trigger":"triggerHandler"](e,r),e.isImmediatePropagationStopped())||(u&&!1===u.call(n,e,r)&&(e.preventDefault(),e.stopPropagation()),(l=a[t+"Done"])&&l.length&&f(n,l,e,r)),!e.isDefaultPrevented()};t.on=function(){var t,e,r,o,i=arguments;o="boolean"==typeof i[0]?(t=i[0],e=i[1],r=i[2],i[3]):(e=i[0],r=i[1],i[2]);for(var n,a,l,s,d=e.split(" "),h=0;h<d.length;h++){var c=d[h];c&&(n=c,a=r,l=o,s=t,((c=this).listeners[n]||(c.listeners[n]=[]))[s?"unshift":"push"]({cb:a,one:l}))}return this},t.one=function(){for(var t=arguments.length,e=[],r=0;r<t;r++)e[r]=arguments[r];return e[t]=!0,this.on.apply(this,e)};t.off=function(t,e){for(var r=t.split(" "),o=0;o<r.length;o++){var i=r[o];i&&function(t,e,r){if(r){var o=t.listeners[e];if(o){for(var i=[],n=0,a=o.length;n<a;n++)r==o[n].cb&&i.push(n);if(i.length)for(n=i.length-1;0<=n;n--)o.splice(i[n],1)}}else delete t.listeners[e]}(this,i,e)}return this};t={options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var t=p(this),e=t.closest(".pq-grid").pqGrid("getInstance").grid,r=e.getCellIndices({$td:t}),o=r.rowIndx,r=r.dataIndx,o=e.data({rowIndx:o,dataIndx:r,data:"pq_valid"}).data;if(o){r=o.icon,o=o.msg;return(""==r?"":"<span class='ui-icon "+r+" pq-tooltip-icon'></span>")+(o=null!=o?o:"")}return t.attr("title")}},_create:function(){this._super();var t=this.element,e=this.eventNamespace;t.on("pqtooltipopen"+e,function(t,e){var r,o=p(t.target),i=p(t.originalEvent.target);i.on("remove",function(t){o.pqTooltip("close",t,!0)}),o.is(".pq-grid")&&(t=(r=o.pqGrid("getCellIndices",{$td:i})).rowIndx,r=r.dataIndx,(t=o.pqGrid("getRowData",{rowIndx:t}))&&(t=t.pq_celldata)&&(t=t[r])&&(t=t.pq_valid)&&(t=(r=t).style,r=r.cls,e.tooltip.addClass(r),r=e.tooltip.attr("style"),e.tooltip.attr("style",r+";"+t)),o.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(t,e){t.currentTarget=i[0],o.pqTooltip("close",t,!0)}))}),t.on("pqtooltipclose"+e,function(t,e){var r=p(t.target);p(t.originalEvent.target).off("remove"),r.is(".pq-grid")&&r.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})}};p.widget("paramquery.pqTooltip",p.ui.tooltip,t)}(jQuery),function(d){var r,t=d.paramquery,e=Array.prototype;e.find||(e.find=function(t,e){for(var r,o=0,i=this.length;o<i;o++)if(r=this[o],t.call(e,r,o,this))return r}),e.findIndex||(e.findIndex=function(t,e){for(var r,o=0,i=this.length;o<i;o++)if(r=this[o],t.call(e,r,o,this))return o;return-1}),e.map||(e.map=function(t,e){for(var r=0,o=this.length,i=[];r<o;r++)i.push(t.call(e,this[r],r,this));return i}),e.forEach||(e.forEach=function(t,e){for(var r=0,o=this.length;r<o;r++)t.call(e,this[r],r,this)}),pq.getFn=(r={},function(t){var e=t;return"string"==typeof t&&((e=r[t])||(e=window,t.split(".").forEach(function(t){e=e[t]}),r[t]=e)),e}),pq.searchSeqArray=function(t,e){for(var r,o=t.length,i=e,n=0,a=o-1<(a=e)?o-1:a;;){if(n++,(r=t[a])<e){if(a==o-1){a=-1;break}a=o-1<(a=Math.ceil((a+i)/2))?o-1:a}else{if(!(e<r))break;i=a,a=Math.floor(a/2)}if(100<n)throw"too many iterations"}return a},pq.arrayUnique=function(t,e){for(var r,o,i=[],n=t.length,a={},l=0;l<n;l++)r=t[l],o=e?r[e]:r,a.hasOwnProperty(o)||(a[o]=1,i.push(r));return i},t.select=function(t){var e,r=t.attr,o=t.options,i=t.groupIndx,n=t.labelIndx,a=t.valueIndx,l=null!=n&&null!=a,s=null!=i,d=t.prepend,h=t.dataMap,c=["<select ",r," >"];if(d)for(var u in d)c.push('<option value="',u,'">',d[u],"</option>");if(o&&o.length){for(var p=0,f=o.length;p<f;p++){var g=o[p];if(l){var v,w,m,x=g[a],_=g.pq_disabled?'disabled="disabled" ':"",I=g.pq_selected?'selected="selected" ':"";null!=x&&(m=h?function(){for(var t={},e=0;e<h.length;e++){var r=h[e];t[r]=g[r]}return"data-map='"+JSON.stringify(t)+"'"}():"",s&&(v=g.pq_disabled_group?'disabled="disabled" ':"",e!=(w=g[i])&&(null!=e&&c.push("</optgroup>"),c.push('<optgroup label="',w,'" ',v," >"),e=w)),n==a?c.push("<option ",I,_,m,">",x,"</option>"):(w=g[n],c.push("<option ",I,_,m,' value="',x,'">',w,"</option>")))}else if("object"==typeof g)for(var u in g)c.push('<option value="',u,'">',g[u],"</option>");else c.push("<option>",g,"</option>")}s&&c.push("</optgroup>")}return c.push("</select>"),c.join("")},d.fn.pqval=function(t){if(t){if(t.incr){var e=this.data("pq_value");return this.prop("indeterminate",!1),e?this.prop("checked",e=!1):!1===e?(this.prop("indeterminate",!(e=null)),this.prop("checked",!1)):this.prop("checked",e=!0),this.data("pq_value",e),e}e=t.val;return this.data("pq_value",e),this.prop("indeterminate",!1),null==e?(this.prop("indeterminate",!0),this.prop("checked",!1)):e?this.prop("checked",!0):this.prop("checked",!1),this}return this.data("pq_value")},t.xmlToArray=function(t,e){var r=e.itemParent,i=e.itemNames,n=[];return d(t).find(r).each(function(t,e){var r=d(e),o=[];d(i).each(function(t,e){o.push(r.find(e).text().replace(/\r|\n|\t/g,""))}),n.push(o)}),n},t.xmlToJson=function(t,e){var r=e.itemParent,l=e.itemNames,s=[];return d(t).find(r).each(function(t,e){for(var r=d(e),o={},i=0,n=l.length;i<n;i++){var a=l[i];o[a]=r.find(a).text().replace(/\r|\n|\t/g,"")}s.push(o)}),s},t.tableToArray=function(t){var e=d(t),i=[],o=[],t=e.children("tbody").children("tr"),e=t.length?d(t[0]):d(),n=1<t.length?d(t[1]):d();return e.children("th,td").each(function(t,e){var r=d(e),o=r.html(),e=r.width(),r="left";n.length&&(r=n.find("td:eq("+t+")").attr("align")||r),i.push({title:o,width:e,dataType:"string",align:r,dataIndx:t})}),t.each(function(t,e){var r;0!=t&&(e=d(e),r=[],e.children("td").each(function(t,e){r.push(d.trim(d(e).html()))}),o.push(r))}),{data:o,colModel:i}};var p={};t.formatCurrency=function(t,e){var r=parseFloat(t);if(!isNaN(r)){for(var o=r<0,i=function(t,e){var r,o;if(t){if(o=t.split(":"),t=e&&1<o.length?o[1]:o[0],r=p[t])return r;(o=t.match(/^([^#]*|&#[^#]*)?[\,\.#0]*?([\,\s\.]?)([#0]*)([\,\s\.]?)([0]*?)(\s*[^#^0]*|&#[^#]*)?$/))&&o.length&&(r={symbol:o[1]||"",thouSep:o[2],thousand:o[3].length,decSep:o[4],decimal:o[5].length,symbolEnd:o[6]||""},p[t]=r)}return r=r||{symbol:"",symbolEnd:"",thouSep:",",thousand:3,decSep:".",decimal:2}}(e,o),n=i.symbol,a=i.symbolEnd,l=i.thousand,s=i.thouSep,d=i.decSep,t=i.decimal,e=(r=r.toFixed(t)).length,i=t+d.length,t=r.substring(0,e-i),e=r.substring(e-i+d.length,e),h=t.match(/\d/g).reverse(),c=[],u=0;u<h.length;u++)0<u&&u%l==0&&c.push(s),c.push(h[u]);return(o?"-":"")+n+(t=(c=c.reverse()).join(""))+d+e+a}},pq.formatNumber=t.formatCurrency,pq.validation={is:function(t,e){return"string"==t||!t||this["is"+(t=t.substring(0,1).toUpperCase()+t.substring(1,t.length))](e)},isFloat:function(t){var e=parseFloat(t);return!isNaN(e)&&e==t},isInteger:function(t){var e=parseInt(t);return!isNaN(e)&&e==t},isDate:function(t){t=Date.parse(t);return!isNaN(t)}};var i=[],n={},l=t.toLetter=function(t){var e,r,o=i[t];return o||(r=++t%26,e=t/26|0,r=r?String.fromCharCode(64+r):(--e,"Z"),o=e?l(e-1)+r:r,i[--t]=o,n[o]=t),o};t.generateData=function(t,e){for(var r=[],o=0;o<e;o++)r[o]=l(o);for(var i=[],o=0;o<t;o++)for(var n=i[o]=[],a=0;a<e;a++)n[a]=r[a]+(o+1);return i}}(jQuery),function(c){var t={};function n(t,e,r){return c(t?"<span tabindex='0' rel='tooltip' data-placement='top' title='"+e+"' class='btn btn-xs "+r+"'></span>":"<span class='pq-ui-button ui-widget-header' tabindex='0' rel='tooltip' title='"+e+"'><span class='ui-icon ui-icon-"+r+"'></span></span>")}function a(t,e){t.bind("click keydown",function(t){if("keydown"!=t.type||t.keyCode==c.ui.keyCode.ENTER)return e.call(this,t)})}function u(t,e,r){e[r?"addClass":"removeClass"]("disabled").css("pointer-events",r?"none":"").attr("tabindex",r?"":"0")}t.options={bootstrap:{on:!1,pager:"",nextIcon:"glyphicon glyphicon-forward",prevIcon:"glyphicon glyphicon-backward",firstIcon:"glyphicon glyphicon-step-backward",lastIcon:"glyphicon glyphicon-step-forward",refreshIcon:"glyphicon glyphicon-refresh"},curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},t._regional={strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"},c.extend(t.options,t._regional),t._create=function(){var r=this,o=this.options,t=this.element,e=o.bootstrap,i=e.on;this.listeners={},t.addClass("pq-pager "+(i?e.pager:"")),this.first=n(i,o.strFirstPage,i?e.firstIcon:"seek-first").appendTo(t),a(this.first,function(t){1<o.curPage&&r._onChange(t,1)}),this.prev=n(i,o.strPrevPage,i?e.prevIcon:"seek-prev").appendTo(t),a(this.prev,function(t){var e;1<o.curPage&&(e=o.curPage-1,r._onChange(t,e))}),c("<span class='pq-separator'></span>").appendTo(t),this.pageHolder=c("<span class='pq-page-placeholder'></span>").appendTo(t),c("<span class='pq-separator'></span>").appendTo(t),this.next=n(i,o.strNextPage,i?e.nextIcon:"seek-next").appendTo(t),a(this.next,function(t){var e;o.curPage<o.totalPages&&(e=o.curPage+1,r._onChange(t,e))}),this.last=n(i,o.strLastPage,i?e.lastIcon:"seek-end").appendTo(t),a(this.last,function(t){var e;o.curPage!==o.totalPages&&(e=o.totalPages,r._onChange(t,e))}),c("<span class='pq-separator'></span>").appendTo(t),this.rPPHolder=c("<span class='pq-page-placeholder'></span>").appendTo(t),this.$refresh=n(i,o.strRefresh,i?e.refreshIcon:"refresh").appendTo(t),a(this.$refresh,function(t){return!1!==r._trigger("beforeRefresh",t)&&void r._trigger("refresh",t)}),c("<span class='pq-separator'></span>").appendTo(t),this.$msg=c("<span class='pq-pager-msg'></span>").appendTo(t),this._refresh()},t._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()},t._setOption=function(t,e){this._super(t,e="curPage"==t||"totalPages"==t?+e:e)},t._setOptions=function(t){var e,r=!1,o=this.options;for(e in t){var i=t[e],n=typeof i;"string"!=n&&"number"!=n&&("function"==typeof i.splice||c.isPlainObject(i))?JSON.stringify(i)!=JSON.stringify(o[e])&&(this._setOption(e,i),r=!0):i!=o[e]&&(this._setOption(e,i),r=!0)}return r&&this._refresh(),this},c.widget("paramquery.pqPager",t),pq.pager=function(t,e){e=c(t).pqPager(e);return e.data("paramqueryPqPager")||e.data("paramquery-pqPager")};var e=c.paramquery;e.pqPager.regional={},e.pqPager.regional.en=t._regional,t=e.pqPager.prototype,e.pqPager.defaults=t.options,t._refreshPage=function(){var o=this;this.pageHolder.empty();for(var i=this.options,t=i.bootstrap,e=i.strPage.split(/\s/),r=[],n=0,a=e.length;n<a;n++){var l=e[n];"{0}"==l?r.push("<input type='text' tabindex='0' class='pq-pager-input ",t.on?"":"ui-corner-all","' />"):"{1}"==l?r.push("<span class='total'></span>"):r.push("<span>",l,"</span>")}var s=r.join(""),s=c(s).appendTo(this.pageHolder);this.page=s.filter("input").bind("keydown",function(t){t.keyCode===c.ui.keyCode.ENTER&&c(this).trigger("change")}).bind("change",function(t){var e=c(this),r=e.val();return isNaN(r)||r<1||(r=parseInt(r))!==i.curPage&&(r>i.totalPages||!1===o._onChange(t,r))?(e.val(i.curPage),!1):void 0}),this.$total=s.filter("span.total")},t._onChange=function(t,e){return!1!==this._trigger("beforeChange",t,{curPage:e})&&(!1!==this._trigger("change",t,{curPage:e})&&void this.option({curPage:e}))},t._refresh=function(){this._refreshPage();this.$rPP;var o=this,t=this.options,e=t.bootstrap;if(this.rPPHolder.empty(),t.strRpp){var r=t.rPPOptions;if(-1!=(h=t.strRpp).indexOf("{0}")){for(var i=["<select class='",e.on?"":"ui-corner-all","'>"],n=0,a=r.length;n<a;n++){var l=r[n];i.push('<option value="',l,'">',l,"</option>")}i.push("</select>");var s=i.join("");h="<span>"+(h=h.replace("{0}","</span>"+s))+"<span class='pq-separator'></span>"}else h="<span>"+h+"</span><span class='pq-separator'></span>";this.$rPP=c(h).appendTo(this.rPPHolder).filter("select").val(t.rPP).change(function(t){var e=c(this),r=e.val();if(!1===o._trigger("beforeChange",t,{rPP:r}))return e.val(o.options.rPP),!1;!1!==o._trigger("change",t,{rPP:r})&&(o.options.rPP=r)})}t.bootstrap.on;var d=t.curPage>=t.totalPages;u(0,this.next,d),u(0,this.last,d);var h,d=t.curPage<=1;u(0,this.first,d),u(0,this.prev,d),this.page.val(t.curPage),this.$total.text(t.totalPages),0<this.options.totalRecords?(e=t.rPP,s=t.curPage,(h=t.totalRecords)<(d=s*e)&&(d=h),t=(t=(t=(t=t.strDisplay).replace("{0}",1+(s-1)*e)).replace("{1}",d)).replace("{2}",h),this.$msg.html(t)):this.$msg.html("")},t.getInstance=function(){return{pager:this}},t._trigger=e._trigger,t.on=e.on,t.one=e.one,t.off=e.off}(jQuery),function(c){var t=c.paramquery,e={options:{length:200,num_eles:3,trigger:!1,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",bootstrap:{on:!1,slider:"btn btn-default",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",left:"glyphicon glyphicon-chevron-left",right:"glyphicon glyphicon-chevron-right"},theme:!1},_destroy:function(){c(document).off("."+this.eventNamespace),this.element.removeClass("pq-sb pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty(),this.element.removeData()},_create:function(){this.listeners={},this._createLayout()},_setOption:function(t,e){var r=this.options;"disabled"==t?(this._super(t,e),1==e?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==t?(r[t]=e,this._createLayout()):("ratio"!=t||0<=e&&e<=1)&&(r[t]=e)},_setOptions:function(){this._super.apply(this,arguments),this.refresh()}};c.widget("paramquery.pqScrollBar",e),pq.scrollbar=function(t,e){e=c(t).pqScrollBar(e);return e.data("paramqueryPqScrollBar")||e.data("paramquery-pqScrollBar")};e=t.pqScrollBar.prototype;function i(t,e){return t?"<div class='"+e+"'></div>":"<div class='ui-icon ui-icon-"+e+"'></div>"}t.pqScrollBar.defaults=e.options,e._createLayout=function(){var l=this,s=this.options,t=s.bootstrap,e=t.on,d=s.direction,h=this.eventNamespace,r=s.theme,o=this.element.empty();"vertical"==d?(o.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb pq-sb-vert"),r?(o.addClass("pq-sb-vert-t"),o[0].innerHTML=["<div class='top-btn pq-sb-btn ",e?"":"ui-state-default ui-corner-top","'>",i(e,e?t.up:"triangle-1-n"),"</div>","<div class='pq-sb-slider ",e?t.slider:"ui-corner-all ui-state-default","'>","</div>","<div class='bottom-btn pq-sb-btn ",e?"":"ui-state-default ui-corner-bottom","'>",i(e,e?t.down:"triangle-1-s"),"</div>"].join("")):(o.addClass("pq-sb-vert-wt"),o[0].innerHTML=["<div class='top-btn pq-sb-btn'></div>","<div class='pq-sb-slider'>","<div class='vert-slider-top'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-center'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-bottom'></div>","</div>","<div class='bottom-btn pq-sb-btn'></div>"].join(""))):(o.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb pq-sb-horiz"),r?(o.addClass("pq-sb-horiz-t"),o[0].innerHTML=["<div class='left-btn pq-sb-btn ",e?"":"ui-state-default ui-corner-left","'>",i(e,e?t.left:"triangle-1-w"),"</div>","<div class='pq-sb-slider pq-sb-slider-h ",e?t.slider:"ui-state-default ui-corner-all","'>","</div>","<div class='right-btn pq-sb-btn ",e?"":"ui-state-default ui-corner-right","'>",i(e,e?t.right:"triangle-1-e"),"</div>"].join("")):(o.addClass("pq-sb-horiz-wt"),o.width(this.width),o[0].innerHTML=["<div class='left-btn pq-sb-btn'></div>","<div class='pq-sb-slider pq-sb-slider-h'>","<span class='horiz-slider-left'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-center'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-right'></span>","</div>","<div class='right-btn pq-sb-btn'></div>"].join(""))),o.disableSelection().unbind(".pq-scrollbar").on("mousedown.pq-scrollbar",function(t){var e,r,o,i,n,a;s.disabled||l.$slider.is(":hidden")||(c(document).off("."+h).on("mouseup."+h,function(t){l._mouseup(t)}),"vertical"==d?(e=t.pageY,i=(o=l.element.offset().top)+s.length,a=(n=(a=l.$slider).offset().top)+(r=a.height()),e<n&&o+17<e?l._setTimerPageLeft(e,r,t,0):a<e&&e<i-17&&l._setTimerPageRight(e,r,t,0)):(r=t.pageX,i=(o=l.element.offset().left)+s.length,a=(n=l.$slider.offset().left)+l.$slider.width(),r<n&&o+17<r?(l.$slider.css("left",r-l.element.offset().left),l._updateCurPosAndTrigger(t)):a<r&&r<i-17&&(l.$slider.css("left",r-l.element.offset().left-l.$slider.width()),l._updateCurPosAndTrigger(t))))});o=this.$slider=c("div.pq-sb-slider",this.element);o.attr("tabindex","0"),this._bindSliderEvents(o),this.$top_btn=c("div.top-btn,div.left-btn",this.element).click(function(t){if(!l.options.disabled)return l.decr_cur_pos(t),!1}).mousedown(function(t){if(!l.options.disabled)return l.mousedownTimeout=setTimeout(function(){l.mousedownInterval=setInterval(function(){l.decr_cur_pos(t)},0)},l.options.timeout),!1}).bind("mouseup mouseout",function(t){l._mouseup(t)}),this.$bottom_btn=c("div.bottom-btn,div.right-btn",this.element).click(function(t){if(!l.options.disabled)return l.incr_cur_pos(t),!1}).mousedown(function(t){if(!l.options.disabled)return l.mousedownTimeout=setTimeout(function(){l.mousedownInterval=setInterval(function(){l.incr_cur_pos(t)},0)},l.options.timeout),!1}).bind("mouseup mouseout",function(t){l._mouseup(t)}),this.refresh()};var a=0;e._setTimerPageLeft=function(e,r,o,t){var i=this,n=i.options;this.mousedownTimeout=window.setTimeout(function(){var t;e>=i.$slider.offset().top?i._mouseup():(i._pageLeft(o),t=a?0:n.timeout,a++,i._setTimerPageLeft(e,r,o,t))},t)},e._setTimerPageRight=function(e,r,o,t){var i=this;this.mousedownTimeout=window.setTimeout(function(){var t;e<=i.$slider.offset().top+r?i._mouseup():(i._pageRight(o),t=a?0:i.options.timeout,a++,i._setTimerPageRight(e,r,o,t))},t)},e._bindSliderEvents=function(t){var l=this,e="vertical"==this.options.direction?"y":"x";t.draggable({axis:e,helper:function(t,e){return l._setDragLimits(),this},start:function(t){l.topWhileDrag=null,l.dragging=!0},drag:function(t){l.dragging=!0;var e=l.options.pace;"optimum"==e?l._setNormalPace(t):"fast"==e&&l._updateCurPosAndTrigger(t)},stop:function(t){"fast"!=l.options.pace&&l._updateCurPosAndTrigger(t),l.dragging=!1,l.refresh()}}).on("keydown.pq-scrollbar",function(t){var e=t.keyCode,r=l.options,o=r.cur_pos,i=r.ratio,n=r.num_eles,a=c.ui.keyCode;if(null==l.keydownTimeout&&(l.keydownTimeout=window.setTimeout(function(){e==a.DOWN||e==a.RIGHT?l.incr_cur_pos(t):e==a.UP||e==a.LEFT?l.decr_cur_pos(t):e==a.HOME?r.steps?0<o&&(r.cur_pos=0,l.updateSliderPos(),l.scroll(t)):0<i&&(r.ratio=0,l.updateSliderPos(),l.drag(t)):e==a.END?r.steps?o<n&&(r.cur_pos=n,l.updateSliderPos(),l.scroll(t)):i<1&&(r.ratio=1,l.updateSliderPos(),l.drag(t)):"vertical"==r.direction&&(e==a.PAGE_DOWN?l._pageRight(t):e==a.PAGE_UP&&l._pageLeft(t)),l.keydownTimeout=null},0)),e==a.DOWN||e==a.RIGHT||e==a.UP||e==a.LEFT||e==a.PAGE_DOWN||e==a.PAGE_UP||e==a.HOME||e==a.END)return t.preventDefault(),!1})},e.decr_cur_pos=function(t){var e,r=this,o=r.options;o.steps?0<o.cur_pos&&(o.cur_pos--,r.updateSliderPos(),r.scroll(t)):0<o.ratio&&(e=o.ratio-1/(o.num_eles-1),o.ratio=e=e<0?0:e,r.updateSliderPos(),r.drag(t))},e.incr_cur_pos=function(t){var e,r=this,o=r.options;o.steps?(o.cur_pos<o.num_eles-1&&o.cur_pos++,r.updateSliderPos(),r.scroll(t)):(o.ratio<1&&(e=o.ratio+1/(o.num_eles-1),o.ratio=e=1<e?1:e),r.updateSliderPos(),r.drag(t))},e._mouseup=function(t){this.options.disabled||(a=0,window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),this.mousedownInterval=null)},e._setDragLimits=function(){var t,e,r=this.options;"vertical"==r.direction?(e=(t=this.element.offset().top+17)+r.length-34-this.slider_length,this.$slider.draggable("option","containment",[0,t,0,e])):(e=(t=this.element.offset().left+17)+r.length-34-this.slider_length,this.$slider.draggable("option","containment",[t,0,e,0]))},e._validateCurPos=function(){var t=this.options;t.cur_pos>=t.num_eles&&(t.cur_pos=t.num_eles-1),t.cur_pos<0&&(t.cur_pos=0)},e._updateSliderPosRatio=function(){var t=this.options,e=t.direction,r=t.ratio,o=this.$slider[0],t=t.length-34-this.slider_length;if(null==r)throw"updateSliderPosRatio ratio N/A";t=r*t+17;"vertical"==e?o.style.top=t+"px":o.style.left=t+"px"},e._updateSliderPosCurPos=function(){var t=this.options,e=this.$slider[0],r=this.scroll_space*t.cur_pos/(t.num_eles-1);"vertical"==t.direction?e.style.top=17+r+"px":e.style.left=17+r+"px"},e.updateSliderPos=function(){var t=this.options;if(void 0===t.steps)throw"updateSliderPos. steps N/A";t.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()},e.scroll=function(t){var e=this.options;this._trigger("scroll",t,{cur_pos:e.cur_pos,num_eles:e.num_eles})},e.drag=function(t){var e=this.options;this._trigger("drag",t,{ratio:e.ratio})},e._pageRight=function(t){this._trigger("pageRight",t,null)},e._pageLeft=function(t){this._trigger("pageLeft",t,null)},e._setSliderBgLength=function(){var t=this.options,e=t.theme,r=this.$slider,o=t.length,i=40*t.num_eles+o,o=Math.round(((o-34)*o/i-14)/2),i=14+2*(o=o<1?1:o);this.scroll_space=t.length-34-i,i!==this.slider_length&&(this.slider_length=i,t="vertical"===t.direction?{dim:"height",cls:".vert-slider-bg"}:{dim:"width",cls:".horiz-slider-bg"},e?r[t.dim](i-2):(c(t.cls,this.element)[t.dim](o),r[t.dim](i)))},e._updateCurPosAndTrigger=function(t,e){var r=this.options,o=r.direction,i=this.$slider,i=((e=null==e?parseInt(i[0].style["vertical"===o?"top":"left"]):e)-17)/(r.length-34-this.slider_length);if(r.steps){o=i*(r.num_eles-1),o=Math.round(o);if(r.cur_pos!=o){if(this.dragging){if(null!=this.topWhileDrag){if(this.topWhileDrag<e&&r.cur_pos>o)return;if(this.topWhileDrag>e&&r.cur_pos<o)return}this.topWhileDrag=e}this.options.cur_pos=o,this.scroll(t)}}else r.ratio=i,this.drag(t)},e._setNormalPace=function(e){this.timer&&(window.clearInterval(this.timer),this.timer=null);var r=this,o=this.options.direction;r.timer=window.setInterval(function(){var t=r.$slider,t=parseInt(t[0].style["vertical"===o?"top":"left"]);r.prev_top===t&&(r._updateCurPosAndTrigger(e,t),window.clearInterval(r.timer),r.timer=null),r.prev_top=t},20)},e.refresh=function(){var t=this.options,e=this.$slider[0],r=this.element;t.num_eles<=1?r[0].style.display="none":(r[0].style.display="",this._validateCurPos(),this.dragging||(r["vertical"===t.direction?"height":"width"](t.length),this._setSliderBgLength(),this.scroll_space<4||t.num_eles<=1?e.style.display="none":e.style.display=""),this.updateSliderPos())},e._trigger=t._trigger,e.on=t.on,e.one=t.one,e.off=t.off}(jQuery),function(a){a.paramquery=a.paramquery||{},a.paramquery.onResize=function(t,e){var r=a(t);"static"===r.css("position")&&r.css("position","relative");var o=a('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(r);o[0].data="about:blank",o.css("opacity","0");for(var i=0;i<r.length;i++){var n=o[i];a(n.contentWindow).on("resize",function(t){e()})}}}(jQuery),function(z){var t=function(){};t.prototype.belongs=function(t){if(t.target==this.that.element[0])return!0};var W=z.paramquery;W.cClass=t;function g(t){this.that=t;var e=this.options=t.options,r=this;null!=e.postRenderInterval&&t.on("refresh",function(){r.prColDef.length&&r.postRenderAll()}).on("refreshRow",function(t,e){r.prColDef.length&&r.postRenderRow(e)}).on("refreshCell",function(t,e){e.column.postRender&&r.postRenderRow(e)}).on("refreshColumn",function(t,e){e.column.postRender&&r.setTimerPostRender(0,e.colIndx,e.column)}),e.mergeModel.flex||t.on("refresh refreshCell refreshRow refreshColumn",r.onRefreshMerge(t))}var o,i,e=(W.cGenerateView=g).prototype=new t;e.onRefreshMerge=function(d){return function(){for(var t,e,r,o,i,n=d.$cont.find(".pq-merge-cell-div"),a=n.length,l=[],s=[];a--;)i=(t=n[a]).parentNode,e||(e=2*parseInt(z(i).css("paddingTop")),r=2*parseInt(z(i).css("paddingLeft"))),o=Math.max(i.offsetHeight,28),i=i.offsetWidth-r,l[a]=o-e-1+"px",s[a]=i+"px";for(a=n.length;a--;)(t=n[a]).style.height=l[a],t.style.width=s[a]}},e.generateView=function(t){var e,r,o,i,n=this.that,a=n.options,l="flex"===a.width,s="flex"===a.height,d=a.cls,h=d.cont_inner,c=d.cont_inner_b,u=n.initH,p=n.finalH,f=n.pqpanes;(t=t||{}).$cont?(i=this._generateTables(null,null,t),(o=t.$cont).empty(),f.v?o[0].innerHTML=["<div class='",h,"'>",i,"</div>","<div class='",h,"'>",i,"</div>"].join(""):o[0].innerHTML=["<div class='",h,"'>",i,"</div>"].join(""),r=o.children("div").children("table"),n.tables[0]={$tbl:r,$cont:o}):(e=n.initV,d=n.finalV,r=n.pdata,o=n.$cont,null!=a.editModel.indices&&n.blurEditor({force:!0}),p={pageData:r,initV:e,finalV:d,initH:u,finalH:p,source:t.source},n._trigger("beforeTableView",null,p),i=this._generateTables(e,d,t),o.empty(),0===n.totalVisibleRows?o.append("<div class='"+h+" pq-grid-norows' >"+a.strNoRows+"</div>"):(l=s||l?"style='position:relative;'":"",f.h&&f.v?o[0].innerHTML=["<div class='",h,"'>",i,"</div>","<div class='",h,"'>",i,"</div>","<div class='",h," ",c,"'>",i,"</div>","<div class='",h," ",c,"'>",i,"</div>"].join(""):f.v?o[0].innerHTML=["<div class='",h,"' ",l," >",i,"</div>","<div class='",h,"' >",i,"</div>"].join(""):f.h?o[0].innerHTML=["<div class='",h,"' style='position:static;' >",i,"</div>","<div class='",h," ",c,"' style='position:static;' >",i,"</div>"].join(""):o[0].innerHTML=["<div class='",h,"' ",l," >",i,"</div>"].join("")),n.$tbl=o.children("div").children("table"),a.scrollModel.flexContent&&n.$tbl[0]&&W.onResize(n.$tbl[0],function(){var t=n.iRefresh;t.ignoreTResize||t.softRefresh()}),this.setPaneEvents(),n._trigger("refresh",null,p)),this.setPanes()},e.postRenderRow=function(t){for(var e=this.that,r=this.prColDef,o=e.iMerge,i=t.rowIndx,n=e,a=0,l=(r=null!=t.colIndx?[{colIndx:t.colIndx,column:t.column}]:r).length;a<l;a++){var s=r[a],d=s.column.postRender,s=s.colIndx;o.ismergedCell(i,s)?o.isRootCell(i,s,"a")&&(t=o.getRootCell(i,s),d.call(n,t)):(t=e.normalize({rowIndx:i,colIndx:s}),d.call(n,t))}},e.setTimerPostRender=function(r,o,i){var t,n=this.that,a=this,l=n.pdata;l&&l.length&&(a.postRenderTimeoutID=(t=function(){var t=n.initV,e=n.options.freezeRows;l[r=r<t&&e<=r?t:r].pq_hidden||a.postRenderRow({column:i,colIndx:o,rowIndx:r+n.rowIndxOffset}),++r<=n.finalV&&a.setTimerPostRender(r)},-1==n.options.postRenderInterval?t():setTimeout(t,0)))},e.postRenderAll=function(){var t,e=this.that,r=this,o=e.pdata,i=e.options.postRenderInterval;o&&o.length&&(clearTimeout(r.postRenderTimeoutID),r.postRenderTimeoutID=(t=function(){r.setTimerPostRender(0)},-1==i?t():setTimeout(t,i)))},e.scrollView=function(){var t=this.that,e=this.options,r=e.virtualX,e=e.virtualY;r||t.hscroll.drag(),e||t.vscroll.drag()},e.setPaneEvents=function(){var t,e,r=this.that,o=r.$cont,i=r.pqpanes,n=o.children("div"),a=r.iMouseSelection,l=r.$tbl;l&&l.length&&(i.h&&i.v?(o=z(n[0]),r=z(n[1]),l=z(n[2]),t=z(n[3]),o.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=0}),r.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=a.getScrollLeft(!0)}),l.on("scroll",function(t){this.scrollTop=a.getScrollTop(!0),this.scrollLeft=0}),t.on("scroll",function(t){this.scrollTop=a.getScrollTop(!0),this.scrollLeft=a.getScrollLeft(!0)})):i.v?(t=z(n[0]),e=z(n[1]),t.on("scroll",function(t){this.scrollTop=a.getScrollTop(!0),this.scrollLeft=0}),e.on("scroll",function(t){this.scrollTop=a.getScrollTop(!0),this.scrollLeft=a.getScrollLeft(!0)})):i.h?(e=z(n[0]),i=z(n[1]),e.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=a.getScrollLeft(!0)}),i.on("scroll",function(t){this.scrollTop=a.getScrollTop(!0),this.scrollLeft=a.getScrollLeft(!0)})):n.on("scroll",function(t){this.scrollTop=a.getScrollTop(!0),this.scrollLeft=a.getScrollLeft(!0)}))},e.setPanes=function(){var t,e,r,o,i,n,a,l,s=this.that,d=s.$cont,h=s.pqpanes,c=d.children("div"),u=s.iRefresh,p=s.$tbl,f=s.options,g=+f.freezeCols,v=(s.initH,s.calcWidthCols(-1,g)+1),w="flex"===f.width&&!f.maxWidth?"":u.getEContWd();s.tables.length&&(o=s.tables[0].$tbl,r=s.tables[0].$cont,e=o.parent("div"),h.v?(z(e[0]).css({width:v}),z(e[1]).css({left:v,width:w-v}),z(o[1]).css({left:-1*v})):z(e[0]).css({width:w}),r.height(o[0].scrollHeight-1),u.setContHeight()),p&&p.length&&(t="flex"===f.height&&!f.maxHeight?"":u.getEContHt(),h.h&&h.v?(d=z(c[0]),g=z(c[1]),e=z(p[1]),r=z(c[2]),o=z(p[2]),u=z(c[3]),i=z(p[3]),l=s.calcHeightFrozenRows(),d.css({width:v,height:l}),g.css({left:v,width:w-v,height:l}),e.css({left:-1*v}),r.css({width:v,top:l,height:t-l}),o.css({marginTop:-(l+1)}),u.css({left:v,width:w-v,top:l,height:t-l}),i.css({marginTop:-(l+1),left:-1*v})):h.v?(i=z(c[0]),n=z(c[1]),a=z(p[1]),i.css({width:v,height:t}),n.css({left:v,width:w-v,height:t}),a.css({left:-1*v})):h.h?(n=z(c[0]),a=z(c[1]),p=z(p[1]),l=s.calcHeightFrozenRows(),n.css({height:l,width:w}),a.css({width:w,top:l,height:t-l}),p.css({marginTop:-(l+1)})):c.css({width:w,height:t})),f.showHeader&&(h.vH?(s.$header_left.css({width:v}),s.$header_right.css({left:v,width:w-v}),s.$header_right_inner.css({left:-v})):s.$header_left.css({width:w}))},e.createColDefs=function(){for(var t=this.that,e=t.colModel,r=t.initH,o=t.finalH,i=t.options.freezeCols,n=[],a=[],l=0;l<=o;l++){if(l<r&&i<=l&&o<(l=r))throw"initH>finalH";var s=e[l];s.hidden||(n.push({column:s,colIndx:l}),s.postRender&&"function"==typeof s.postRender&&a.push({column:s,colIndx:l}))}this.colDef=n,this.prColDef=a},e._generateTables=function(t,e,r){var o,i=this.that,n=i.options,a=n.bootstrap,l=n.numberCell,s=i.iRefresh,d=+n.freezeRows,h=0,c=(r=r||{}).other,u=c?r.data.length-1:e;if(c?o=r.data:(o=i.pdata,this.setFrozenRip(o,d)),c||null!=t&&null!=u){this.vrows=s.vrows,this.vfrows=s.vfrows;s=["pq-grid-table"];a.on&&s.push(a.tbody),n.columnBorders&&s.push("pq-td-border-right"),n.rowBorders&&s.push("pq-td-border-top"),s.push(n.wrap?"pq-wrap":"pq-no-wrap");var p=["<table class='"+s.join(" ")+"' >"];p.push("<tr class='pq-row-hidden'>"),l.show&&(x=l.width,p.push("<td style='width:"+x+"px;' ></td>"));for(var f=this.colDef,g=0,v=f.length;g<v;g++){var w=f[g],m=w.colIndx,x=w.column.outerWidth;p.push("<td style='width:",x,"px;' pq-col-indx='",m,"'></td>")}p.push("</tr>");for(h=0;h<=u;h++){var _,I=o[h=h<t&&d<=h?t:h],y=h;!!I&&I.pq_hidden||(_=I.pq_detail&&I.pq_detail.show,this._generateRow(I,y,p,c,_),_&&this._generateDetailRow(I,y,p))}return p.push("</table>"),p.join("")}},e.appendRow=function(t){var e=this.that,r=e.pdata,o=e.colModel,i=e.finalV;if(t=i+t>r.length?r.length-i:t){if(1<t)throw"noRows > 1";e._trigger("beforeTableView",null,{pageData:r,initV:i,finalV:i,initH:e.initH,finalH:e.finalH,colModel:o}),e.refreshRow({rowIndxPage:i,refresh:!1})}return t},e.prependRow=function(t){var e=this.that,r=e.options.freezeRows,o=e.calcVisibleRows(e.pdata,0,r),i=e.pdata,n=e.initV,a=e.colModel;if(e._mergeCells){if(o)for(var l=0;l<r;l++)e.refreshRow({rowIndxPage:l,refresh:!1});e.refreshRow({rowIndxPage:n+1,refresh:!1})}return e._trigger("beforeTableView",null,{pageData:i,initV:n,finalV:n,initH:e.initH,finalH:e.finalH,colModel:a}),e.refreshRow({rowIndxPage:n,refresh:!1}),t},e.removeTopRow=function(t){for(var e=this.that,r=e.options.freezeRows,o=e.calcVisibleRows(e.pdata,0,r),i=e.$tbl,n=z([]),a=0;a<i.length;a++)var l=z(i[a]).children("tbody").children("tr:gt(0)").slice(o,t+o),n=n.add(l);if(n.remove(),e._mergeCells){if(o)for(a=0;a<r;a++)e.refreshRow({rowIndxPage:a,refresh:!1});e.refreshRow({rowIndxPage:e.initV,refresh:!1})}},e.removeBottomRow=function(t){var e=this.that.$tbl;if(t)for(var r=0;r<e.length;r++)z(e[r]).children("tbody").children("tr:gt(0)").slice(-t).remove()},e.format=(o=z.datepicker,i=pq.formatNumber,function(t,e,r){return"date"!=r?i(t,e):isNaN(Date.parse(t))?void 0:o.formatDate(e,new Date(t))}),e.renderCell=function(t){var e=this.that,r=[],o=[],i=t.Export,n=!1,a=this.options,l=["pq-grid-cell"];if(!t.other&&!i&&e._mergeCells){if(null==(t=e.iMerge.renderCell(t)))return"";t.rowspan&&(r.push("rowspan='"+t.rowspan+"'","colspan='"+t.colspan+"'"),a.mergeModel.flex||(n=!0,l.push("pq-merge-cell"))),t.style&&o.push(t.style),t.cls&&l.push(t.cls)}var s=t.rowData,d=t.column,h=t.colIndx,c=d.dataIndx,u=a.freezeCols,a=a.columnBorders;if(s){i||(r.push("pq-col-indx='"+h+"'"),"right"==d.align?l.push("pq-align-right"):"center"==d.align&&l.push("pq-align-center"),h==u-1&&a&&l.push("pq-last-frozen-col"),(w=d.cls)&&l.push(w),(m=e.iSelection.dirty?null:s.pq_cellselect)&&m[c]&&l.push(e.iCells.hclass));var p,f,g,v,w=s[c],m=d.format,m=m?this.format(w,m,d.dataType):w;if(t.dataIndx=c,t.cellData=w,t.formatVal=m,d.render&&(p=d.render.call(e,t))&&"string"!=typeof p&&(f=p.attr,g=p.cls,v=p.style,f&&r.push(f),g&&l.push(g),v&&o.push(v),p=p.text),(p=null==p&&d._render?d._render.call(e,t):p)&&"string"!=typeof p&&(f=p.attr,g=p.cls,v=p.style,f&&r.push(f),g&&l.push(g),v&&o.push(v),p=p.text),null==p&&(p=m),i)return p;""!==p&&null!=p||(p="&nbsp;");i=s.pq_cellcls;!i||(i=i[c])&&l.push(i);s=s.pq_cellattr;if(s){c=s[c];if(c){var x,_=y(c);for(x in _){var I=_[x];"style"==x?o.push(I):r.push(x+'="'+I+'"')}}}o=o.length?" style='"+o.join("")+"' ":"";return["<td class='",l.join(" "),"' ",r.join(" "),o," >",n?"<div class='pq-merge-cell-div'><div><div class='pq-merge-inner'>":"",p,n?"</div></div></div>":"","</td>"].join("")}},e.setFrozenRip=function(t,e){if(t){for(var r;e--&&(r=t[e])&&r.pq_hidden;);this.frozenRip=e}},e.refreshRow=function(t,e){var r=this.that.pdata[t],o=r.pq_detail&&r.pq_detail.show;this._generateRow(r,t,e,null,o)},e._generateRow=function(t,e,r,o,i){var n=["pq-grid-row"];this.frozenRip===e&&n.push("pq-last-frozen-row"),i&&n.push("pq-detail-master");var a=this.that,l=this.options,s=l.rowInit,d=l.numberCell,h="",c="",u=a.rowIndxOffset,i=e+u;!s||(s=s.call(a,{rowData:t,rowIndxPage:e,rowIndx:i}))&&(s.cls&&n.push(s.cls),h+=s.attr?" "+s.attr:"",c+=s.style||""),!o&&l.stripeRows&&this.isOdd(e,l.freezeRows)&&n.push("pq-grid-oddRow"),t.pq_rowselect&&n.push(a.iRows.hclass);a=t.pq_rowcls;null!=a&&n.push(a);a=t.pq_rowattr;if(a){var p,f=y(a);for(p in f)h+=" "+p+'="'+f[p]+'"'}c=c?"style='"+c+"'":"",r.push("<tr pq-row-indx='",e,"' class='",n.join(" "),"' ",h," ",c," >"),d.show&&r.push(["<td pq-col-indx='-1' class='pq-grid-number-cell'>",o?"&nbsp;":i+1,"</td>"].join(""));for(var g={rowIndx:e+u,rowIndxPage:e,other:o,rowData:t},v=this.colDef,w=0,m=v.length;w<m;w++){var x=v[w],_=x.colIndx,x=x.column;g.column=x,g.colIndx=_,r.push(this.renderCell(g))}return r.push("</tr>"),r},e.isOdd=function(t,e){t=pq.searchSeqArray(t<e?this.vfrows:this.vrows,t);return t/2==parseInt(t/2)},e._generateDetailRow=function(t,e,r){var o=["pq-grid-row pq-detail-child"],i=this.that,n=i.options,a=n.numberCell;n.stripeRows&&this.isOdd(e,n.freezeRows)&&o.push("pq-grid-oddRow"),t.pq_rowselect&&o.push(i.iRows.hclass);t=t.pq_rowcls;return null!=t&&o.push(t),r.push("<tr pq-row-indx='"+e+"' class='"+o.join(" ")+"' >"),a.show&&r.push(["<td class='pq-grid-number-cell'>","&nbsp;</td>"].join("")),r.push("<td class='pq-grid-cell pq-detail-child' colSpan='20'></td>"),r.push("</tr>"),r};t={widgetEventPrefix:"pqgrid",_create:function(){var o=this,t=this.options,e=t.dataModel,r=t.bootstrap,i=r.on,n=t.roundCorners&&!i,a=t.ui,l=t.sortModel;if(z(document).triggerHandler("pqGrid:bootup",{instance:this}),this.BS_on=i,t.collapsible||(t.collapsible={on:!1,collapsed:!1}),t.flexHeight&&(t.height="flex"),t.flexWidth&&(t.width="flex"),e.sortIndx){l.on=t.sortable,l.type=e.sorting;var s=[],d=e.sortIndx,h=e.sortDir;if(z.isArray(d)){for(var c=0;c<d.length;c++){var u=h&&h[c]?h[c]:"up";s.push({dataIndx:d[c],dir:u})}l.single=!1}else{u=h||"up";s.push({dataIndx:d,dir:u}),l.single=!0}l.sorter=s}!1===t.virtualXHeader&&(t.virtualXHeader=null),this.setEditorPosTimer(),this.iGenerateView=new g(this),this.iRefresh=new W.cRefresh(this),this.iKeyNav=new w(this),this.iIsValid=new v(this),this.tables=[],this.$tbl=null,this.iColModel=new W.cColModel(this),this.iSort=new W.cSort(this),this.iHeader=new W.cHeader(this),this._initTypeColumns();var p=this.element;p.on("scroll"+this.eventNamespace,function(){this.scrollLeft=0,this.scrollTop=0});var f=(i?r:a).grid,e=i?"":a.header_o,l=i?"":a.bottom,a=(i?r:a).top;p.empty().addClass("pq-grid "+f+" "+(n?" ui-corner-all":"")).html(["<div class='pq-grid-top ",a," ",n?" ui-corner-top":"","'>","<div class='pq-grid-title",n?" ui-corner-top":"","'>&nbsp;</div>","</div>","<div class='pq-grid-center' >","<div class='pq-header-outer ",e,"'>","</div>","<div class='pq-grid-cont-outer' >","<div class='pq-grid-cont' tabindex='0'></div>","</div>","</div>","<div class='pq-grid-bottom ",l," ",n?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'></div>","</div>"].join("")),this.$bottom=z("div.pq-grid-bottom",p),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),this.$top=z("div.pq-grid-top",p),t.showTop||this.$top.css("display","none"),this.$title=z("div.pq-grid-title",p),t.showTitle||this.$title.css("display","none");l=this.$grid_center=z("div.pq-grid-center",p).on("scroll",function(){this.scrollTop=0});this.$header_o=z("div.pq-header-outer",this.$grid_center).on("scroll",function(){this.scrollTop=0,this.scrollLeft=0}),this.$footer=z("div.pq-grid-footer",p),this.$cont_o=z(".pq-grid-cont-outer",l);n=this.$cont=z("div.pq-grid-cont",l);z(window).bind("resize"+o.eventNamespace+" orientationchange"+o.eventNamespace,function(t,e){o.onWindowResize(t,e)}),n.on("click",".pq-grid-cell,.pq-grid-number-cell",function(t){if(!0!==z.data(t.target,o.widgetName+".preventClickEvent"))return z(t.target).closest(".pq-grid")[0]==o.element[0]?o._onClickCell(t):void 0}),n.on("click","tr.pq-grid-row",function(t){if(!0!==z.data(t.target,o.widgetName+".preventClickEvent"))return z(t.target).closest(".pq-grid")[0]==o.element[0]?o._onClickRow(t):void 0}),n.on("contextmenu","td.pq-grid-cell",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onRightClickCell(t)}),n.on("contextmenu","tr.pq-grid-row",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onRightClickRow(t)}),n.on("dblclick","td.pq-grid-cell",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onDblClickCell(t)}),n.on("dblclick","tr.pq-grid-row",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onDblClickRow(t)}),n.on("blur",function(){o.onblur()}),n.on("focus",function(){o.onfocus()}),n.on("mousedown",function(t){if(1===t.which){var e=z(t.target);if(e.closest(".pq-grid")[0]==o.element[0]){var r=e.closest(".pq-grid-cell:not(.pq-detail-child)");if(r.length&&(t.currentTarget=r[0],!1===o._onCellMouseDown(t)))return!1;if(!t.isPropagationStopped()){e=e.closest(".pq-grid-row");return e.length&&(t.currentTarget=e[0],!1===o._onRowMouseDown(t))?!1:t.isPropagationStopped()?void 0:o._onContMouseDown(t)}}}}),n.on("mouseenter","td.pq-grid-cell",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onCellMouseEnter(t,z(this))}),n.on("mouseenter","tr.pq-grid-row",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onRowMouseEnter(t,z(this))}),n.on("mouseleave","td.pq-grid-cell",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onCellMouseLeave(t,z(this))}),n.on("mouseleave","tr.pq-grid-row",function(t){if(z(t.target).closest(".pq-grid")[0]==o.element[0])return o._onRowMouseLeave(t,z(this))}),n.on("keyup",function(t){z(t.target).closest(".pq-grid")[0]==o.element[0]&&o._trigger("keyUp",t,null)}),l.bind("mousewheel DOMMouseScroll",function(t){return o._onMouseWheel(t)});this.$hvscroll=z("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(l);p=z("<div class='pq-vscroll'></div>").appendTo(l);this.prevVScroll=0;n=t.scrollModel;void 0===n.lastColumn&&t.virtualX&&(n.lastColumn="auto"),this.vscroll=pq.scrollbar(p,{pace:n.pace,theme:n.theme,bootstrap:t.bootstrap,steps:t.virtualY&&!n.smooth,direction:"vertical",cur_pos:0,pageRight:function(){o.iKeyNav.pageDown()},pageLeft:function(){o.iKeyNav.pageUp()},drag:function(t,e){o.iMouseSelection.syncViewWithScrollBarVert(e.ratio)},scroll:function(t,e){o.iRefresh.refreshVscroll(e)}});p=z("<div class='pq-hscroll'></div>").appendTo(l);"flex"===t.height&&p.css("position","relative"),this.hscroll=pq.scrollbar(p,{direction:"horizontal",pace:n.pace,bootstrap:t.bootstrap,theme:n.theme,steps:t.virtualX&&!n.smooth,cur_pos:0,drag:function(t,e){o.iMouseSelection.syncViewWithScrollBarHor(e.ratio)},scroll:function(){t.virtualX&&!t.scrollModel.smooth&&o.refresh()}}),t.selectionModel.native||this.disableSelection(),l.bind("keydown.pq-grid",function(t){z(t.target).closest(".pq-grid")[0]==o.element[0]&&o._onKeyPressDown(t)}),this._refreshTitle(),this.iRows=new W.cRows(this),this.iCells=new W.cCells(this),this.generateLoading(),this._initPager(),this._refreshResizable(),this._refreshDraggable(),this.iResizeColumns=new W.cResizeColumns(this),this._mouseInit()},_mouseDown:function(t){var e=this;return z(t.target).closest(".pq-editor-focus").length?(this._blurEditMode=!0,void window.setTimeout(function(){e._blurEditMode=!1},0)):(this._saveDims(),this._mousePQUpDelegate=function(t){return e._mousePQUp(t)},z(document).bind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._super(t))},destroy:function(){for(var t in this._trigger("destroy"),this._super(),window.clearInterval(this._refreshEditorPosTimer),this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout),this)delete this[t];this.options=void 0,z.fragments={}},_setOption:function(t,e){var r=this.options,o=r.dataModel;if("height"===t)"flex"===e?(i=this.vscroll,e&&i&&i.widget().hasClass("pq-sb-vert")&&(r.virtualY?i.option("cur_pos",0):i.option("ratio",0)),this.hscroll.widget().css("position","relative")):"flex"===r.height&&this.hscroll.widget().css("position",""),r[t]=e;else if("width"===t&&"flex"==e){r[t]=e;var i=this.hscroll;e&&i&&i.widget().hasClass("pq-sb-horiz")&&(r.virtualX?i.option("cur_pos",0):i.option("ratio",0))}else if("title"==t)r[t]=e,this._refreshTitle();else if("roundCorners"==t)(r[t]=e)?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"));else if("virtualX"==t)r[t]=e,this.hscroll.option("steps",e);else if("virtualY"==t)r[t]=e,this.vscroll.option("steps",e);else if("freezeCols"==t)e=parseInt(e),!isNaN(e)&&0<=e&&e<=this.colModel.length-2&&(r[t]=e);else if("freezeRows"==t)e=parseInt(e),!isNaN(e)&&0<=e&&(r[t]=e);else if("resizable"==t)r[t]=e,this._refreshResizable();else if("draggable"==t)r[t]=e,this._refreshDraggable();else if("scrollModel"==t)r[t]=e;else if("dataModel"==t)e.data!==o.data&&o.dataUF&&(o.dataUF.length=0),r[t]=e;else{if("groupModel"==t)throw"use groupOption() to set groupModel options.";"pageModel"==t||"selectionModel"===t?r[t]=e:"colModel"===t||"columnTemplate"==t?(r[t]=e,this.iColModel.init()):"disabled"===t?(this._super(t,e),!0===e?this._disable():this._enable()):"numberCell"===t?(r[t]=e,this.iRefresh.decidePanes()):"strLoading"===t?(r[t]=e,this._refreshLoadingString()):"showTop"===t?(r[t]=e,this.$top.css("display",e?"":"none")):"showTitle"===t?(r[t]=e,this.$title.css("display",e?"":"none")):"showToolbar"===t?(r[t]=e,this._toolbar.widget().css("display",e?"":"none")):"toolbar"==t?r[t]=e:"collapsible"===t?(r[t]=e,this._createCollapse()):"showBottom"===t?(r[t]=e,this.$bottom.css("display",e?"":"none")):r[t]=e}return this}};t.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",trigger:!1,bootstrap:{on:!1,thead:"table table-striped table-condensed table-bordered",tbody:"table table-condensed",grid:"panel panel-default",top:"",btn:"btn btn-default",groupModel:{icon:["glyphicon-triangle-bottom","glyphicon-triangle-right"]},header_active:"active"},ui:{on:!0,grid:"ui-widget ui-widget-content",top:"ui-widget-header",bottom:"ui-widget-header",header_o:"ui-widget-header",header:"ui-state-default",header_active:"ui-state-active"},cls:{cont_inner:"pq-grid-cont-inner",cont_inner_b:"pq-grid-cont-inner-b"},distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{data:[],dataUF:[],cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:z.ui.keyCode.ENTER,onSave:"nextFocus",onTab:"nextFocus",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},summaryOptions:{number:"avg,sum,max,min",date:"count,max,min",string:"count"},summaryTitle:{avg:"Avg: {0}",count:"Count: {0}",max:"Max: {0}",min:"Min: {0}",sum:"Sum: {0}"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,freezeBorders:!0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"99%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,rowHeight:25,scrollModel:{pace:"fast",smooth:!1,horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!0},selectionModel:{type:"cell",onTab:"nextFocus",row:!0,mode:"block"},swipeModel:{on:!0,speed:20,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0};z.extend(!0,t.options,{strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strGroup_header:"Drag a column here to group by that column",strGroup_merge:"Merge cells",strGroup_fixCols:"Fix columns",strGroup_grandSummary:"Grand summary",strLoading:"Loading",strNoRows:"No rows to display."}),z.widget("paramquery._pqGrid",z.ui.mouse,t);e=W._pqGrid.prototype;function n(t){return"<span class='btn btn-xs glyphicon glyphicon-"+t+"' ></span>"}function a(t){return"<span class='ui-widget-header pq-ui-button'><span class='ui-icon ui-icon-"+t+"'></span></span>"}e.refreshCM=function(t){t?this.option("colModel",t):this.iColModel.init()},e.readCell=function(t,e,r,o,i){e=e.dataIndx;if(!r||!1!==r.isRootCell(o,i,"o"))return t[e]},e.saveCell=function(t,e,r){t[e.dataIndx]=r},e._destroyResizable=function(){var t=this.element,e=t.data();(e.resizable||e.uiResizable||e["ui-resizable"])&&t.resizable("destroy")},e._disable=function(){null==this.$disable&&(this.$disable=z("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},e._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},e._destroy=function(){this.loading&&this.xhr.abort(),this._destroyResizable(),this._destroyDraggable(),this._mouseDestroy(),this.element.off(this.eventNamespace),z(window).unbind(this.eventNamespace),z(document).unbind(this.eventNamespace),this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},e.collapse=function(t){function e(){o.css("overflow","hidden"),n.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),o.hasClass("ui-resizable")&&o.resizable("destroy"),r._toolbar&&r._toolbar.disable(),i.collapsed=!0,i._collapsed=!0,i.animating=!1,r._trigger("collapse")}var r=this,o=this.element,i=this.options.collapsible,n=i.$collapse.children("span");if(t=t||{},i._collapsed)return!1;i.htCapture=o.height(),!1===t.animate?(o.height(23),e()):(i.animating=!0,o.animate({height:"23px"},function(){e()}))},e.expand=function(t){function e(){o.css("overflow",""),i._collapsed=!1,i.collapsed=!1,r._refreshResizable(),i.refreshAfterExpand&&r.refresh(),a.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),r._toolbar&&r._toolbar.enable(),i.animating=!1,r._trigger("expand")}var r=this,o=this.element,i=this.options.collapsible,n=i.htCapture,a=i.$collapse.children("span");if(!1===i._collapsed)return!1;!1===(t=t||{}).animate?(o.height(n),e()):(i.animating=!0,o.animate({height:n},function(){e()}))},e._createCollapse=function(){var e=this,t=this.$top,r=this.options,o=this.BS_on,i=r.collapsible;i.$stripe||(t=z(["<div class='pq-slider-icon pq-no-capture'  >","</div>"].join("")).appendTo(t),i.$stripe=t),i.on?i.$collapse||(i.$collapse=z(o?n("collapse-down"):a("circle-triangle-n")).appendTo(i.$stripe).click(function(t){i.collapsed?e.expand():e.collapse()})):i.$collapse&&(i.$collapse.remove(),delete i.$collapse),i.collapsed&&!i._collapsed?e.collapse({animate:!1}):!i.collapsed&&i._collapsed&&e.expand({animate:!1}),i.toggle?i.$toggle||(i.$toggle=z(o?n("fullscreen"):a("arrow-4-diag")).prependTo(i.$stripe).click(function(t){e.toggle()})):i.$toggle&&(i.$toggle.remove(),delete i.$toggle)},e.toggle=function(){var t,e,r=this.options,o=r.collapsible,i=this.element,n=this._maxim,a=n?"min":"max",l=z(document.body);if(!1===this._trigger("beforeToggle",null,{state:a}))return!1;"min"==a?(t=n.eleObj,e=n.docObj,this.option({height:t.height,width:t.width,maxHeight:t.maxHeight,maxWidth:t.maxWidth}),i[0].style.cssText=t.cssText,l[0].style.cssText=e.cssText,z("html").css({overflow:"visible"}),window.scrollTo(e.scrollLeft,e.scrollTop),this._maxim=null):(t={height:r.height,width:r.width,cssText:i[0].style.cssText,maxHeight:r.maxHeight,maxWidth:r.maxWidth},this.option({height:"100%",width:"100%",maxHeight:null,maxWidth:null}),i.css(z.extend({position:"fixed",left:0,top:0,margin:0},o.css)),e={scrollLeft:z(window).scrollLeft(),scrollTop:z(window).scrollTop(),cssText:l[0].style.cssText},l.css({height:0,width:0,overflow:"hidden",position:"static"}),z("html").css({overflow:"hidden"}),window.scrollTo(0,0),this._maxim={eleObj:t,docObj:e}),this._trigger("toggle",null,{state:a}),this._refreshResizable(),this.refresh(),z(window).trigger("resize",{$grid:i,state:a})},e._mouseCapture=function(t){var e=this.options;if(e.virtualX&&e.virtualY&&!e.scrollModel.smooth)return!1;if(!t.target)return!1;if(z(t.target).closest(".pq-grid")[0]!=this.element[0])return!1;e=e.swipeModel;return!(0==e.on||"touch"==e.on&&!z.support.touch)},e._saveDims=function(){this.$cont;var t=this.$tbl,e=this.$tbl_header;if(t)for(var r=0;r<t.length;r++){var o=t[r],i=z(o);i.data("offsetHeight",Math.round(o.offsetHeight)-1),i.data("scrollWidth",Math.round(o.scrollWidth))}if(e)for(r=0;r<e.length;r++){var o=e[r],n=z(o).parent();n.data("offsetHeight",Math.round(o.offsetHeight)),n.data("scrollWidth",Math.round(o.scrollWidth))}},e._mousePQUp=function(t){z(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._trigger("mousePQUp",t,null)},e._mouseStart=function(t){return this.blurEditor({force:!0}),!0},e._mouseDrag=function(t){return 0!=this._trigger("mouseDrag",t,null)},e._mouseStop=function(t){return 0!=this._trigger("mouseStop",t,null)},e.onWindowResize=function(t,e){var r,o=this,i=o.options,n=o.element,a=n.parent(),l="_lastParentHt",s="_lastParentWd",d="autoResizeTimeout";if(e){e=e.$grid;if(e&&(e==n||0==n.closest(e).length))return}a.length&&(a=a[0]==document.body||"fixed"==n.css("position")?(r=window.innerHeight||z(window).height(),z(window).width()):(r=a.height(),a.width()),null!=o[l]&&r==o[l]&&a==o[s]||(o[l]=r,o[s]=a,z.support.touch&&i.editModel.indices&&z(document.activeElement).is(".pq-editor-focus")||(o[d]&&clearTimeout(o[d]),o[d]=window.setTimeout(function(){o._refreshAfterResize(),delete o[d]},i.autoSizeInterval||0))))},e._onMouseWheel=function(t){this._saveDims();var e=this.options,r=0,o=!1,i=(t=t.originalEvent).wheelDeltaX,n=t.wheelDeltaY,a=t.wheelDelta;if(i&&Math.abs(i)>Math.abs(n)){if("flex"==e.width)return!0;o=!0,r=i/120}else if(a){if(!this.iRefresh.vscroll)return!0;r=a/120}else if(t.detail){if(!this.iRefresh.vscroll)return!0;r=-1*t.detail/3}r*=3;i=o?this.hscroll:this.vscroll,a=parseInt(i.option("cur_pos")),t=parseInt(i.option("num_eles"));if(!e.scrollModel.smooth&&(o&&e.virtualX||!o&&e.virtualY)){e=a-(r=0<r?Math[r<1?"ceil":"floor"](r):Math[r<-1?"ceil":"floor"](r));if(e<0?e=0:t-1<e&&(e=t-1),e==a)return!0;i.option("cur_pos",a-r),i.scroll()}else{a=i.option("ratio"),t=a-r/(t-1);if(1<t?t=1:t<0&&(t=0),a==t)return!0;i.option("ratio",t),i.drag()}return!1},e._onDblClickCell=function(t){var e=this,r=z(t.currentTarget),o=e.getCellIndices({$td:r}),i=o.rowIndxPage,n=i+e.rowIndxOffset,o=o.colIndx;if(null!=o)return 0!=e._trigger("cellDblClick",t,{$td:r,rowIndxPage:i,rowIndx:n,colIndx:o,column:e.colModel[o],rowData:e.pdata[i]})&&void(1<e.options.editModel.clicksToEdit&&this.isEditableRow({rowIndx:n})&&this.isEditableCell({colIndx:o,rowIndx:n})&&e.editCell({rowIndxPage:i,colIndx:o}))},e._onClickCont=function(t){},e._onClickRow=function(t){var e=z(t.currentTarget),r=parseInt(e.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)){this.options;return 0!=this._trigger("rowClick",t,{$tr:e,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]})&&void 0}},e._onRightClickRow=function(t){var e=z(t.currentTarget),r=parseInt(e.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)){this.options;return 0!=this._trigger("rowRightClick",t,{$tr:e,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]})&&void 0}},e._onDblClickRow=function(t){var e=z(t.currentTarget),r=parseInt(e.attr("pq-row-indx")),o=this.getRowIndxOffset();if(0==this._trigger("rowDblClick",t,{$tr:e,rowIndxPage:r,rowIndx:r+o,rowData:this.pdata[r]}))return!1},e.getValueFromDataType=function(t,e,r){var o;if("date"==e)return o=Date.parse(t),isNaN(o)?"":r?o:t;if("object"==e)return t;if("integer"==e)o=parseInt(t);else{if("float"!=e)return"bool"==e?0==(o=z.trim(t).toLowerCase()).length?null:"true"==o||"yes"==o||"1"==o||"false"!=o&&"no"!=o&&"0"!=o&&Boolean(o):z.trim(t);o=parseFloat(t)}return isNaN(o)||null==o?null==t?t:null:o};var v=function(t){this.that=t},t=v.prototype;t._isValidCell=function(t){var e=this.that,r=t.column,o=r.validations;if(!o||!o.length)return{valid:!0};function i(t){return e.getValueFromDataType(t,a,!0)}var n=t.value,a=r.dataType,l=t.rowData;if(!l)throw"rowData required.";for(var s=0;s<o.length;s++){var d,h=o[s],c=h.on,u=h.type,p=!1,f=h.msg,g=h.value;if(!1!==c)if(null==n&&"function"!=typeof u?p=!1:"minLen"==u?(n=i(n),g=i(g),n.length>=g&&(p=!0)):"nonEmpty"==u?null!=n&&""!==n&&(p=!0):"maxLen"==u?(n=i(n),g=i(g),n.length<=g&&(p=!0)):"gt"==u?(n=i(n),(g=i(g))<n&&(p=!0)):"gte"==u?(n=i(n),(g=i(g))<=n&&(p=!0)):"lt"==u?(n=i(n))<(g=i(g))&&(p=!0):"lte"==u?(n=i(n))<=(g=i(g))&&(p=!0):"neq"==u?(n=i(n))!==(g=i(g))&&(p=!0):"regexp"==u?new RegExp(g).test(n)&&(p=!0):"function"==typeof u&&0==u.call(e,d={column:r,value:n,rowData:l,msg:f})?(p=!1,d.msg!=f&&(f=d.msg)):p=!0,!p)return{valid:!1,msg:f,column:r,warn:h.warn,dataIndx:r.dataIndx,validation:h}}return{valid:!0}},t.isValidCell=function(t){var e=this.that,r=t.rowData,o=t.rowIndx,i=t.value,n=t.valueDef,a=t.column,l=t.focusInvalid,s=e.options,d=s.bootstrap,h=t.allowInvalid,c=a.dataIndx,u=s.validation,p=s.warning,f=s.editModel,g=f.invalidClass,v=f.warnClass,f=document.activeElement;if(t.checkEditable&&0==e.isEditableCell({rowIndx:o,dataIndx:c}))return{valid:!0};var w,m,x,_,I,y,t=this._isValidCell({column:a,value:i,rowData:r}),a=t.valid,i=t.warn,b=t.msg;if(a?e.data({rowData:r,dataIndx:c,data:"pq_valid"})&&(e.removeClass({rowData:r,rowIndx:o,dataIndx:c,cls:v+" "+g}),e.removeData({rowData:r,dataIndx:c,data:"pq_valid"})):(u=z.extend({},i?p:u,t.validation),w=u.css,m=u.cls,x=u.icon,_=u.style),h||i)return a?{valid:!0}:(e.addClass({rowData:r,rowIndx:o,dataIndx:c,cls:i?v:g}),e.data({rowData:r,dataIndx:c,data:{pq_valid:{css:w,icon:x,style:_,msg:b,cls:m}}}),t);if(!a){if(null==o){r=e.getRowIndx({rowData:r,dataUF:!0});if(null==(o=r.rowIndx)||r.uf)return t.uf=r.uf,t}if(l){if(n){if(z(f).hasClass("pq-editor-focus")){l=s.editModel.indices;if(l){f=l.rowIndx,l=l.dataIndx;if(null!=o&&o!=f)throw"incorrect usage of isValid rowIndx: "+o;if(c!=l)throw"incorrect usage of isValid dataIndx: "+c;e.editCell({rowIndx:f,dataIndx:c})}}}else{e.goToPage({rowIndx:o});var C=e.normalize(C={rowIndx:o,dataIndx:c}),q=e.getCell(C);e["cell"==s.selectionModel.type?"setSelection":"scrollCell"](C),e.focus(C)}if(q||(I=e.getEditCell())&&I.$cell){(y=q||I.$cell).attr("title",b);C="tooltip",q="open";d.on&&d.tooltip&&(C=d.tooltip,q="show");try{y[C]("destroy")}catch(t){}y[C]({trigger:"manual",position:{my:"left center+5",at:"right center"},content:function(){return(""==x?"":"<span class='ui-icon "+x+" pq-tooltip-icon'></span>")+b},open:function(t,e){var r=e.tooltip;m&&r.addClass(m),_&&(e=r.attr("style"),r.attr("style",e+";"+_)),w&&r.tooltip.css(w)}})[C](q)}}return t}if(n&&(I=e.getEditCell())&&I.$cell){(y=I.$cell).removeAttr("title");try{y.tooltip("destroy")}catch(t){}}return{valid:!0}},e.isValid=function(t){return this.iIsValid.isValid(t)},t.isValid=function(t){var e=this.that,r=(t=t||{}).allowInvalid,o=t.focusInvalid,i=t.checkEditable,r=null!=r&&r;if(null!=(p=t.dataIndx)){var n=e.columns[p],a=t.rowData||e.getRowData(t),l=t.hasOwnProperty("value"),s=l?t.value:a[p];return(f=this.isValidCell({rowData:a,checkEditable:i,rowIndx:t.rowIndx,value:s,valueDef:l,column:n,allowInvalid:r,focusInvalid:o})).valid||f.warn?{valid:!0}:f}if(null!=t.rowIndx||null!=t.rowIndxPage||null!=t.rowData){for(var a=t.rowData||e.getRowData(t),d=e.colModel,h=[],c=0,u=d.length;c<u;c++)if(!(n=d[c]).hidden){var p,f,s=a[p=n.dataIndx];if(!(f=this.isValidCell({rowData:a,value:s,column:n,rowIndx:t.rowIndx,checkEditable:i,allowInvalid:r,focusInvalid:o})).valid&&!f.warn){if(!r)return f;h.push({rowData:a,dataIndx:p,column:n})}}return r&&h.length?{cells:h,valid:!1}:{valid:!0}}var g=t.data||e.options.dataModel.data,h=[];if(!g)return null;for(c=0,u=g.length;c<u;c++){var v,a=g[c];if(!i||null!=(v=this.getRowIndx({rowData:a}).rowIndx)&&0!=e.isEditableRow({rowData:a,rowIndx:v})){var w=this.isValid({rowData:a,rowIndx:v,checkEditable:i,allowInvalid:r,focusInvalid:o}),m=w.cells;if(!1===r){if(!w.valid)return w}else m&&m.length&&(h=h.concat(m))}}return r&&h.length?{cells:h,valid:!1}:{valid:!0}},e.isValidChange=function(t){t=t||{};var e=this.getChanges(),r=e.addList,r=e.updateList.concat(r);return t.data=r,this.isValid(t)},e.isEditableRow=function(t){var e=this.options.editable;return null==e||("function"==typeof e?e.call(this,this.normalize(t)):e)},e.isEditableCell=function(t){var e=this.normalize(t),r=(e.rowIndx,e.colIndx,this.iMerge,e.column),t=r.editable;return(!e.checkVisible||!r.hidden)&&(null==t||("function"==typeof t?t.call(this,e):t))},e._onContMouseDown=function(t){this.blurEditor({blurIfFocus:!0});if(!1===this._trigger("contMouseDown",t,null))return!1;var e=z(t.target),t=e.closest(".pq-grid-cell,.pq-grid-number-cell"),e=e.closest(".pq-grid-row");return t.length||e.length||((e=this.$cont[0]).setAttribute("tabindex",0),e.focus()),!0},e._onCellMouseDown=function(t){var e=z(t.currentTarget),r=this.getCellIndices({$td:e});if(null!=r.rowIndx)return r=this.iMerge.getRootCell(r.rowIndx,r.colIndx,"o"),(r=this.normalize(r)).$td=e,0!=this._trigger("cellMouseDown",t,r)},e._onRowMouseDown=function(t){var e=z(t.currentTarget),r=this.getRowIndx({$tr:e});return r.$tr=e,0!=this._trigger("rowMouseDown",t,r)},e._onCellMouseEnter=function(t,e){var r=e,o=this.options,e=this.getCellIndices({$td:r});if(null!=e.rowIndx&&null!=e.colIndx)return!1!==this._trigger("cellMouseEnter",t,e)&&("cell"==o.hoverMode&&this.highlightCell(r),!0)},e._onRowMouseEnter=function(t,e){var r=this.options,o=this.getRowIndx({$tr:e}),e=o.rowIndxPage;return!1!==this._trigger("rowMouseEnter",t,o)&&("row"==r.hoverMode&&this.highlightRow(e),!0)},e._onCellMouseLeave=function(t,e){return"cell"==this.options.hoverMode&&this.unHighlightCell(e),!0},e._onRowMouseLeave=function(t,e){e=this.getRowIndx({$tr:e}).rowIndxPage;return"row"==this.options.hoverMode&&this.unHighlightRow(e),!0},e.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)},e.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(t){if(t.target){var e=z(t.target);return!!e.is("input,textarea,select")||(!!e.closest(".pq-native-select").length||void t.preventDefault())}})},e._onClickCell=function(t){var e=this.options.editModel,r=z(t.currentTarget),o=this.getCellIndices({$td:r}),i=this.iMerge.getRootCell(o.rowIndx,o.colIndx,"o"),n=this.normalize(i),o=n.rowIndx,i=n.colIndx;if(n.$td=r,n.evt=t,0==this._trigger("cellClick",t,n))return!1;null==i||i<0||1==e.clicksToEdit&&this.isEditableRow({rowIndx:o})&&this.isEditableCell({colIndx:i,rowIndx:o})&&this.editCell(n)},e._onRightClickCell=function(t){var e=z(t.currentTarget),r=this.getCellIndices({$td:e}),o=r.rowIndxPage,i=o+this.rowIndxOffset,n=r.colIndx,a=this.colModel;this.options.DM;if(null!=n){r=a[n],a=r.dataIndx;return 0!=this._trigger("cellRightClick",t,{$td:e,rowIndxPage:o,rowIndx:i,colIndx:n,dataIndx:a,column:r,rowData:this.pdata[o]})&&void 0}},e.highlightCell=function(t){t.addClass("pq-grid-cell-hover ui-state-hover")},e.unHighlightCell=function(t){t.removeClass("pq-grid-cell-hover ui-state-hover")},e.highlightRow=function(t){isNaN(t)||(t=this.getRow({rowIndxPage:t}))&&t.addClass("pq-grid-row-hover ui-state-hover")},e.unHighlightRow=function(t){isNaN(t)||(t=this.getRow({rowIndxPage:t}))&&t.removeClass("pq-grid-row-hover ui-state-hover")},e._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}},e._findCellFromEvt=function(t){var e=z(t.target).closest(".pq-grid-cell");if(null==e||0==e.length)return{rowIndxPage:null,colIndx:null,$td:null};t=this.getCellIndices({$td:e});return t.$td=e,t},e._initPager=function(){var o=this,t=o.options,e=t.pageModel;e.type&&(t={bootstrap:t.bootstrap,change:function(t,e){o.blurEditor({force:!0});var r=o.options.pageModel;null!=e.curPage&&(r.prevPage=r.curPage,r.curPage=e.curPage),null!=e.rPP&&(r.rPP=e.rPP),"remote"==r.type?o.remoteRequest({callback:function(){o._onDataAvailable({apply:!0,header:!1})}}):o.refreshView({header:!1,source:"pager"})},refresh:function(t){o.refreshDataAndView()}},t=z.extend(t,e),this.pagerW=pq.pager(e.appendTo||this.$footer,t))},e.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=z("<div class='pq-loading'></div>").appendTo(this.element),z(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},e._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},e.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},e.hideLoading=function(){0<this.showLoadingCounter&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},e.refreshDataFromDataModel=function(t){t=t||{};var e,r,o,i,n=this,a=n.options,l=a.dataModel,s=a.pageModel,d=l.data,l=s.type,h=n._queueATriggers;for(o in h){var c=h[o];delete h[o],n._trigger(o,c.evt,c.ui)}n._trigger("beforeRefreshData",null,{}),"local"==l?(i=s.totalRecords=d.length,s.totalPages=e=Math.ceil(i/s.rPP),s.curPage>e&&(s.curPage=e),e&&!s.curPage&&(s.curPage=1),r=(s.curPage-1)*s.rPP,(i=s.curPage*s.rPP)>d.length&&(i=d.length),n.pdata=d.slice(r=0<=r?r:0,i),r=r):"remote"==l?(s.totalPages=e=Math.ceil(s.totalRecords/s.rPP),s.curPage>e&&(s.curPage=e),e&&!s.curPage&&(s.curPage=1),(i=s.rPP)>d.length&&(i=d.length),n.pdata=d.slice(0,i),r=s.rPP*(s.curPage-1)):a.backwardCompat?n.pdata=d.slice(0):n.pdata=d,n.rowIndxOffset=0<=r?r:0,n._trigger("dataReady",null,{source:t.source})},e.getQueryStringCRUD=function(){return""},e.remoteRequest=function(o){this.loading&&this.xhr.abort(),o=o||{};var t,e,r,i=this,n="",a="",l=this.options,s=!1,d=this.colModel,h=l.dataModel,c=l.sortModel,u=l.filterModel,p=l.pageModel;"function"==typeof h.getUrl?(t={colModel:d,dataModel:h,sortModel:c,groupModel:l.groupModel,pageModel:p,filterModel:u},(e=h.getUrl.call(this,t))&&e.url&&(n=e.url),e&&e.data&&(a=e.data)):"string"==typeof h.url&&(n=h.url,l={},t={},e={},"remote"==c.type&&(o.initBySort||this.sort({initByRemote:!0}),(c=this.iSort.getQueryStringSort())&&(l={pq_sort:c})),"remote"==p.type&&(e={pq_curpage:p.curPage,pq_rpp:p.rPP}),"local"!=u.type&&(r=this.iFilterData.getQueryStringFilter())&&(s=!0,t={pq_filter:r}),u=h.postData,r=h.postDataOnce,u&&"function"==typeof u&&(u=u.call(this,{colModel:d,dataModel:h})),a=z.extend({pq_datatype:h.dataType},t,e,l,u,r)),n&&(this.loading=!0,this.showLoading(),this.xhr=z.ajax({url:n,dataType:h.dataType,async:null==h.async||h.async,cache:h.cache,contentType:h.contentType,type:h.method,data:a,beforeSend:function(t,e){if("function"==typeof h.beforeSend)return h.beforeSend.call(i,t,e)},success:function(t,e,r){i.onRemoteSuccess(t,e,r,s,o)},error:function(t,e,r){if(i.hideLoading(),i.loading=!1,"function"==typeof h.error)h.error.call(i,t,e,r);else if("abort"!=r)throw"Error : "+r}}))},e.onRemoteSuccess=function(t,e,r,o,i){var n=this,a=n.options,l=n.colModel,s=a.pageModel,a=a.dataModel,t="function"==typeof a.getData?a.getData.call(n,t,e,r):t;a.data=t.data,"remote"==s.type&&(null!=t.curPage&&(s.curPage=t.curPage),null!=t.totalRecords&&(s.totalRecords=t.totalRecords)),n.hideLoading(),n.loading=!1,n._trigger("load",null,{dataModel:a,colModel:l}),o&&(n._queueATriggers.filter={ui:{}}),i.callback&&i.callback()},e._refreshTitle=function(){this.$title.html(this.options.title)},e._destroyDraggable=function(){var t=this.element,e=t.parent(".pq-wrapper");e.length&&e.data("draggable")&&(e.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),t.unwrap(".pq-wrapper"))},e._refreshDraggable=function(){var t=this.options,e=this.element,r=this.$title;t.draggable?(r.addClass("pq-draggable pq-no-capture"),e.parent(".pq-wrapper").length||e.wrap("<div class='pq-wrapper' />"),e.parent(".pq-wrapper").draggable({handle:r})):this._destroyDraggable()},e._refreshResizable=function(){var t,h=this,e=this.element,c=this.options,r=-1<(c.width+"").indexOf("%"),o=-1<(c.height+"").indexOf("%"),i="auto"==c.width,n="flex"==c.width,a="flex"==c.height;!c.resizable||(a||o)&&(n||r||i)?this._destroyResizable():(t="e,s,se",a||o?t="e":(n||r||i)&&(t="s"),i=!0,e.hasClass("ui-resizable")&&(t==e.resizable("option","handles")?i=!1:this._destroyResizable()),i&&e.resizable({helper:"ui-state-default",handles:t,minWidth:c.minWidth,minHeight:c.minHeight||100,delay:0,start:function(t,e){z(e.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(t,e){},stop:function(t,e){var r=h.element,o=r[0],i=c.width,n=c.height,a=-1<(i+"").indexOf("%"),l=-1<(n+"").indexOf("%"),s="auto"==i,d="flex"==i,i="flex"==n,n=!1;o.style.width=o.offsetWidth+3+"px",o.style.height=o.offsetHeight+3+"px",l||i||(n=!0,c.height=o.offsetHeight),a||s||d||(n=!0,c.width=o.offsetWidth),h.refresh(),r.css("position","relative"),n&&z(window).trigger("resize")}}))},e._refreshAfterResize=function(){var t=this.options,e=t.width,r=t.height,t=-1!=(e+"").indexOf("%"),e="auto"===e,r=-1!=(r+"").indexOf("%");(t||e||r)&&this.refresh()},e.refresh=function(t){this.iRefresh.refresh(t)},e.refreshView=function(t){null!=this.options.editModel.indices&&this.blurEditor({force:!0}),this.refreshDataFromDataModel(t),this.refresh(t)},e._refreshPager=function(){var t=this.options,e=t.pageModel,r=!!e.type,o=e.rPP,e=e.totalRecords;r?(r=t.pageModel,this.pagerW||this._initPager(),this.pagerW.option(r),o<e?this.$bottom.css("display",""):t.showBottom||this.$bottom.css("display","none")):(this.pagerW&&(this.pagerW.destroy(),this.pagerW=null),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none"))},e.getInstance=function(){return{grid:this}},e.refreshDataAndView=function(t){var e;"remote"==this.options.dataModel.location?(e=this).remoteRequest({callback:function(){e._onDataAvailable(t)}}):this._onDataAvailable(t)},e.getColIndx=function(t){var e,r=t.dataIndx,o=t.column;if(o)e=!0;else if(void 0===r)throw"dataIndx / column NA";var i=this.colModel,n=i.length;if(e){for(var a=0;a<n;a++)if(i[a]==o)return a}else if(null!=(r=this.colIndxs[r]))return r;return-1},e.getColumn=function(t){if(null==t.dataIndx)throw"dataIndx N/A";return this.columns[t.dataIndx]},e._generateCellRowOutline=function(){var t=this.options,e=t.editModel;if(this.$div_focus){if(t.debug)throw"this.$div_focus already present assert failed"}else{t=this.element;e.inline&&(t=this.getCell(e.indices)).css("padding",0).empty(),this.$div_focus=z(["<div class='pq-editor-outer'>","<div class='pq-editor-inner'>","</div>","</div>"].join("")).appendTo(t);e=z.extend({all:!0},e.indices),e=this.getCell(e);e.css("height",e[0].offsetHeight),e.empty(),this.refreshEditorPos()}},e._removeEditOutline=function(t){var e,r,o,i;this.$div_focus&&(e=this.$div_focus.find(".pq-editor-focus"),(i=e).hasClass("hasDatepicker")&&i.datepicker("hide").datepicker("destroy"),e[0]==document.activeElement&&(o=this._blurEditMode,this._blurEditMode=!0,e.blur(),this._blurEditMode=o),this.$div_focus.remove(),delete this.$div_focus,r=this.options.editModel,o=z.extend({},r.indices),r.indices=null,o.rowData=void 0,this.refreshCell(o))},e.refreshEditorPos=function(){var t=this.options.editModel,e=t.cellBorderWidth,r=this.$div_focus,o=this.getCell(t.indices);if(!o||!o.length)return!1;var i=o[0].offsetWidth,n=o[0].offsetHeight,a=this.element.offset(),t=o.offset(),o=t.left-a.left-1,a=t.top-a.top-1;r.css({height:n,width:i-1,borderWidth:e,left:o,top:a})},e.setEditorPosTimer=function(){var t=this,e=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null),this._refreshEditorPosTimer=window.setInterval(function(){e.editModel.indices&&t.refreshEditorPos()},200)},e.get$Tbl=function(t,e){var r=this.$tbl,o=[];if(r&&r.length){var i=this.pqpanes,n=this.options,a=n.freezeRows,n=n.freezeCols;return i.h&&i.v?null==e?a<=t?o.push(r[2],r[3]):o.push(r[0],r[1]):o=n<=e&&a<=t?r[3]:e<n&&a<=t?r[2]:n<=e&&t<a?r[1]:r[0]:o=i.v?null==e?r:n<=e?r[1]:r[0]:i.h&&a<=t?r[1]:r[0],o?z(o):void 0}},e.scrollCell=function(t){this.scrollRow(t),this.scrollColumn(t)},e.scrollY=function(t){this.vscroll.option("cur_pos",t),this.vscroll.scroll()},e.scrollRow=function(t){var e=this.options,r=(t=this.normalize(t)).rowIndxPage,o=t.rowData;return!(!this.pdata||r>=this.pdata.length)&&(!(!o||o.pq_hidden)&&void(e.virtualY?this._scrollRowVirtual(t):this.iMouseSelection.scrollRowNonVirtual(t)))},e._scrollRowVirtual=function(t){var e=this.options,r=t.rowIndxPage,o=!!this.iHierarchy,i=t.rowIndx,n=this.vscroll,a=this.scrollCurPos,r=null==r?i-this.rowIndxOffset:r,l=parseInt(e.freezeRows);if(!(r<l)){var s=this._calcCurPosFromRowIndxPage(r);if(null!=s){s<a&&(n.option("cur_pos",s),n.scroll());var d=this.get$Tbl(r);if(!d||!d.length)return null;var h=(f=d.children("tbody").children("tr[pq-row-indx="+r+"]")).last(),c=h;1<f.length&&(c=f.first());t=h[0],i=parseInt(d.css("marginTop"));if(null==t)n.option("cur_pos",s),n.scroll();else{e=t.offsetTop+t.offsetHeight,r=this.iRefresh.getEContHt(),t=i,i=this._getSBHeight(),c=c.prev("tr");if(!c.hasClass("pq-row-hidden")&&!c.hasClass("pq-last-frozen-row")&&r-t<e){var u,p=e-(r-i-t),f=d.children().children("tr"),g=0,v=0;for((!l||0==(u=f.filter("tr.pq-last-frozen-row").last().next()).length)&&(u=f.filter("tr.pq-row-hidden").next());;){if(!u.length)break;if(g+=u[0].offsetHeight,u[0]==h[0])break;if(o&&0!=u.hasClass("pq-detail-child")){if(p<=g)break}else if(v++,p<=g)break;u=u.next()}a=a+v;s<a&&(a=s);s=n.option("num_eles");n.option({num_eles:s=s<a+1?a+1:s,cur_pos:a}),n.scroll()}}}}},e.blurEditor=function(t){if(this.$div_focus){var e=this.$div_focus.find(".pq-editor-focus");if(!t||!t.blurIfFocus)return e.triggerHandler("blur",t);document.activeElement==e[0]&&e.blur()}},e._scrollColumnVirtual=function(t){var e=t.colIndx,r=this.hscroll,e=null==e?this.colIndxs[t.dataIndx]:e,o=this.options.freezeCols,i=this._calcRightEdgeCol(e).width,t=this.iRefresh.getEContWd();if(t<i){for(var n=this.calcWidthCols(-1,e+1)-t,a=this.colModel,l=a.length,s=0,d=0,h=o;h<l;h++){var c=a[h];if(c.hidden||(s+=c.outerWidth),h==e){d=h-o-this._calcNumHiddenUnFrozens(h);break}if(n<=s){d=h-o-this._calcNumHiddenUnFrozens(h)+1;break}}return r.option("cur_pos",d),r.scroll(),!0}if(o<=e&&e<this.initH){t=e-o-this._calcNumHiddenUnFrozens(e);return r.option("cur_pos",t),r.scroll(),!0}return!1},e.scrollColumn=function(t){var e=this.options,r=e.virtualX;return!("flex"===e.width&&!e.maxWidth)&&(r?this._scrollColumnVirtual(t):this.iMouseSelection.scrollColumnNonVirtual(t))},e.selection=function(t){if(t){var e=t.method,r=t.type;return"row"==r?o=this.iRows[e](t):"cell"==r&&(o=this.iCells[e](t)),"add"!=e&&"remove"!=e&&"removeAll"!=e||(this.iSelection.dirty=!0,this.iSelection._trigger()),o}var o=this.iSelection;return o.isDirty()&&o.refresh(),o},e.goToPage=function(t){var e,r,o=this.options.pageModel;"local"!=o.type&&"remote"!=o.type||(e=t.rowIndx,r=o.rPP,(t=null==t.page?Math.ceil((e+1)/r):t.page)!=o.curPage&&(o.curPage=t,"local"==o.type?this.refreshView():this.refreshDataAndView()))},e.setSelection=function(t){if(null==t)return this.iSelection.removeAll(),!0;var e=this.pdata;if(!e||!e.length)return!1;var r=(t=this.normalize(t)).rowIndx,o=t.rowIndxPage,i=t.colIndx;if(t.rowData&&null==r&&(e=this.getRowIndx(t),t.rowIndx=r=e.rowIndx,t.rowIndxPage=o=e.rowIndxPage),null==r||r<0||i<0||i>=this.colModel.length)return!1;this.goToPage(t),o=r-this.rowIndxOffset,this.scrollRow({rowIndxPage:o}),null==i?this.range({r1:r}).select():(this.scrollColumn({colIndx:i}),this.range({r1:r,c1:i}).select()),!1!==t.focus&&this.focus({rowIndxPage:o,colIndx:null==i?this.getFirstVisibleCI():i})},e.getColModel=function(){return this.colModel},e.saveEditCell=function(t){var e=this.options,r=e.editModel;if(!r.indices)return null;var o,i=z.extend({},r.indices),n=t?t.evt:null,a=this.rowIndxOffset,l=i.colIndx,r=i.rowIndxPage,t=r+a,i=this.colModel[l],a=i.dataIndx,s=this.pdata[r],l=e.dataModel;if(null==s)return null;if(null!=r){e=this.getEditCellData();if(z.isPlainObject(e))for(var d in o={},e)o[d]=s[d];else o=this.readCell(s,i);"<br>"==e&&(e="");r={rowIndx:t,rowIndxPage:r,dataIndx:a,column:i,newVal:e=null==o&&""===e?null:e,value:e,oldVal:o,rowData:s,dataModel:l};if(!1===this._trigger("cellBeforeSave",n,r))return!1;i={},l=!1;return(z.isPlainObject(e)?(i=e,l=!0):i[a]=e,!1===this.updateRow({row:i,rowIndx:t,refresh:l,silent:!0,source:"edit",checkEditable:!1}))?!1:(this._trigger("cellSave",n,r),!0)}},e._addInvalid=function(t){},e._digestData=function(t){if(!1===this._trigger("beforeValidate",null,t))return!1;for(var e=this,r=e.options,o=r.editModel,i=r.dataModel,n=i.data,a=r.colModel,l=r.pageModel,s=r.historyModel,d=null==(d=t.validate)?o.validate:d,h="remote"==l.type,c=null==(c=t.allowInvalid)?o.allowInvalid:c,o=r.trackModel,u=null==(u=t.track)?null==r.track?o.on:r.track:u,o=null==(o=t.history)?s.on:o,s=this.iHistory,p=this.iUCData,f=null==(f=t.checkEditable)||f,g=null==(g=t.checkEditableAdd)?f:g,v=this.saveCell,w=this.columns,m=this.colIndxs,x=t.source,_=this.rowIndxOffset,I=e.getValueFromDataType,y=t.rowList,b=y.length,n=n||(r.dataModel.data=[]),C=[],q=0;q<b;q++){var M=(A=y[q]).newRow,D=A.rowData,R=A.type,P=A.checkEditable,T=A.rowIndx,S=A.oldRow;if(null==P&&("update"==R?P=f:"add"==R&&(P=g)),"update"==R){if(!S)throw"oldRow required while update";if(P&&!0!==r.editable&&!1===e.isEditableRow({rowIndx:T,rowData:D}))continue}else if("delete"==R){C.push(A);continue}if("add"==R)for(var k=0,H=a.length;k<H;k++)M[L=(E=a[k]).dataIndx]=M[L];for(L in M){var E=w[L],$=m[L];if(E)if(P&&null!=E.editable&&!1===e.isEditableCell({rowIndx:T,colIndx:$,dataIndx:L}))delete M[L],S&&delete S[L];else{var V,z=E.dataType,W=I(M[L],z),$=void 0!==($=S?S[L]:void 0)?I($,z):void 0;if(M[L]=W,d&&E.validations)if("edit"==x&&!1===c){if(0==(V=this.isValid({focusInvalid:!0,dataIndx:L,rowIndx:T,value:W})).valid&&!V.warn)return!1}else!1===(V=this.iIsValid.isValidCell({column:E,rowData:"add"==R?M:D,allowInvalid:c,value:W})).valid&&(!1!==c||V.warn||delete M[L]);"update"!=R||W!==$||(delete M[L],S&&delete S[L])}}if(M)if("update"==R)for(var L in M){C.push(A);break}else C.push(A)}if(!(b=(y=t.rowList=C).length))return"edit"==x&&null;o&&(s.increment(),s.push({rowList:y}));for(q=0;q<b;q++){var A,F,O,N,R=(A=y[q]).type,M=A.newRow,T=A.rowIndx,j=A.rowIndxPage,D=A.rowData;if("update"==R)for(var L in u&&p.update({rowData:D,row:M,refresh:!1}),M)v(D,E=w[L],W=M[L]);else"add"==R?(u&&p.add({rowData:M}),null==T&&null==j?n.push(M):(j=T-_,n.splice(O=h?j:T,0,M)),h&&l.totalRecords++):"delete"==R&&(N=(F=e.getRowIndx({rowData:D,dataUF:!0})).uf,T=F.rowIndx,u&&p.delete({rowIndx:T,rowData:D}),j=T-_,O=h?j:T,N?i.dataUF.splice(T,1):(N=n.splice(O,1))&&N.length&&h&&l.totalRecords--)}return e._trigger("change",null,t),!0},e.refreshColumn=function(t){var e=this.normalize(t),r=this.initV,o=this.finalV,i=this.options.freezeRows,n=e.colIndx,a=e.dataIndx,t=e.column;e.skip=!0;for(var l=0;l<=o;l++)e.rowIndxPage=l=l<r&&i<=l?r:l,this.refreshCell(e);this._trigger("refreshColumn",null,{column:t,colIndx:n,dataIndx:a}),this.iRefresh.softRefresh()},e.refreshCell=function(t){var e,r,o,i,n,a,l=this.normalize(t);this.pdata&&(e=l.skip,r=l.rowIndx,o=l.rowIndxPage,i=l.colIndx,n=this.iMerge,!l.rowData||(a=this.getCell({all:!0,rowIndxPage:o,colIndx:i}))&&0<a.length&&(t=l,n.ismergedCell(r,i)&&(t=n.getRootCell(r,i,"a")),(t=this.iGenerateView.renderCell(t))&&(a.replaceWith(t),(t=this._focusElement)&&t.rowIndxPage==o&&this.focus(),e||(this._trigger("refreshCell",null,l),this.iRefresh.softRefresh()))))},e.refreshRow=function(t){var e=this.normalize(t);if(this.pdata){var r=this,o=e.rowIndx,i=e.rowIndxPage,n=r.options,a=n.freezeRows,l=e.rowData;if(!l||l.pq_hidden||i>r.finalV||i<r.initV&&a<=i)return null;var s=this.getRow({all:!0,rowIndxPage:i}),t=[];r.iGenerateView.refreshRow(i,t);var d=t.join("");if(s&&s.length)s.replaceWith(d);else{if(!n.virtualY)return!1;if(i==r.finalV)r.$tbl.append(d);else{if(i!=r.initV)throw"refreshRow > rip not found";for(var h=r.$tbl,c=0;c<h.length;c++)z(h[c]).children("tbody").children(a?".pq-last-frozen-row":"tr:first").after(d)}}return(n=this._focusElement)&&n.rowIndxPage==i&&r.focus(),this._trigger("refreshRow",null,{rowData:l,rowIndx:o,rowIndxPage:i}),!1!==e.refresh&&this.iRefresh.softRefresh(),!0}},e.quitEditMode=function(t){var e,r,o,i,n,a;this._quitEditMode||(o=r=e=!1,n=(i=this.options.editModel).indices,this._quitEditMode=!(a=void 0),t&&(e=t.old,r=t.silent,o=t.fireOnly,a=t.evt),n&&(r||e||this._trigger("editorEnd",a,n),o||(this._removeEditOutline(t),i.indices=null)),this._quitEditMode=null)},e.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}},e.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}},e.getRowIndxOffset=function(){return this.rowIndxOffset},e.getEditCell=function(){var t=this.options.editModel;if(t.indices){var e=this.getCell(t.indices),r=this.$div_focus.children(".pq-editor-inner"),t=r.find(".pq-editor-focus");return{$td:e,$cell:r,$editor:t}}return{}},e.editCell=function(t){var e=this.normalize(t),r=this.iMerge,o=e.rowIndx,t=e.colIndx;if(r.ismergedCell(o,t)){var i=r.getRootCell(o,t,"o");if(i.rowIndx!=e.rowIndx||i.colIndx!=e.colIndx)return!1}this.scrollRow(e),this.scrollColumn(e);i=this.getCell(e);if(i&&i.length)return this._editCell(e)},e.getFirstEditableColIndx=function(t){if(null==t.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(t))return-1;for(var e=this.colModel,r=0;r<e.length;r++)if(t.colIndx=r,this.isEditableCell(t)&&!e[r].hidden)return r;return-1},e.editFirstCellInRow=function(t){var e=this.rowIndxOffset,r=t.rowIndx,t=t.rowIndxPage,r=null==r?t+e:r,t=null==t?r-e:t,r=this.getFirstEditableColIndx({rowIndx:r});-1!=r&&this.editCell({rowIndxPage:t,colIndx:r})},e._editCell=function(t){var e=this.normalize(t),r=e.evt,o=e.rowIndxPage,i=e.colIndx,n=(S=this).pdata;if(!n||o>=n.length)return!1;var a=this.options,l=a.editModel,s=n[o],d=e.rowIndx,h=this.colModel[i],c=h.dataIndx,u=S.readCell(s,h),p={rowIndx:d,rowIndxPage:o,cellData:u,rowData:s,dataIndx:c,colIndx:i,column:h},f=h.editor,g=this;if(!1!==(f=void 0===(f="function"==typeof f?f.call(g,p):f)&&"function"==typeof a.geditor?a.geditor.call(g,p):f)){f&&f.getData&&(l._getData=f.getData);var v=a.editor,w=f?z.extend({},v,f):v,m=!1;if(l.indices){var x=l.indices;if(x.rowIndxPage==o&&x.colIndx==i){this.refreshEditorPos();var _=this.$div_focus.find(".pq-editor-focus");return window.setTimeout(function(){_.focus()},0),!1}if(!1===this.blurEditor({evt:r}))return!1;this.quitEditMode({evt:r})}l.indices={rowIndxPage:o,rowIndx:d,colIndx:i,column:h,dataIndx:c},this._generateCellRowOutline();var I=this.$div_focus.children(".pq-editor-inner");"right"==h.align?I.addClass("pq-align-right"):"center"==h.align?I.addClass("pq-align-center"):I.addClass("pq-align-left"),p.$cell=I;var y,b,C,q=w.type,M=(null==e.select?w:e).select,D=w.init,R=w.valueIndx,P=w.dataMap,T=(T=w.mapIndices)||{},t=w.cls||"",n="pq-editor-focus "+(t="function"==typeof t?t.call(g,p):t),a=n+" pq-cell-editor ",f="function"==typeof(f=w.attr||"")?f.call(g,p):f,x=w.style||"",e=(x="function"==typeof x?x.call(g,p):x)?"style='"+x+"'":"",t=e,x=e;p.cls=n,p.attr=f,"function"==typeof q&&(y=q.call(g,p))&&(q=y),"checkbox"==(v._type=q)?(b=w.subtype,I.html(y="<input "+(u?"checked='checked'":"")+" class='"+a+"' "+f+" "+x+" type=checkbox name='"+c+"' />"),C=I.children("input"),"triple"==b&&(C.pqval({val:u}),I.click(function(t){z(this).children("input").pqval({incr:!0})}))):"textarea"==q||"select"==q||"textbox"==q?(y="textarea"==q?"<textarea class='"+a+"' "+f+" "+t+" name='"+c+"' ></textarea>":"select"==q?("function"==typeof(b=w.options||[])&&(b=b.call(g,p)),C=[f," class='",a,"' ",t," name='",c,"'"].join(""),W.select({options:b,attr:C,prepend:w.prepend,labelIndx:w.labelIndx,valueIndx:R,groupIndx:w.groupIndx,dataMap:P})):"<input class='"+a+"' "+f+" "+t+" type=text name='"+c+"' />",z(y).appendTo(I).val("select"==q&&null!=R&&(T[R]||this.columns[R])?T[R]?s[T[R]]:s[R]:u)):q&&"contenteditable"!=q||(I.html(y="<div contenteditable='true' tabindx='0' "+e+" "+f+" class='"+a+"'></div>"),I.children().html(u),m=!0),"function"==typeof D&&D.call(g,p);var S=this,_=I.children(".pq-editor-focus"),k=l.filterKeys,p=h.editModel;p&&void 0!==p.filterKeys&&(k=p.filterKeys);var H={$cell:I,$editor:_,dataIndx:c,column:h,colIndx:i,rowIndx:d,rowIndxPage:o,rowData:s};if(l.indices=H,_.data({FK:k}).on("click",function(t){z(this).focus()}).on("keydown",function(t){S.iKeyNav._keyDownInEdit(t)}).on("keypress",function(t){return S.iKeyNav._keyPressInEdit(t,{FK:k})}).on("keyup",function(t){return S.iKeyNav._keyUpInEdit(t,{FK:k})}).on("blur",function(t,e){var r=S.options.editModel,o=r.onBlur,i="save"==o,n="validate"==o,a=r.cancelBlurCls,e=!!e&&e.force;if(!S._quitEditMode&&!S._blurEditMode&&r.indices){r=z(t.target);if(!e){if(!1===S._trigger("editorBlur",t,H))return;if(!o)return;if(a&&r.hasClass(a))return;if(r.hasClass("hasDatepicker")){if(r.datepicker("widget").is(":visible"))return!1}else if(r.hasClass("ui-autocomplete-input")){if(r.autocomplete("widget").is(":visible"))return}else if(r.hasClass("ui-multiselect")){if(z(".ui-multiselect-menu").is(":visible")||z(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(r.hasClass("pq-select-button")&&(z(".pq-select-menu").is(":visible")||z(document.activeElement).closest(".pq-select-menu").length))return}S._blurEditMode=!0;i=e||i||!n;if(!S.saveEditCell({evt:t,silent:i})&&!e&&n)return S._deleteBlurEditMode(),!1;S.quitEditMode({evt:t}),S._deleteBlurEditMode()}}).on("focus",function(t){S._trigger("editorFocus",t,H)}),S._trigger("editorBegin",r,H),_.focus(),window.setTimeout(function(){!1===z(document.activeElement).hasClass("pq-editor-focus")&&(S.element?S.element.find(".pq-editor-focus"):z()).focus()},0),M)if(m)try{var E=_[0],$=document.createRange();$.selectNodeContents(E);var V=window.getSelection();V.removeAllRanges(),V.addRange($)}catch(t){}else _.select()}},e._deleteBlurEditMode=function(t){var e=this,t=t||{};e._blurEditMode&&(t.timer?window.setTimeout(function(){delete e._blurEditMode},0):delete e._blurEditMode)},e.getRow=function(t){var e=this.normalize(t),r=e.rowIndxPage,o=e.all?this.$tbl:this.get$Tbl(r),t=z();return o&&o.length&&(e=o.children("tbody"),null!=r&&(t=e.children("tr[pq-row-indx="+r+"]")).length>o.length&&(t=t.filter(".pq-detail-master"))),t},e.getCell=function(t){var e=t.all,r=this.options,o=this.normalize(t),i=o.rowIndxPage,n=o.rowIndx,a=o.colIndx,l=this.iMerge;if(l.ismergedCell(n,a)){t=l.getRootCell(n,a,"a"),n=l.getRootCell(n,a,"o");if(!(i===n.rowIndxPage&&a===n.colIndx||i===t.rowIndxPage&&a===t.colIndx))return z();i=t.rowIndxPage,a=n.colIndx}else{if(i>=r.freezeRows&&(i<this.initV||i>this.finalV)||a>=r.freezeCols&&(a<this.initH||a>this.finalH))return z();if(!o.rowData||!o.column||o.rowData.pq_hidden||o.column.hidden)return z()}e=e?this.$tbl:this.get$Tbl(i,a),a=e&&e.length?e.children().children("tr[pq-row-indx="+i+"]").children("[pq-col-indx="+a+"]"):z();return a},e.getCellHeader=function(t){var e=t.colIndx,r=t.dataIndx,e=null==e?this.colIndxs[r]:e,t=this.$tbl_header,r=this.options.freezeCols;return t?(t=1<t.length?z(r<=e?t[1]:t[0]):t).find("[pq-col-indx="+e+"].pq-grid-col-leaf"):z()},e.getEditorIndices=function(){var t=this.options.editModel.indices;return t?z.extend({},t):null},e.getEditCellData=function(){var t=this.options,e=t.editModel,r=e.indices;if(!r)return null;var o=r.colIndx,i=r.rowIndxPage,n=r.rowIndx,a=this.colModel[o],l=a.editor,s=t.editor,d=l?z.extend({},s,l):s,h=d.valueIndx,c=d.labelIndx,u=(u=d.mapIndices)||{},p=a.dataIndx,t=this.$div_focus.children(".pq-editor-inner"),l=e._getData||d.getData;if(e._getData=void 0,"function"==typeof l)f=l.call(this,{$cell:t,rowData:r.rowData,dataIndx:p,rowIndx:n,rowIndxPage:i,column:a,colIndx:o});else{o=s._type;if("checkbox"==o)var s=t.children(),f="triple"==d.subtype?s.pqval():!!s.is(":checked");else if("contenteditable"==o)f=t.children().html();else{p=t.find('*[name="'+p+'"]');if(p&&p.length)if("select"==o&&null!=h)if(u[h]||this.columns[h]){(f={})[u[h]||h]=p.val(),f[u[c]||c]=p.find("option:selected").text();var g=d.dataMap;if(g){var v=p.find("option:selected").data("map");if(v)for(var w=0;w<g.length;w++){var m=g[w];f[u[m]||m]=v[m]}}}else f=p.val();else f=p.val();else(p=t.find(".pq-editor-focus"))&&p.length&&(f=p.val())}}return f},e.getCellIndices=function(t){var e=t.$td;if(null==e||0==e.length||e.closest(".pq-grid")[0]!=this.element[0])return{};var r,t=e.parent("tr").attr("pq-row-indx");null!=t&&(r=(t=parseInt(t))+this.rowIndxOffset);e=e.attr("pq-col-indx");return null!=e&&0<=(e=parseInt(e))&&this.colModel[e].dataIndx,this.iMerge.getRootCell(r,e,"o")},e.getRowsByClass=function(t){var e=this.options,r=e.dataModel,o="remote"==e.pageModel.type,i=this.rowIndxOffset,n=r.data,a=[];if(null==n)return a;for(var l=0,s=n.length;l<s;l++){var d,h,c=n[l];c.pq_rowcls&&(t.rowData=c,this.hasClass(t)&&(h=(d=o?l+i:l)-i,(c={rowData:c}).rowIndx=d,c.rowIndxPage=h,a.push(c)))}return a},e.getCellsByClass=function(t){var e=this.options,r=e.dataModel,o="remote"==e.pageModel.type,i=this.rowIndxOffset,n=r.data,a=[];if(null==n)return a;for(var l=0,s=n.length;l<s;l++){var d=n[l],h=o?l+i:l,c=d.pq_cellcls;if(c)for(var u in c){u={rowData:d,rowIndx:h,dataIndx:u,cls:t.cls};this.hasClass(u)&&(u=this.normalize(u),a.push(u))}}return a},e.data=function(t){var e=t.dataIndx,r=t.colIndx,e=null!=r?this.colModel[r].dataIndx:e,o=t.data,r=null==o||"string"==typeof o,t=t.rowData||this.getRowData(t);if(!t)return{data:null};if(null==e){var i=t.pq_rowdata;if(r)return{data:a=null!=i?null==o?i:i[o]:a};var n=z.extend(!0,t.pq_rowdata,o);t.pq_rowdata=n}else{var a,i=t.pq_celldata;if(r)return null!=i&&(r=i[e],a=null==o||null==r?r:r[o]),{data:a};i||(t.pq_celldata={});n=z.extend(!0,t.pq_celldata[e],o);t.pq_celldata[e]=n}},e.attr=function(t){var e=t.rowIndx,r=t.dataIndx,o=t.colIndx,r=null!=o?this.colModel[o].dataIndx:r,i=t.attr,n=null==i||"string"==typeof i,a=this.rowIndxOffset,o=t.refresh,t=t.rowData||this.getRowData(t);if(!t)return{attr:null};if(n||!1===o||null!=e||(e=this.getRowIndx({rowData:t}).rowIndx),null==r){var l=t.pq_rowattr;if(n)return{attr:s=null!=l?null==i?l:l[i]:s};l=z.extend(!0,t.pq_rowattr,i);t.pq_rowattr=l,!1===o||null==e||(d=this.getRow({rowIndxPage:e-a}))&&(h=y(l),d.attr(h))}else{var s,d=t.pq_cellattr;if(n)return null!=d&&(n=d[r],s=null==i||null==n?n:n[i]),{attr:s};d||(t.pq_cellattr={});var h,l=z.extend(!0,t.pq_cellattr[r],i);t.pq_cellattr[r]=l,!1===o||null==e||(r=this.getCell({rowIndxPage:e-a,dataIndx:r}))&&(h=y(l),r.attr(h))}};var y=function(t){var e,r={};for(e in t){var o=t[e];if(o)if("title"==e)o=o.replace(/\"/g,"&quot;"),r[e]=o;else if("style"==e&&"object"==typeof o){var i,n,a=[];for(n in o)(i=o[n])&&a.push(n+":"+i);(o=a.join(";")+(a.length?";":""))&&(r[e]=o)}else"object"==typeof o&&(o=JSON.stringify(o)),r[e]=o}return r};e.removeData=function(t){var e=t.dataIndx,r=t.colIndx,e=null!=r?this.colModel[r].dataIndx:e,r=t.data,o="string"==typeof(r=null==r?[]:r)?r.split(" "):r,i=o.length,t=t.rowData||this.getRowData(t);if(t)if(null==e){var n=t.pq_rowdata;if(n){if(i)for(var a=0;a<i;a++)delete n[o[a]];i&&!z.isEmptyObject(n)||delete t.pq_rowdata}}else{t=t.pq_celldata;if(t&&t[e]){var l=t[e];if(i)for(a=0;a<i;a++)delete l[o[a]];i&&!z.isEmptyObject(l)||delete t[e]}}},e.removeAttr=function(t){var e=t.rowIndx,r=t.dataIndx,o=t.colIndx,r=null!=o?this.colModel[o].dataIndx:r,i=t.attr,n="string"==typeof(i=null==i?[]:i)?i.split(" "):i,a=n.length,l=e-this.rowIndxOffset,s=t.refresh,o=t.rowData||this.getRowData(t);if(o)if(!1!==s&&null==e&&(e=this.getRowIndx({rowData:o}).rowIndx),null==r){var d=o.pq_rowattr;if(d){if(a)for(var h=0;h<a;h++)delete d[c=n[h]];else for(var c in d)n.push(c);a&&!z.isEmptyObject(d)||delete o.pq_rowattr}!1!==s&&null!=e&&n.length&&(i=n.join(" "),(t=this.getRow({rowIndxPage:l}))&&t.removeAttr(i))}else{o=o.pq_cellattr;if(o&&o[r]){var u=o[r];if(a)for(h=0;h<a;h++)delete u[c=n[h]];else for(var c in u)n.push(c);a&&!z.isEmptyObject(u)||delete o[r]}!1!==s&&null!=e&&n.length&&(i=n.join(" "),(r=this.getCell({rowIndxPage:l,dataIndx:r}))&&r.removeAttr(i))}},e.normalize=function(t){var e,r={};for(e in t)r[e]=t[e];var o,i=r.rowIndx,n=r.rowIndxPage,a=r.dataIndx,l=r.colIndx;return null==n&&null==i||(o=this.rowIndxOffset,i=null==i?parseInt(n,10)+o:i,n=null==n?parseInt(i,10)-o:n,r.rowIndx=i,r.rowIndxPage=n,r.rowData=r.rowData||this.getRowData(r)),null==l&&null==a||(n=this.colModel,a=null==a?n[l]?n[l].dataIndx:void 0:a,l=null==l?this.colIndxs[a]:l,r.column=n[l],r.colIndx=l,r.dataIndx=a),r},e.addClass=function(t){var e=this.normalize(t),r=e.rowIndxPage,o=e.dataIndx,i=pq.arrayUnique,n=e.cls,a=e.refresh,t=e.rowData;if(t)if(!1!==a&&null==r&&(r=this.getRowIndx({rowData:t}).rowIndxPage),null==o){e=t.pq_rowcls;c=i((c=e?e+" "+n:n).split(/\s+/)).join(" "),t.pq_rowcls=c,!1===a||null==r||(e=this.getRow({rowIndxPage:r}))&&e.addClass(n)}else{var l=[];"function"!=typeof o.push?l.push(o):l=o;for(var s=(s=t.pq_cellcls)||(t.pq_cellcls={}),d=0,h=l.length;d<h;d++){var c,u=s[o=l[d]];c=i((c=u?u+" "+n:n).split(/\s+/)).join(" "),s[o]=c,!1===a||null==r||(u=this.getCell({rowIndxPage:r,dataIndx:o}))&&u.addClass(n)}}},e.removeClass=function(t){var t=this.normalize(t),e=t.rowIndx,r=t.rowData,o=t.dataIndx,i=t.cls,n=t.refresh;if(r){var a=r.pq_cellcls,t=r.pq_rowcls;if(!1!==n&&null==e&&(e=this.getRowIndx({rowData:r}).rowIndx),null==o)t&&(r.pq_rowcls=this._removeClass(t,i),null==e||!1===n||(t=this.getRow({rowIndx:e}))&&t.removeClass(i));else if(a){var l=[];"function"!=typeof o.push?l.push(o):l=o;for(var s=0,d=l.length;s<d;s++){var h=a[o=l[s]];h&&(r.pq_cellcls[o]=this._removeClass(h,i),null==e||!1===n||(h=this.getCell({rowIndx:e,dataIndx:o}))&&h.removeClass(i))}}}},e.hasClass=function(t){var e=t.dataIndx,r=t.cls,o=this.getRowData(t),t=new RegExp("\\b"+r+"\\b");if(o){if(null==e)return!(!(r=o.pq_rowcls)||!t.test(r));o=o.pq_cellcls;return!!(o&&o[e]&&t.test(o[e]))}return null},e._removeClass=function(t,e){if(t&&e){for(var r=t.split(/\s+/),o=e.split(/\s+/),i=[],n=0,a=r.length;n<a;n++){for(var l=r[n],s=!1,d=0,h=o.length;d<h;d++)if(l===o[d]){s=!0;break}s||i.push(l)}return 1<i.length?i.join(" "):1===i.length?i[0]:null}},e.getRowIndx=function(t){var e,r=t.$tr,o=t.rowData,i=this.rowIndxOffset;if(o){var n=this.options.dataModel,a=this.get_p_data(),l=!1,s=t.dataUF?n.dataUF:null,d=!1;if(a)for(var h=0,c=a.length;h<c;h++)if(a[h]==o){d=!0;break}if(!d&&s)for(l=!0,h=0,c=s.length;h<c;h++)if(s[h]==o){d=!0;break}return d?(e=h-i,{rowIndxPage:l?void 0:e,uf:l,rowIndx:h,rowData:o}):{}}return null==r||0==r.length||null==(e=r.attr("pq-row-indx"))?{}:{rowIndxPage:e=parseInt(e),rowIndx:e+i}},e.search=function(t){for(var e=this.options,r=t.row,o=t.first,t=e.dataModel,e=e.pageModel.type,i=[],n=this.rowIndxOffset,a="remote"==e,l=t.data,s=0,d=l.length;s<d;s++){var h,c=l[s],u=!0;for(h in r)r[h]!==c[h]&&(u=!1);if(u){var p=this.normalize({rowIndx:a?s+n:s});if(i.push(p),o)break}}return i};var w=function(t){this.options=t.options,this.that=t},t=w.prototype;t._incrRowIndx=function(t,e){for(var r=t,o=this.that.pdata,i=0,n=t+1,a=o.length;n<a;n++){var l=o[n].pq_hidden;if(!l&&(r=n,1==++i))return r}return r},t._decrRowIndx=function(t,e){for(var r=t,o=this.that.pdata,i=0,n=t-1;0<=n;n--){var a=o[n].pq_hidden;if(!a&&(r=n,1==++i))return r}return r},t._decrRowIndx2=function(t,e){var r=this.that,o=t+r.rowIndxOffset,i=r.iMerge,n=r.pdata;i.ismergedCell(o,e)&&(r=i.getRootCell(o,e,"a"),o=i.getData(o,e,"proxy_cell"),e=r.colIndx,e=o?o.colIndx:e);for(var a=t-1;0<=a;a--)if(!n[a].pq_hidden){t=a;break}return{rowIndxPage:t,colIndx:e}},t._incrRowIndx2=function(t,e){var r,o=this.that,i=t+o.rowIndxOffset,n=o.iMerge,a=o.pdata;(r=n.ismergedCell(i,e))&&(o=n.getRootCell(i,e,"a"),i=n.getData(i,e,"proxy_cell"),e=o.colIndx,t=r.rowspan?t+r.rowspan-1:0,e=i?i.colIndx:e);for(var l=t+1,s=a.length;l<s;l++)if(!a[l].pq_hidden){t=l;break}return{rowIndxPage:t,colIndx:e}},e.addColumn=function(t){for(var e=t.colList||[{colIndx:t.colIndx,column:t.column}],r=!1!==t.history,o=this.options.colModel,i=0;i<e.length;i++){var n=e[i].colIndx,a=e[i].column;null==a.dataIndx&&(a.dataIndx=Math.random()),null==n&&(n=e.colIndx=o.length),o.splice(n,0,a)}this.iColModel.init(),r&&(this.iHistory.increment(),e.type="add",this.iHistory.push({colList:e})),this._trigger("addColumn",null,{colList:e}),!1!==t.refresh&&this.refreshView()},e.deleteColumn=function(t){for(var e=t.colList||[{colIndx:t.colIndx}],r=!1!==t.history,o=this.options.colModel,i=e.length-1;0<=i;i--){var n=e[i],a=n.colIndx,a=o.splice(a,1)[0];n.column=a}this.iColModel.init(),r&&(this.iHistory.increment(),e.type="delete",this.iHistory.push({colList:e})),this._trigger("deleteColumn",null,{colList:e}),!1!==t.refresh&&this.refreshView()},t._incrIndx=function(t,e,r){var o,i,n,a,l,s=this.that,d=s.iMerge,h=s.pdata,c=s.rowIndxOffset,u=s[r?"getLastVisibleRIP":"getFirstVisibleRIP"](),p=s.colModel,f=p.length;if(null==e)return t==u?null:{rowIndxPage:t=this[r?"_incrRowIndx":"_decrRowIndx"](t)};do{if((o=d.ismergedCell(n=t+c,e))&&(!l&&(i=d.getData(n,e,"proxy_cell"))&&(h[a=i.rowIndx-c].pq_hidden||(t=a)),h[t].pq_hidden&&(t=d.getRootCell(n,e).rowIndxPage),!l&&r&&(e+=o&&o.colspan?o.colspan-1:0)),e=r?e+1:e-1,r&&f<=e||!r&&e<0){if(t==u)return null;t=this[r?"_incrRowIndx":"_decrRowIndx"](t),e=r?0:f-1}}while((l=p[e])&&l.hidden);return{rowIndxPage:t,colIndx:e}},t._incrEditIndx=function(t,e,r){var o=this.that,i=o.colModel,n=i.length,a=o.iMerge,l=o.rowIndxOffset,s=o[r?"getLastVisibleRIP":"getFirstVisibleRIP"]();do{var d=t+l,h=a.ismergedCell(d,e);if(e=h?((u=a.getData(d,e,"proxy_edit_cell"))&&(t=(d=u.rowIndx)-l),r?e+h.colspan:e-1):r?e+1:e-1,r&&n<=e||!r&&e<0){if(t==s)return null;do{t=this[r?"_incrRowIndx":"_decrRowIndx"](t);var c=o.isEditableRow({rowIndxPage:t});if(t==s&&0==c)return null}while(0==c);e=r?0:n-1}(h=a.ismergedCell(d=t+l,e))&&(p=a.getRootCell(d,e,"o"),a.setData(p.rowIndx,p.colIndx,{proxy_edit_cell:{rowIndx:d,colIndx:e}}),d=p.rowIndx,e=p.colIndx);var u=i[e],h=o.isEditableCell({rowIndx:d,colIndx:e,checkVisible:!0}),p="function"==typeof(p=u.editor)?p.call(o,o.normalize({rowIndx:d,colIndx:e})):p}while(t=d-l,u&&(u.hidden||0==h||!1===p));return{rowIndxPage:t,colIndx:e}},t.getMergeCell=function(t,e){var r,o,i=this.that,n=i.options,a=i.iMerge;return a.ismergedCell(t,e)&&(o=a.getRootCell(t,e,"o"),a.setData(o.rowIndx,o.colIndx,{proxy_cell:{rowIndx:t,colIndx:e}}),n.virtualY&&(r=a.getRootCell(t,e,"a"))),r||(t=this.getVisibleRowIndx(t),e=this.getVisibleColIndx(e),r=i.normalize({rowIndx:t,colIndx:e})),r},t.getVisibleRowIndx=function(t){for(var e=this.that,r=e.pdata.length,o=t-e.rowIndxOffset,i=e.getRowData({rowIndx:t});i.pq_hidden&&o<r-1;)o++,i=e.getRowData({rowIndx:++t});return t},t.getVisibleColIndx=function(t){for(var e=this.that.colModel,r=e.length,o=e[t];o.hidden&&t<r-1;)o=e[++t];return t},e._onKeyPressDown=function(t){return 0<z(t.target).closest(".pq-grid-header").length?0!=this._trigger("headerKeyDown",t,null):!1!==this.iKeyNav._bodyKeyPressDown(t)&&(0!=this._trigger("keyDown",t,null)&&void 0)},t._saveAndMove=function(t,e){if(null==t)return e.preventDefault(),!1;var r=this.that,o=t.rowIndxPage,i=t.colIndx;if(!(r._blurEditMode=!0)===r.saveEditCell({evt:e})||!r.pdata)return r.pdata||r.quitEditMode(e),r._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),e.preventDefault(),!1;r.quitEditMode(e),t.incr&&(o=(n=this[t.edit?"_incrEditIndx":"_incrIndx"](o,i,!e.shiftKey))?n.rowIndxPage:o,i=n?n.colIndx:i),r.scrollRow({rowIndxPage:o}),r.scrollColumn({colIndx:i});var n=o+r.rowIndxOffset;return this.select({rowIndx:n,colIndx:i,evt:e}),t.edit&&r._editCell({rowIndxPage:o,colIndx:i}),r._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"}),e.preventDefault(),!1},t._keyPressInEdit=function(t,e){var r=this.that,o=r.options.editModel.indices,i=(e||{}).FK,n=o.column,a=z.ui.keyCode,e=["BACKSPACE","LEFT","RIGHT","UP","DOWN","DELETE","HOME","END"].map(function(t){return a[t]}),n=n.dataType;if(0<=z.inArray(t.keyCode,e))return!0;if(!1===r._trigger("editorKeyPress",t,z.extend({},o)))return!1;if(i&&("float"==n||"integer"==n)){n="float"==n?"0123456789.-":"0123456789-",t=t.charCode||t.keyCode,t=String.fromCharCode(t);if(t&&-1==n.indexOf(t))return!1}return!0},t.getValText=function(t){var e=t[0].nodeName.toLowerCase(),t="text";return t=-1!=z.inArray(e,["input","textarea","select"])?"val":t},t._keyUpInEdit=function(t,e){var r=this.that,o=r.options,i=(e=e||{}).FK,n=o.editModel,e=n.indices;r._trigger("editorKeyUp",t,z.extend({},e));o=e.column.dataType;!i||"float"!=o&&"integer"!=o||(r=z(t.target),e="integer"==o?n.reInt:n.reFloat,i=this.getValText(r),t=r.data("oldVal"),n=r[i](),0==e.test(n)&&(e.test(t)?r[i](t):(t=("float"==o?parseFloat:parseInt)(t),isNaN(t)?r[i](0):r[i](t))))},t._keyDownInEdit=function(t){var e=this.that,r=e.options,o=r.editModel.indices;if(o){var i=z(t.target),n=z.ui.keyCode,a=r.editModel,l=(s=z.extend({},o)).rowIndxPage,r=s.colIndx,o=s.column.editModel,o=o?z.extend({},a,o):a,a=this.getValText(i);if(i.data("oldVal",i[a]()),0==e._trigger("editorKeyDown",t,s))return!1;if(t.keyCode==n.TAB||t.keyCode==o.saveKey){var a=t.keyCode==n.TAB?o.onTab:o.onSave,s={rowIndxPage:l,colIndx:r,incr:!!a,edit:"nextEdit"==a};return this._saveAndMove(s,t)}if(t.keyCode==n.ESCAPE)return e.quitEditMode({evt:t}),e.focus({rowIndxPage:l,colIndx:r}),t.preventDefault(),!1;if(t.keyCode==n.PAGE_UP||t.keyCode==n.PAGE_DOWN)return t.preventDefault(),!1;if(o.keyUpDown&&!t.altKey){if(t.keyCode==n.DOWN){s=this._incrRowIndx2(l,r);return this._saveAndMove(s,t)}if(t.keyCode==n.UP){s=this._decrRowIndx2(l,r);return this._saveAndMove(s,t)}}}},t.select=function(t){var a=this.that,e=this,l=t.rowIndx,s=t.colIndx,d=t.evt,l=(t=this.getMergeCell(l,s)).rowIndx,s=t.colIndx,h=t.rowIndxPage,r=a.options,c=a.iSelection,u=r.selectionModel,t=u.type,p="row"==t,f="cell"==t;(r.realFocus?function(t){clearTimeout(e.timeoutID),e.timeoutID=setTimeout(function(){t()},0)}:function(t){t()})(function(){a.scrollCell({rowIndx:l,colIndx:s});var t,e,r,o,i,n=c.address();d.shiftKey&&d.keyCode!==z.ui.keyCode.TAB&&u.type&&"single"!=u.mode&&n.length?(e=(t=n[n.length-1]).firstR,r=t.firstC,i=!1,"column"==(o=t.type)?(t.c1=r,t.c2=s,t.r1=t.r2=t.type=void 0):"row"==o?(t.r1=e,t.r2=l,t.c1=t.c2=t.type=void 0):(n={r1:e,r2:l,c1:r,c2:s,firstR:e,firstC:r},i=!0),a.range(n,i).select()):p?a.range({r1:l,firstR:l},!1).select():f&&a.range({r1:l,c1:s,firstR:l,firstC:s}).select(),a.focus({rowIndxPage:h,colIndx:s})})},t._bodyKeyPressDown=function(t){var e=this.that,r=e.rowIndxOffset,o=this.options,i=e.iMerge,n=e._focusElement,a=(e.colModel,o.selectionModel),l=o.editModel,s=t.ctrlKey||t.metaKey,d=z.ui.keyCode,h=t.keyCode;if(l.indices)e.$div_focus.find(".pq-cell-focus").focus();else{if(n){var c=document.activeElement;if("pq-grid-cont"!=c.className&&"TD"!=c.nodeName.toUpperCase()&&"pq-grid-excel"!=c.id)return}else{var u=z(t.target);if(!u.hasClass("pq-grid-cell"))return;n=e.getCellIndices({$td:u})}var p,f,g,v,w,m=e.normalize(n),x=m.rowIndxPage,_=m.rowIndx,o=m.colIndx,c=e.pdata,u=m,n=!0;if(null!=_&&null!=o&&null!=m.rowData){if(i.ismergedCell(_,o)&&(x=(m=u=i.getRootCell(_,o,"o")).rowIndxPage,_=m.rowIndx,o=m.colIndx,h!=d.PAGE_UP&&h!=d.PAGE_DOWN&&h!=d.SPACE&&h!=d.HOME&&h!=d.END||(i=i.getData(_,o,"proxy_cell"))&&(c[i=i.rowIndx-r].pq_hidden||(_=(x=i)+r))),0==e._trigger("cellKeyDown",t,u))return!1;h==d.LEFT||h==d.RIGHT||h==d.UP||h==d.DOWN||a.onTab&&h==d.TAB?(p=null,h==d.LEFT||h==d.TAB&&t.shiftKey?p=this._incrIndx(x,o,!1):h==d.RIGHT||h==d.TAB&&!t.shiftKey?p=this._incrIndx(x,o,!0):h==d.UP?p=this._decrRowIndx2(x,o):h==d.DOWN&&(p=this._incrRowIndx2(x,o)),p&&(_=p.rowIndxPage+r,this.select({rowIndx:_,colIndx:p.colIndx,evt:t}))):h==d.PAGE_DOWN||h==d.SPACE||h==d.PAGE_UP?(p=this[h==d.PAGE_UP?"pageUp":"pageDown"](x))&&null!=(x=p.rowIndxPage)&&this.select({rowIndx:_=x+r,colIndx:o,evt:t}):h==d.HOME?(s?_=e.getFirstVisibleRIP()+r:o=e.getFirstVisibleCI(),this.select({rowIndx:_,colIndx:o,evt:t})):h==d.END?(s?_=e.getLastVisibleRIP()+r:o=e.getLastVisibleCI(),this.select({rowIndx:_,colIndx:o,evt:t})):h==d.ENTER?(x=u.rowIndxPage,o=u.colIndx,(g=e.getCell({rowIndxPage:x,colIndx:o}))&&0<g.length&&(v=e.isEditableRow({rowIndx:_=x+r}),w=e.isEditableCell({rowIndx:_,colIndx:o}),v&&w?e.editCell({rowIndxPage:x,colIndx:o}):(f=g.find("button")).length&&z(f[0]).click())):s&&"65"==h?(f=e.iSelection,"row"==a.type&&"single"!=a.mode?f.selectAll({type:"row",all:a.all}):"cell"==a.type&&"single"!=a.mode&&f.selectAll({type:"cell",all:a.all})):l.pressToEdit&&(32<=h&&h<=127||189==h)&&!s?46==h?e.clear():(x=u.rowIndxPage,o=u.colIndx,(g=e.getCell({rowIndxPage:x,colIndx:o}))&&0<g.length&&(v=e.isEditableRow({rowIndx:_=x+r}),w=e.isEditableCell({rowIndx:_,colIndx:o}),v&&w&&e.editCell({rowIndxPage:x,colIndx:o,select:!0})),n=!1):n=!1,n&&t.preventDefault()}}},t.incrPageSize=function(){for(var t=this.that,e=t.$tbl,r=e.children("tbody").children(".pq-grid-row"),e=parseInt(e.css("marginTop")),o=t.iRefresh.getEContHt()-e,i=r.length-1;0<=i;i--){var n=r[i];if(n.offsetTop<o)break}return{rowIndxPage:t.getRowIndx({$tr:z(n)}).rowIndxPage}},t.pageNonVirtual=function(t,e){var r=this.that,o=r.$cont[0].offsetHeight-r._getSBHeight(),i=r.getRow({rowIndxPage:t}),n=0,a=0,l=z(i[0])[e]("tr.pq-grid-row"),s=l.length;if(0<s){do{}while(!(o<=(n+=l[a].offsetHeight))&&++a<s);a=0<a?a-1:a;do{i=z(l[a])}while(null==(t=r.getRowIndx({$tr:i}).rowIndxPage)&&0<=--a)}return t},t.pageDown=function(t){var e=this.that,r=e.options,o=e.vscroll,i=o.option("cur_pos"),n=o.option("num_eles"),a=o.option("ratio");if(r.virtualY){if(i<n-1){var t=this.incrPageSize().rowIndxPage,l=e._calcCurPosFromRowIndxPage(t);if(null==l)return;o.option("cur_pos",l),o.scroll()}}else null!=t?t=this.pageNonVirtual(t,"nextAll"):a<1&&(a=e.iRefresh.getEContHt(),(e=e.iMouseSelection).updateTableY(-1*a),e.syncScrollBarVert());return{rowIndxPage:t,curPos:l}},t.pageUp=function(t){var e=this.that,r=e.options,o=e.vscroll;if(r.virtualY){if(0<o.option("cur_pos")){var t=this.decrPageSize().rowIndxPage,i=e._calcCurPosFromRowIndxPage(t);if(null==i)return;o.option("cur_pos",i),o.scroll()}}else{o=o.option("ratio");null!=t?t=this.pageNonVirtual(t,"prevAll"):0<o&&(o=e.iRefresh.getEContHt(),(e=e.iMouseSelection).updateTableY(o),e.syncScrollBarVert())}return{rowIndxPage:t,curPos:i}},t.decrPageSize=function(){var t,e=this.that,r=e.$tbl.children("tbody").children(".pq-grid-row"),o=e.options.freezeRows,i=e.pdata,n=0;if(r.length&&(o?(t=r.filter("tr.pq-last-frozen-row")).length&&(t=t.next()):2<=r.length&&(t=z(r[1])),t&&t.length))for(var a=n=e.getRowIndx({$tr:t}).rowIndxPage,l=0,s=e.pageSize-3,d=n;0<=d;d--){var h=i[d];if(!h.pq_hidden&&(a=d,s<=++l))break}return{rowIndxPage:a}},e._calcNumHiddenFrozens=function(){for(var t=0,e=this.options.freezeCols,r=0;r<e;r++)this.colModel[r].hidden&&t++;return t},e._calcNumHiddenUnFrozens=function(t){for(var e=0,r=this.options.freezeCols,o=null!=t?t:this.colModel.length,i=r;i<o;i++)this.colModel[i].hidden&&e++;return e},e._getSBHeight=function(){return this.iRefresh.getSBHeight()},e._getSBWidth=function(){return this.iRefresh.getSBWidth()},e.getFirstVisibleRIP=function(t){for(var e=this.pdata,r=t?this.initV:0,o=e.length;r<o;r++)if(!e[r].pq_hidden)return r},e.getLastVisibleRIP=function(){for(var t=this.pdata,e=t.length-1;0<=e;e--)if(!t[e].pq_hidden)return e;return null},e.getFirstVisibleCI=function(t){for(var e=this.colModel,r=e.length,o=t?this.initH:0;o<r;o++)if(!e[o].hidden)return o;return null},e.getLastVisibleCI=function(){for(var t=this.colModel,e=t.length-1;0<=e;e--)if(!t[e].hidden)return e;return null},e.getTotalVisibleColumns=function(){for(var t=this.colModel,e=t.length,r=0,o=0;o<e;o++)t[o].hidden||r++;return r},e._calcCurPosFromRowIndxPage=function(t){var e=this.options,r=this.pdata,e=e.freezeRows;if(t<e)return 0;for(var o=0,i=e,n=e,a=r.length;n<a;n++){var l=r[n];if(i==t)break;i++,l.pq_hidden||o++}return a<=o?null:o},e._calcCurPosFromColIndx=function(t){var e=this.options,r=this.colModel,e=e.freezeCols;if(t<e)return 0;for(var o=0,i=e,n=e,a=r.length;n<a;n++){var l=r[n];if(i==t)break;i++,l.hidden||o++}return a<=o?null:o},e.calcWidthCols=function(t,e,r){var o=0,i=this.options.numberCell,n=this.colModel;if(-1==t&&(i.show&&(o+=r?+i.width:i.outerWidth),t=0),r){for(var a=t;a<e;a++)if((l=n[a])&&!l.hidden){if(!l._width)throw"assert failed";o+=l._width+0}}else for(var l,a=t;a<e;a++)(l=n[a])&&!l.hidden&&(o+=l.outerWidth);return o},e.calcHeightFrozenRows=function(){var t=this.$tbl,e=0;return t&&t.length&&((t=z(t[0]).find("tr.pq-last-frozen-row"))&&t.length&&(e=(t=t[0]).offsetTop+t.offsetHeight)),e},e._calcRightEdgeCol=function(t){var e=0,r=0,o=this.colModel,i=this.initH,n=this.options,a=n.freezeCols,n=n.numberCell;n.show&&(e+=n.outerWidth,r++);for(var l=0;l<=t;l++){var s=o[l=l<i&&a<=l?i:l];s.hidden||(e+=s.outerWidth,r++)}return{width:e,cols:r}},e._createHeader=function(){this.iHeader.createHeader(),this.options.showHeader&&this._trigger("createHeader")},e.createTable=function(t){t.other=!0;var e=this.iGenerateView;e.generateView(t),e.scrollView()}}(jQuery),function(R){var w=R.paramquery,t=w._pqGrid.prototype;function e(t){this.that=t}t.getHeadCell=function(t){var e,r,o,i,n=t.attr("pq-col-indx"),t=t.attr("pq-row-indx");return null!=n&&null!=t&&(r=this.headerCells[t=+t][n=+n])&&(i=r.colModel,o=r.leftPos),{col:r,ci:n,o_ci:o,ri:t,isParent:e=i&&i.length?!0:e}},t.flex=function(t){this.iResizeColumns.flex(t)};t=(w.cHeader=e).prototype;function m(t,e,r){for(var o=0,i=e;i<r;i++)!0!==t[i].hidden&&o++;return o}t.createHeader=function(){var t=this.that,e=this,r=t.options,o=r.bootstrap,i=(o.on?o.thead:"")+" pq-grid-header-table ",n=r.ui,a=o.on?"":n.header,l=r.hwrap,s=t.pqpanes,d=parseInt(r.freezeCols),h=r.numberCell,o=t.colModel,c=r.sortModel,u=t.depth,p=r.virtualX,f=t.iGenerateView.colDef,g=t.initH,v=t.finalH,w=t.headerCells,n=t.$header_o;if(n.empty(),null!=v)if(!1!==r.showHeader){n.css("display","");var m=["<table class='"+(i+=l?"pq-wrap ":"pq-no-wrap ")+"' >"];if(1<=u){m.push("<tr class='pq-row-hidden'>"),h.show&&m.push("<td style='width:"+h.width+"px;' ></td>");for(var x=0,_=f.length;x<_;x++){var I=f[x],y=I.colIndx,I=I.column.outerWidth;m.push("<td style='width:"+I+"px;' pq-col-indx="+y+"></td>")}m.push("</tr>")}for(var b="pq-grid-col ",C=0;C<u;C++){m.push("<tr class='pq-grid-title-row'>"),0==C&&h.show&&m.push(["<th pq-col-indx='-1' class='pq-grid-number-col' rowspan='",u,"'>","<div class='pq-td-div'>",h.title||"&nbsp;","</div></th>"].join(""));for(y=0;y<=v;y++){if(y<g&&d<=y&&p&&v<(y=g))throw"initH>finalH";e.createHeaderCell(C,y,w,m,b,d,g,u,c)}m.push("</tr>")}t.ovCreateHeader(m,b),m.push("</table>");i=m.join("");s.vH?n[0].innerHTML=["<span class='pq-grid-header pq-grid-header-left ",a,"'>","<div class='pq-grid-header-inner'>",i,"</div>","</span>","<span class='pq-grid-header ",a,"'>","<div class='pq-grid-header-inner'>",i,"</div>","</span>"].join(""):n[0].innerHTML=["<span class='pq-grid-header ",a,"'>","<div class='pq-grid-header-inner'>",i,"</div>","</span>"].join("");a=t.$header=n.children(".pq-grid-header"),i=a.children(".pq-grid-header-inner");t.$tbl_header=i.children("table"),t.$header_left=R(a[0]),t.$header_left_inner=R(i[0]),s.vH&&(t.$header_right=R(a[1]),t.$header_right_inner=R(i[1])),a.click(function(t){return e._onHeaderClick(t)}),e._refreshResizeColumn(g,v,o),t._trigger("refreshHeader",null,null)}else n.css("display","none")},t._onHeaderClick=function(t){var e,r,o=this.that,i=o.iDragColumns;if(!i||"stop"==i.status){var i=R(t.target);return i.is("input,label")?!0:(i=i.closest(".pq-grid-col")).length&&(e=(r=o.getHeadCell(i)).col)&&!r.isParent?this._onHeaderCellClick(e,r.ci,t):void 0}},t.createHeaderCell=function(t,e,r,o,i,n,a,l,s){var d=this.that,h=d.options.sheet,c=r[t][e],u=d.colModel,p=c.colSpan;if(!(c.hidden||0===p||0<t&&c==r[t-1][e])){if(0<e&&c==r[t][e-1]){if(a<e)return;var f=function(t,e,r){for(var o=t[e],i=0;i<o.length;i++)if(o[i]==r)return i}(r,t,c);if(f<n)return;p-=m(u,f,e)}else n&&e<n&&n<e+p&&(g=p-m(u,n,a),v=m(u,e,n),p=Math.max(g,v));var f=c.halign||c.align,u=c.cls,g=[i],v=c.title,i=c.type,v="function"==typeof v?v.call(d,{column:c,colIndx:e,dataIndx:c.dataIndx}):v,v=null!=(v=h?w.toLetter(e):v)?v:"checkbox"==i&&c.cb.header?"<input type='checkbox'/>":c.dataIndx;c.pqtitle=v,f&&g.push("pq-align-"+f),e==n-1&&1==l&&g.push("pq-last-frozen-col"),e<=n-1?g.push("pq-left-col"):a<=e&&g.push("pq-right-col"),u&&g.push(u);null!=c.colModel&&0!=c.colModel.length||g.push("pq-grid-col-leaf");u="pq-row-indx="+t,t="pq-col-indx="+e,e=s.space?"pq-space":"";o.push(["<th ",""," ",t," ",u," "," class='",g.join(" "),"' rowspan=",c.rowSpan," colspan=",p,">","<div class='pq-td-div'>",v,"<span class='pq-col-sort-icon ",e,"'></span>",s.number?"<span class='pq-col-sort-count "+e+"'></span>":"","</div></th>"].join(""))}},t._onHeaderCellClick=function(t,e,r){var o=this.that,i=o.options,n=i.sortModel,a=t.dataIndx;if(!1!==o._trigger("headerCellClick",r,{column:t,colIndx:e,dataIndx:a})){if(i.selectionModel.column&&-1==r.target.className.indexOf("pq-td-div")){var l={c1:e,firstC:e},s=o.iSelection.address();return r.shiftKey&&((i=s.length)&&"column"==s[i-1].type&&((i=s[i-1]).c1=i.firstC,i.c2=e,i.r1=i.r2=i.type=void 0),l=s),o.range(l,!1).select(),void o.focus({rowIndxPage:o.getFirstVisibleRIP(!0),colIndx:e})}n.on&&0!=t.sortable&&o.sort({sorter:[{dataIndx:a}],addon:!0,tempMultiple:n.multiKey&&r[n.multiKey],evt:r})}},t._refreshResizeColumn=function(t,e,r){var o=this.that,i=o.options,n=!!i.filterModel.ficon,a=i.numberCell,l=parseInt(i.freezeCols),s=[],d=[],h=o.pqpanes.vH,c=0;a.show&&(c=a.outerWidth,a.resizable&&s.push("<div pq-col-indx='-1' style='left:",c-5,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>"));for(var u=o.iGenerateView.colDef,p=0,f=u.length;p<f;p++){var g=u[p],v=g.colIndx,w=g.column,m=w.ficon,g=s;c+=w.outerWidth,!1===w.resizable&&!(m||null==m&&n)||(g=h&&l<=v?d:g).push("<div pq-col-indx='",v,"' style='left:",c-5,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>")}d.length&&o.$header_right_inner.append(d.join("")),o.$header_left_inner.append(s.join(""))},t.refreshHeaderSortIcons=function(){var t=this.that,e=t.options,r=e.bootstrap,o=(e.ui,t.$header);if(o){var i=t.iSort.getSorter(),n=i.length,a=!1;t.options.sortModel.number&&1<n&&(a=!0);for(var l=0;l<n;l++){var s=i[l],d=s.dataIndx,h=t.getColIndx({dataIndx:d}),d=s.dir,s=" pq-col-sort-"+("up"==d?"asc":"desc"),d=r.on?" glyphicon glyphicon-arrow-"+d:"ui-icon ui-icon-triangle-1-"+("up"==d?"n":"s"),h=o.find(".pq-grid-col-leaf[pq-col-indx="+h+"]");h.addClass(s),h.find(".pq-col-sort-icon").addClass(d),a&&h.find(".pq-col-sort-count").html(l+1)}}};t=function(t){this.that=t;var r=this;t.$header_o.on({mousedown:function(t){var e;t.pq_composed||(e=R(t.target),r.setDraggables(t),t.pq_composed=!0,t=R.Event("mousedown",t),e.trigger(t))},dblclick:function(t){r.doubleClick(t)}},".pq-grid-col-resize-handle");var e=t.options.flex;e.on&&e.one&&t.one("ready",function(){r.flex()})},t=(w.cResizeColumns=t).prototype=new w.cClass;t.doubleClick=function(t){var e=this.that.options,r=e.flex,t=R(t.target),t=parseInt(t.attr("pq-col-indx"));isNaN(t)||r.on&&this.flex(r.all&&!e.scrollModel.autoFit?{}:{colIndx:[t]})},t._initFlexTable=function(t,e){var o,i,n,a,l,s;return t.length&&(t=t.css({tableLayout:"auto",width:""}).addClass("pq-no-wrap").removeClass("pq-wrap").children("tbody").children(".pq-row-hidden"),i=t.children("td").css("width",""),e&&(t=t.next().children("td"),n=0,a=[],s=[],t.each(function(t,e){if(1<(l=+e.getAttribute("colspan"))&&(a[n+=l-1]=e.offsetWidth,!(o=i[n])||!o.offsetWidth))for(var r=n-(l-1);r<n;r++)s[r]=!0;n++}))),[i||R(),s||[],a]},t.flex=function(t){var e,r=this.that,o=r.options,i=r.element,n=o.numberCell,a=(t=t||{}).colIndx,l=t.dataIndx,s=null==t.refresh||t.refresh,d=!1,h=r.$tbl,c=r.$tbl_header,o=h&&h.length?R(h[0]).clone():R(),t=(t=r.tables&&r.tables.length?r.tables[0].$tbl:null)?R(t[0]).clone():R(),h=c&&c.length?R(c[0]).clone():R();if(o.find(".pq-merge-cell").each(function(t,e){e.innerHTML=R(e).find(".pq-merge-inner")[0].innerHTML,e.style.whiteSpace="noWrap"}),null!=l)for(var a=[],u=0,p=l.length;u<p;u++){var f=r.colIndxs[l[u]];null!=f&&a.push(f)}null!=a&&(a.sort(function(t,e){return t-e}),e=a.length),h.find("tr.pq-grid-header-search-row").remove();c=R("<div class='pq-grid'>").append(h).append(t).append(o);c.addClass(i.attr("class")),i.parent().append(c);for(var o=this._initFlexTable(o,!0),g=o[0],v=o[1],w=o[2],m=0,x=this._initFlexTable(t)[0],_=this._initFlexTable(h)[0],I=n.show?0:-1,y=r.iGenerateView.colDef,u=0,p=y.length;u<p;u++){var b=y[u],C=b.colIndx,q=b.column;if(I++,a){if(!a.length)break;if(a[0]!==C)continue;a.splice(0,1)}var M=g[I],D=_[I],b=x[I],C=v[I],M=M?M.offsetWidth:0,b=b?b.offsetWidth:0,D=D?D.offsetWidth:0;C?M=0:m&&(M=w[I]-m,m=0);D=+Math.max(M,b,D)+1;C&&(m+=D),q._width!==D&&(d=!0,q.width=D,1===e&&(q._resized=!0))}c.remove(),d&&s&&r.refresh({source:"flex",colModel:!0})},t.setDraggables=function(t){var r,o,t=R(t.target),i=(this.that,this);t.draggable({axis:"x",helper:function(t,e){var r=R(t.target),o=parseInt(r.attr("pq-col-indx"));return i._setDragLimits(o),i._getDragHelper(t,e),r},start:function(t,e){r=e.position.left,o=parseInt(i.$cl[0].style.left)},drag:function(t,e){e=e.position.left-r;i.$cl[0].style.left=o+e+"px"},stop:function(t,e){return i.resizeStop(t,e,r)}})},t._getDragHelper=function(t){var e=this.that,r=e.options,o=parseInt(r.freezeCols),i=R(t.target),r=e.$grid_center,t=parseInt(i.attr("pq-col-indx")),i=r.outerHeight();this.$cl=R("<div class='pq-grid-drag-bar'></div>").appendTo(r),this.$clleft=R("<div class='pq-grid-drag-bar'></div>").appendTo(r),this.$cl.height(i),this.$clleft.height(i);r=R("[pq-col-indx="+t+"]",e.$header)[0],i=r.offsetLeft;e.pqpanes.vH?o<=t&&(i-=e.$header[1].scrollLeft):(i+=e.$header[0].offsetLeft,i-=e.$header[0].scrollLeft),this.$clleft.css({left:i}),i+=r.offsetWidth,this.$cl.css({left:i})},t._setDragLimits=function(t){var e,r,o,i;t<0||(i=(o=this.that).colModel[t],(e=o.options).numberCell,r=o.$header_left,i=(o=(r=t>=e.freezeCols&&o.pqpanes.vH?o.$header_right:r).find("th[pq-col-indx='"+t+"']").offset().left+i._minWidth)+i._maxWidth-i._minWidth,r.find("div.pq-grid-col-resize-handle[pq-col-indx="+t+"]").draggable("option","containment",[o,0,i,0]))},t.resizeStop=function(t,e,r){var o=this.that,i=o.colModel,n=o.options.numberCell;this.$clleft.remove(),this.$cl.remove();var a,l,s,r=e.position.left-r,e=R(e.helper),e=parseInt(e.attr("pq-col-indx"));-1==e?(a=null,s=(l=parseInt(n.width))+r,n.width=s):(a=i[e],s=(l=parseInt(a.width))+r,a.width=s,a._resized=!0),o.refresh(),o._trigger("columnResize",t,{colIndx:e,column:a,dataIndx:a?a.dataIndx:null,oldWidth:l,newWidth:(a||n).width})};t=function(t){var e=this;e.that=t,e.$drag_helper=null;var r=t.options.dragColumns,o=r.topIcon,i=r.bottomIcon;e.status="stop",e.$arrowTop=R("<div class='pq-arrow-down ui-icon "+o+"'></div>").appendTo(t.element),e.$arrowBottom=R("<div class='pq-arrow-up ui-icon "+i+"' ></div>").appendTo(t.element),e.hideArrows(),r&&r.enabled&&t.$header_o.on("mousedown",".pq-grid-col",e.onColMouseDown(e,t))},t=(w.cDragColumns=t).prototype;function d(t,e,r){for(;r&&t[r][e]==t[r-1][e];)r--;return r}t.onColMouseDown=function(i,n){return function(t){var e,r,o=R(this);t.pq_composed||R(t.target).is("input,select,textarea")||(o=(e=(r=n.getHeadCell(o)).col)?e.parent:null,!e||e.nodrag||e._nodrag||o&&1==o.colSpan||i.setDraggable(t,e,r)&&(t.pq_composed=!0,r=R.Event("mousedown",t),R(t.target).trigger(r)))}},t.showFeedback=function(t,e){var r=this.that,o=t[0],i=o.offsetParent.offsetParent,t=r.$grid_center[0].offsetTop,e=o.offsetLeft-i.offsetParent.scrollLeft+(e?0:o.offsetWidth)-8,o=t+o.offsetTop-16,r=t+r.$header[0].offsetHeight;this.$arrowTop.css({left:e,top:o,display:""}),this.$arrowBottom.css({left:e,top:r,display:""})},t.showArrows=function(){this.$arrowTop.show(),this.$arrowBottom.show()},t.hideArrows=function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},t.updateDragHelper=function(t){var e=this.that.options.dragColumns,r=e.acceptIcon,o=e.rejectIcon,e=this.$drag_helper;e&&(t?(e.children("span.pq-drag-icon").addClass(r).removeClass(o),e.removeClass("ui-state-error")):(e.children("span.pq-drag-icon").removeClass(r).addClass(o),e.addClass("ui-state-error")))},t.setDraggable=function(t,e,r){var t=R(t.currentTarget),o=this,i=o.that;if(!t.hasClass("ui-draggable"))return t.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:i.element,revert:"invalid",helper:o.dragHelper(o,i,e),start:o.onStart(o,i,e,r),drag:o.onDrag(o,i),stop:function(){i.element&&(o.status="stop",i.$header.find(".pq-grid-col-resize-handle").show(),o.hideArrows())}}),!0},t.onStart=function(e,r,o,i){return function(t){if(!1===r._trigger("columnDrag",t.originalEvent,{column:o}))return!1;e.setDroppables(i)}},t.onDrag=function(i,n){return function(t,e){i.status="drag";var r,o=R(".pq-drop-hover",n.$header);0<o.length?(i.showArrows(),i.updateDragHelper(!0),r=o.width(),t.clientX-o.offset().left+R(document).scrollLeft()<r/2?(i.leftDrop=!0,i.showFeedback(o,!0)):(i.leftDrop=!1,i.showFeedback(o,!1))):(i.hideArrows(),R(".pq-drop-hover",n.$top).length?i.updateDragHelper(!0):i.updateDragHelper())}},t.dragHelper=function(e,r,o){var i=r.options.dragColumns.rejectIcon;return function(){e.status="helper",r.$header.find(".pq-grid-col-resize-handle").hide();var t=R("<div class='pq-col-drag-helper ui-widget-content ui-corner-all panel panel-default' ><span class='pq-drag-icon ui-icon "+i+" glyphicon glyphicon-remove'></span>"+o.pqtitle+"</div>");return(e.$drag_helper=t)[0]}},t._columnIndexOf=function(t,e){for(var r=0,o=t.length;r<o;r++)if(t[r]==e)return r;return-1},t.setDroppables=function(t){for(var e,r,o,i,n,a=this.that,l=t.col,s=t.ri,d=t.o_ci,h=d+l.o_colspan,t=a.$header_left,c={hoverClass:"pq-drop-hover ui-state-highlight",accept:".pq-grid-col",tolerance:"pointer",drop:this.onDrop()},u=t.find(".pq-left-col"),t=(a.pqpanes.v||a.pqpanes.vH?a.$header_right:t).find(".pq-right-col"),p=(u=u.add(t)).length;p--;)n=(i=R(u[p])).hasClass("ui-droppable"),o=(r=a.getHeadCell(i)).col,e=r.ri,r=r.ci,o==l||o.nodrop||o._nodrop||s<e&&d<=r&&r<h?n&&i.droppable("destroy"):n||i.droppable(c)},t.onDrop=function(){var l=this,s=this.that;return function(t,e){var r,o,i,n,a;l.dropPending||(r=+e.draggable.attr("pq-col-indx"),o=+e.draggable.attr("pq-row-indx"),i=+(n=R(this)).attr("pq-col-indx"),e=+n.attr("pq-row-indx"),n=l.leftDrop,a=l.moveColumn(r,i,n,o,e),l.dropPending=!0,window.setTimeout(function(){s.iColModel.init(),!1!==s._trigger("columnOrder",null,{dataIndx:a.dataIndx,column:a,oldcolIndx:r,colIndx:s.getColIndx({column:a})})&&s.refresh(),l.dropPending=!1},0))}},t.moveColumn=function(t,e,r,o,i){var n=this.that,a=n.options.colModel,l=n.headerCells,s=n.depth-1,o=null==o?d(l,t,s):o,i=null==i?d(l,e,s):i,n=l[o][t],s=l[i][e],t=o?l[o-1][t].colModel:a,a=i?l[i-1][e].colModel:a,n=this._columnIndexOf(t,n),r=r?1:0,n=t.splice(n,1)[0],r=this._columnIndexOf(a,s)+1-r;return a.splice(r,0,n),n}}(jQuery),function(f){function t(t,e){this.that=t;var r=this,o=t.options;this.type="detail",this.refreshComplete=!0,this.detachView=!1,t.on("cellClick",function(t,e){return r.toggle(t,e)}).on("cellKeyDown",function(t,e){if(t.keyCode==f.ui.keyCode.ENTER)return r.toggle(t,e)}).on("refresh",function(t,e){return r.aftertable()}).on("beforeTableView",function(t,e){return r.beforeTableView(t,e)}).on("tableWidthChange",function(t,e){return r.tableWidthChange(t,e)}),e._render=function(t){var e=o.detailModel,r=t.cellData,t=t.rowData;if(!t.pq_gsummary&&!t.pq_gtitle)return"<div class='ui-icon "+(r&&r.show?e.expandIcon:e.collapseIcon)+"'></div>"}}var e=(f.paramquery.cHierarchy=t).prototype=new f.paramquery.cClass;e.tableWidthChange=function(){if(this.refreshComplete){this.refreshComplete=!1;for(var t=this.that.$tbl.children("tbody").children("tr.pq-detail-child").children("td.pq-detail-child"),e=0,r=t.length;e<r;e++)for(var o=t[e],i=f(o).find(".pq-grid"),n=0,a=i.length;n<a;n++){var l=f(i[n]);l.is(":visible")&&l.pqGrid("onWindowResize")}this.refreshComplete=!0}},e.aftertable=function(t){var e=this.that,r=e.options.detailModel.init,o=e.pdata;if(this.refreshComplete){this.refreshComplete=!1;for(var i=0,n=(t=t||e.$tbl.children("tbody").children("tr.pq-detail-child")).length;i<n;i++){var a=t[i],l=f(a),s=o[l.attr("pq-row-indx")],d=!1,a=s.pq_detail.child;a||"function"==typeof r&&(d=!0,a=r.call(e.element[0],{rowData:s}),s.pq_detail.child=a,s.pq_detail.height=25);l=l.children("td.pq-detail-child");l.append(a);for(var h=l.find(".pq-grid"),c=0,u=h.length;c<u;c++){var p=f(h[c]);d?p.hasClass("pq-pending-refresh")&&p.is(":visible")&&(p.removeClass("pq-pending-refresh"),p.pqGrid("refresh")):p.is(":visible")&&p.pqGrid("onWindowResize")}}this.refreshComplete=!0,this.detachView=!1}},e.beforeTableView=function(t,e){this.detachView||(this.detachInitView(),this.detachView=!0)},e.detachInitView=function(t){var e=this.that.$tbl;if(e&&e.length){t=t||e.children("tbody").children("tr.pq-detail-child");for(var r=0;r<t.length;r++){var o=t[r];f(o).children("td.pq-detail-child").children().detach()}}},e.toggle=function(t,e){var r=this.that,o=e.column,i=e.rowData,n=e.rowIndx,e=this.type;i.pq_gtitle||i.pq_gsummary||o&&o.type===e&&(e={rowIndx:n,focus:!0},null==i[n="pq_detail"]||!1===i[n].show?r.rowExpand(e):this.rowCollapse(e))},e.rowExpand=function(t){this.normalize(t);var e=this.that,r=e.options,o=t.rowData,i=t.rowIndx,n=t.rowIndxPage,a=r.detailModel,r="pq_detail";if(null!=o){if(!1===e._trigger("beforeRowExpand",null,t))return!1;null==o[r]?o[r]={show:!0}:!1===o[r].show&&(o[r].show=!0),a.cache||this.rowInvalidate(t),e.refreshRow({rowIndx:i});a=[];e.iGenerateView._generateDetailRow(o,n,a);n=e.getRow({rowIndxPage:n});n.after(a.join("")),this.aftertable(n.next()),t.focus&&e.getCell({rowIndx:i,dataIndx:r}).attr("tabindex","0").focus(),t.scrollRow&&this.scrollRow({rowIndx:i})}},e.rowInvalidate=function(t){var e=this.that.getRowData(t),r="pq_detail",t=e[r],t=t?t.child:null;t&&(t.remove(),e[r].child=null,e[r].height=0)},e.normalize=function(t){var e=this.that,r=t.rowIndx,o=t.rowIndxPage,i=e.rowIndxOffset;t.rowIndx=null==r?o+i:r,t.rowIndxPage=null==o?r-i:o,t.rowData=e.getRowData(t)},e.rowCollapse=function(t){this.normalize(t);var e=this.that,r=e.options,o=t.rowData,i=t.rowIndx,n=t.rowIndxPage,a=r.detailModel,l="pq_detail";null==o||null==o[l]||!0===o[l].show&&(a.cache||this.rowInvalidate(t),o[l].show=!1,r.virtualY?e.refresh():((n=e.getRow({rowIndxPage:n}).next("tr.pq-detail-child")).length&&(this.detachInitView(n),n.remove(),e.refreshRow({rowIndx:i})),t.focus&&e.getCell({rowIndx:i,dataIndx:l}).attr("tabindex","0").focus()),t.scrollRow&&(i=t.rowIndx,this.scrollRow({rowIndx:i})))}}(jQuery),function(v){var t=function(t){var e=this;(e.that=t).on("dataReadyDone",function(){e.calcVisibleV()}).on("CMInit",function(){e.calcVisibleH()}).on("refresh",function(){e.summaryTable()})},t=(v.paramquery.cRefresh=t).prototype;t._computeOuterWidths=function(){for(var t=this.that,e=t.options.numberCell,r=t.colModel,o=r.length,i=0;i<o;i++){var n=r[i];n.outerWidth=n._width+0}e.show&&(e.outerWidth=e.width)},t.autoFit=function(){var t=this.that,e=t.colModel,r=e.length,o=t.calcWidthCols(-1,r,!0),t=this.contWd-this.getSBWidth();if(o!==t){for(var i,n=o-t,a=[],l=0;l<r;l++){var s=(c=e[l])._percent,d=(c.resizable,c._resized);c.hidden||s||d||(n<0?(f=c._maxWidth-c._width)&&a.push({availWd:-1*f,colIndx:l}):(f=c._width-c._minWidth)&&a.push({availWd:f,colIndx:l})),d&&delete(i=c)._resized}a.sort(function(t,e){return t.availWd>e.availWd?1:t.availWd<e.availWd?-1:0});for(var l=0,h=a.length;l<h;l++){var c,u,p=a[l],f=p.availWd,g=p.colIndx,p=Math.round(n/(h-l)),g=(c=e[g])._width;Math.abs(f)>Math.abs(p)?(u=g-p,n-=p):(u=g-f,n-=f),c.width=c._width=u}0!=n&&i&&((u=i._width-n)>i._maxWidth?u=i._maxWidth:u<i._minWidth&&(u=i._minWidth),i.width=i._width=u)}},t.autoLastColumn=function(){var t=this.that,e=t.options,r=t.colModel,o=r.length,i=e.freezeCols,n=this.contWd-this.getSBWidth()-t.calcWidthCols(-1,i,!0),a=!1,e=t.getLastVisibleCI();if(null!=e){t=r[e];if(!t._percent){for(var l,s=t._width,d=t._minWidth,e=t._maxWidth,h=o-1;i<=h;h--){var c=r[h];if(!c.hidden){c=c._width+0;if((n-=c)<0){a=!0,l=d<=s+n?s+n:s+c+n;break}}}e<(l=!a?s+n:l)?l=e:l<d&&(l=d),t.width=t._width=l}}},t.numericVal=function(t,e){t=-1<(t+"").indexOf("%")?parseInt(t)*e/100:parseInt(t);return Math.round(t)},t.refreshColumnWidths=function(t){t=t||{};var e=this.that,r=e.options,o=r.numberCell,i="flex"===r.width,n=e.colModel,a=r.scrollModel,l=a.lastColumn,s=a.autoFit,d=this.contWd,h=n.length,c=this.getSBWidth(),u=r._minColWidth,p=r._maxColWidth,a=0;o.show&&(o.width<o.minWidth&&(o.width=o.minWidth),a=o.outerWidth=o.width);var f=i?null:d-c-a,u=Math.floor(this.numericVal(u,f)),p=Math.ceil(this.numericVal(p,f)),g=0;if(!i&&f<5||isNaN(f)){if(r.debug)throw"availWidth N/A"}else{delete e.percentColumn;for(var v=0;v<h;v++){var w,m,x,_,I,y,b=n[v];b.hidden||(m=-1<((w=b.width)+"").indexOf("%")||null,x=b.minWidth,_=b.maxWidth,x=x?this.numericVal(x,f):u,(_=_?this.numericVal(_,f):p)<x&&(_=x),null!=w?(y=0,!i&&m?(e.percentColumn=!0,b.resizable=!1,b._percent=!0,1<=(g+=(I=+this.numericVal(w,f))-(y=Math.floor(I)))&&(y+=1,--g)):w&&(y=parseInt(w)),y<x?y=x:!i&&_<y&&(y=_),b._width=y):b._width=x,m||(b.width=b._width),b._minWidth=x,b._maxWidth=i?1e3:_)}!1==i&&!1!==t.refreshWidth&&(s&&this.autoFit(),"auto"===l&&r.virtualX&&this.autoLastColumn()),this._computeOuterWidths()}},t.estRowsInViewPort=function(){var t=Math.ceil(this.contHt/this.rowHt);return this.that.pageSize=t},t._refreshFrozenLine=function(){var t=this.that,e=t.options,r=e.numberCell,o=t.$cont_o,i=e.freezeBorders,n=e.freezeCols,e=e.freezeRows;this.$freezeLine&&this.$freezeLine.remove(),this.$freezeLineH&&this.$freezeLineH.remove(),i&&(n&&(n=t.calcWidthCols(-1,n),isNaN(n)||0===n||0<n&&r.show&&n===r.width||(this.$freezeLine=v(["<div class='pqg-vert-frozen-line' "," style = 'left:",n-1,"px;' >","</div>"].join("")).appendTo(o))),e&&(!(t=t.$tbl)||(t=t.children("tbody").children(".pq-last-frozen-row")[0])&&(t=t.offsetTop+t.offsetHeight-1,this.$freezeLineH=v("<div class='pqg-horiz-frozen-line' style='top:"+(t-1)+"px;' ></div>").appendTo(o))))},t.setScrollVNumEles=function(t){t=t||{};var e=this.that,r=e.vscroll,o=e.options;if(!o.maxHeight&&"flex"===o.height)return r.option("num_eles",0),0;var i,n=!!e.iHierarchy,a=parseInt(r.option("num_eles")),l=parseInt(r.option("cur_pos")),s=this.getEContHt(),t=e.pdata?e.totalVisibleRows:0,o=0;if(e.$tbl&&0<e.$tbl.length&&(o=(i=e.$tbl[e.$tbl.length-1]).scrollHeight,i=v(i)),0<o){for(var d=i.children().children("tr"),h=0,c=0,u=1;u<d.length;u++){var p=d[u];if(s<=(h+=p.offsetHeight)){n&&v(p).hasClass("pq-detail-child")&&(c=1<c?c-1:1);break}n&&!1!==v(p).hasClass("pq-detail-child")||c++}a=t-c+1}else a=l+1;return t<a&&(a=t),s<h&&n&&a++,r.option("num_eles",a),a},t._setScrollVLength=function(t){t=t||{};var e=this.that,r=e.options;"flex"===r.height&&!r.maxHeight||(t=this.getSBHeight(),r=this.contHt-t+this.headerHt-2,e.vscroll.widget().css("bottom",t),e.vscroll.option("length",r))},t.setHeaderHeight=function(){var t,e,r,o,i=this.that,n=i.$header,a="scrollHeight",l=".pq-grid-header-search-row";n&&n.length?(1<n.length?(e=n[0][a],r=n[1][a],o=Math.max(e,r),e!==r&&(t=v(n[0]).find(l),l=v(n[1]).find(l),t.length&&(t.css("height",""),l.css("height",""),e=n[0][a],r=n[1][a],e<(o=Math.max(e,r))?t.height(l[0][a]):l.height(t[0][a])))):o=e=n[0][a],i.$header_o.height(o-3),this.headerHt=o-1):(i.$header_o.height(0),this.headerHt=0)},t.initContHeight=function(){var t=this.that,e=t.options;"flex"==e.height&&!e.maxHeight||(this.contHt=this.height-(e.showHeader?this.rowHt:0)-(e.showTop?t.$top[0].offsetHeight:0)-(e.showBottom?t.$bottom[0].offsetHeight:0))},t.initContWidth=function(){this.that.options;this.contWd=this.width},t.setContHeight=function(t){t=t||{};var e=this.that,r=e.$top,t=e.options,o=0<=(o=this.height-e.$header_o[0].offsetHeight-(t.showTop?r[0].offsetHeight+parseInt((r=r[0],o="marginTop",window.getComputedStyle?getComputedStyle(r)[o]:"auto"==(o=r.currentStyle[o])?0:o)):0)-e.$bottom[0].offsetHeight+1)?o:"";e.$cont.height(o),this.contHt=o},t.setContAndGridHeightForFlex=function(){var t,e,r=this.that,o=r.hscroll.widget();this.vscroll?o.css("position",""):(o.css("position","relative"),t=r.$cont,e=r.options.cls,o=t.children("."+e.cont_inner_b),t.height(""),(o=!o.length?t.children("."+e.cont_inner):o).height(""),r.element.height(""),r.$grid_center.height(""))},t.setContAndGridWidthForFlex=function(){var t=this.that,e=t.options.maxWidth,r=this.maxWidthPixel,o=t.calcWidthCols(-1,t.colModel.length),t=t.element,o=o+this.getSBWidth();this.contWd=o=e&&r<=o?r:o,t.width(o+"px")},t.getTotalVisibleRows=function(t,e,r){var o=this.that,i=this.vrows,n=this.estRowsInViewPort(),a=0,l=r?r.length:0,s=e,d=0,h=0,c=null,u=!!o.iHierarchy,p=o.options.detailModel.offset,f=0,g=this.rowHt,v=u?this.contHt:void 0;if(null==r||0==l)return{initV:null,finalV:null,tvRows:a,lastFrozenRow:null};for(var w=0,m=e<l?e:l;w<m;w++)(_=(x=r[w]).pq_hidden)||(c=w,a++,u&&((I=x.pq_detail)&&I.show?f+=(y=p<(y=I.height||0)?p:y)+g:f+=g));if(l<e)return{initV:c,finalV:c,tvRows:a,lastFrozenRow:c};n-=a;for(var x,_,I,y,h=0,w=s=d=i[t],m=l;w<m;w++){if(_=(x=r[w]).pq_hidden)d++;else{if(h===n)break;d++,h++}if(u&&!_)if((I=x.pq_detail)&&I.show?f+=(y=p<(y=I.height||0)?p:y)+g:f+=g,v<f)break}return{initV:s=l<=s?l-1:s,finalV:d=(d=l<=d?l-1:d)<s?s:d,tvRows:a+=i.length,lastFrozenRow:c}},t.setInitH=function(t,e){var r=this.that;r.initH=t,r.finalH=e},t.setInitV=function(t,e){var r,o=this.that;null!=t&&null!=e||(r=this.vrows)&&r.length&&(t=e=r[r.length-1]),o.initV=t,o.finalV=e},t.calcVisibleV=function(){for(var t=this.that,e=t.options.freezeRows,r=t.pdata||[],o=r.length,i=[],n=0,a=0;a<e;a++)r[a].pq_hidden||(i[n++]=a);for(this.vfrows=i,n=0,i=[],a=e;a<o;a++)r[a].pq_hidden||(i[n++]=a);this.vrows=i},t.calcVisibleH=function(){for(var t=this.that,e=t.options.freezeCols,r=[],o=0,i=t.colModel,n=e,a=i.length;n<a;n++)i[n].hidden||(r[o++]=n);this.vcols=r},t.calcInitFinal=function(){var t,e,r=this.that,o=r.options,i=o.virtualY,n=o.freezeRows,a="flex"===o.height,l=r.pdata;if(null==l||0===l.length){var s=this.getTotalVisibleRows(d,n,l);r.totalVisibleRows=s.tvRows,t=s.initV,e=s.finalV,r.lastFrozenRow=s.lastFrozenRow}else if(i){var d=parseInt(r.vscroll.option("cur_pos"));if(isNaN(d)||d<0)throw"cur_pos NA";r.scrollCurPos=d;s=this.getTotalVisibleRows(d,n,l);r.totalVisibleRows=s.tvRows,t=s.initV,r.lastFrozenRow=s.lastFrozenRow,e=a&&!o.maxHeight?l.length-1:s.finalV}else{var s=this.getTotalVisibleRows(0,n,l);r.lastFrozenRow=s.lastFrozenRow,r.totalVisibleRows=s.tvRows,t=0,e=l.length-1}this.setInitV(t,e)},t.calcInitFinalH=function(){var t,e=this.that,r=e.options,o=r.virtualX,i=e.colModel,n=i.length;if(o){var a=parseInt(e.hscroll.option("cur_pos")),l=parseInt(r.freezeCols),s="flex"===r.width,o=this.vcols;if(o||(this.calcVisibleH(),o=this.vcols),((a=n-1<(a=o[a=a>=o.length?o.length-1:a])?n-1:a)<0||null==a)&&(a=0),s&&!r.maxWidth)t=n-1;else{for(var d=e.calcWidthCols(-1,l),h=this.getEContWd(),c=a;c<n;c++){var u=i[c];if(!u.hidden){u=u.outerWidth;if(!u&&r.debug)throw"outerwidth N/A";if(h<(d+=u))break}}(t=n-1<(t=c)?n-1:t)<l-1&&(t=l-1)}}else a=0,t=n-1;this.setInitH(a,t)},t._calcOffset=function(t){t=/(-|\+)([0-9]+)/.exec(t);return t&&3===t.length?parseInt(t[1]+t[2]):0},t.setMax=function(t){var e=this.that,r=e.element,e=e.options[t];e?(e==parseInt(e)&&(e+="px"),r.css(t,e)):r.css(t,"")},t.refreshGridWidthAndHeight=function(){var t,e,r=this.that,o=r.options,i=-1<(o.width+"").indexOf("%"),n=-1<(o.height+"").indexOf("%"),a=-1<(o.maxHeight+"").indexOf("%"),l="flex"==o.height,s=a&&l,d=-1<(o.maxWidth+"").indexOf("%"),h="flex"==o.width,c=d&&h,u=r.element;if(i||n||s||c){var p,f=u.parent();if(!f.length)return;var g=f[0]==document.body||"fixed"==u.css("position")?(p=v(window).width(),window.innerHeight||v(window).height()):(p=f.width(),f.height()),r=this._calcOffset,f=i?r(o.width):0,r=n?r(o.height):0;c?t=parseInt(o.maxWidth)*p/100:i&&(t=parseInt(o.width)*p/100+f),s?e=parseInt(o.maxHeight)*g/100:n&&(e=parseInt(o.height)*g/100+r)}t||(h&&o.maxWidth?d||(t=o.maxWidth):i||(t=o.width)),o.maxWidth&&(this.maxWidthPixel=t),e||(l&&o.maxHeight?a||(e=o.maxHeight):n||(e=o.height)),parseFloat(t)==t?(t=t<o.minWidth?o.minWidth:t,u.css("width",t)):"auto"===t&&u.width(t),parseFloat(e)==e&&(e=e<o.minHeight?o.minHeight:e,u.css("height",e)),this.width=Math.round(u.width()),this.height=Math.round(u.height())},t.decidePanes=function(){var t=this.that,e=t.pqpanes={v:!1,h:!1,vH:!1},r=t.options,o=r.virtualX,i=r.virtualY,n="flex"==r.height&&!r.maxHeight,a="flex"==r.width&&!r.maxWidth,l=r.numberCell,t=r.freezeRows,r=r.freezeCols;!t||n||!r&&!l.show||a?t&&!n?i||(e.h=!0):!r&&!l.show||a||o||(e.v=!0,e.vH=!0):(i||(e.h=!0),o||(e.v=!0,e.vH=!0))},t._storeColumnWidths=function(t){for(var e=this.that,r=e.options,o=e.colModel,i=r.virtualX,n=r.freezeCols,a=e.initH,l=t?o.length-1:e.finalH,s=[],d=0;d<=l;d++)s[d=!t&&i&&d<a&&n<=d?a:d]={outerWidth:o[d].outerWidth};return s},t._isColumnWidthChanged=function(t){for(var e=this.that,r=e.colModel,o=e.iGenerateView.colDef,i=0,n=o.length;i<n;i++){var a=o[i].colIndx;if(r[a].outerWidth!==t[a].outerWidth)return!0}return!1},t.softRefresh=function(){var t=this.that,e=t.options;this.refreshScrollbars(),t.iGenerateView.setPanes(),t._saveDims(),t.iMouseSelection.syncScrollBarVert(),"flex"==e.height&&this.setContAndGridHeightForFlex(),"flex"==e.width&&this.setContAndGridWidthForFlex(),this._refreshFrozenLine()},t.refreshScrollbars=function(t){t=t||{};var e,r=this,o=r.that,i=o.options,n=o.iGenerateView,a="flex"===i.height,l="flex"===i.width;(a||r.contHt)&&(l||r.contWd)&&null!==o.totalVisibleRows&&(o=1<(e=r.setScrollVNumEles(t)),a&&!i.maxHeight||o===r.vscroll||(r.vscroll=o,i.scrollModel.autoFit||i.virtualX||l?(i=r._storeColumnWidths(),r.refreshColumnWidths(),(r._isColumnWidthChanged(i)||l)&&(r.ignoreTResize=!0,r._refreshTableWidths(i,{table:!0,header:!0}),delete r.ignoreTResize,r.setHeaderHeight(),r.setContHeight(),n.setPanes(),e=r.setScrollVNumEles(!0),r.vscroll=o=1<e),i=null):n.setPanes()),e=r.setScrollHNumEles(),r.hscroll!=(e=1<e)&&(r.hscroll=e,n.setPanes()),r._setScrollHLength(),r._setScrollVLength(t),r._setScrollHVLength())},t._setScrollHVLength=function(){var t=this.that;this.vscroll&&this.hscroll||t.$hvscroll.css("visibility","hidden")},t._setScrollHLength=function(){var t=this.that,e=t.hscroll.widget(),r=t.$hvscroll;if(!t.options.scrollModel.horizontal)return e.css("visibility","hidden"),void r.css("visibility","hidden");e.css("visibility",""),r.css("visibility","");var o=this.contWd,r=this.getSBWidth();e.css("right",0===r?0:""),t.hscroll.option("length",o-r)},t.estVscroll=function(){var t=this.that,e=!0;(null==t.totalVisibleRows||null==this.contHt||t.totalVisibleRows*this.rowHt<this.contHt)&&(e=!1),this.vscroll=e},t.getSBWidth=function(){return null==this.vscroll&&this.estVscroll(),this.vscroll?17:0},t.estHscroll=function(){var t=this.that;if(null==this.contWd)throw"failed";var e=!1,t=this.calcColsOutsideCont(t.colModel)+1;this.hscroll=e=1<t?!0:e},t.getSBHeight=function(){return null==this.hscroll&&this.estHscroll(),this.hscroll?17:0},t.getEContHt=function(){if(null==this.contHt)throw"contHt N/A";return this.contHt-this.getSBHeight()},t.getEContWd=function(){if(null==this.contWd)throw"contWd N/A";return this.contWd-this.getSBWidth()},t.calcColsOutsideCont=function(t){var e=this.that.options,r=e.numberCell,e=e.freezeCols,o=this.contWd-this.getSBWidth(),i=0;r.show&&(i+=r.outerWidth);for(var n=0;n<t.length;n++){var a=t[n];a.hidden||(i+=a.outerWidth)}var l=0,s=0;for(o<Math.round(i)&&s++,n=e;n<t.length;n++)if(!(a=t[n]).hidden){if(!(o<i-(l+=a.outerWidth)))break;s++}return s},t.setScrollHNumEles=function(){var t=this.that,e=t.options,r=t.colModel,o=e.scrollModel,i=+t.hscroll.option("cur_pos"),n=0;return"flex"===e.width&&!e.maxWidth||(n="fullScroll"===o.lastColumn?r.length-e.freezeCols-t._calcNumHiddenUnFrozens():this.calcColsOutsideCont(r)+1),t.hscroll.option("num_eles",n=i&&n<=i?1+i:n),n},t.init=function(){var t=this.that,e=t.options;this.hscroll=this.vscroll=this.contHt=this.contWd=null,t.initH=t.initV=t.finalH=t.finalV=null,t.totalVisibleRows=t.lastFrozenRow=null,this.rowHt=e.rowHeight,this.headerHt=0,this.height=null},t.refresh=function(t){var e,r,o=this,i=o.that,n=(t=t||{}).header,a=t.table,l=t.pager,s=i.iGenerateView,d=i.element;d[0].offsetWidth?(t.toolbar&&i.refreshToolbar(),i.iMouseSelection.resetMargins(),o.init(),e=i.options,o.decidePanes(),e.collapsible._collapsed=!1,o.setMax("maxHeight"),o.setMax("maxWidth"),o.refreshGridWidthAndHeight(),o.initContHeight(),o.initContWidth(),o.calcInitFinal(),!1!==n&&!1!==a||(r=o._storeColumnWidths(!0)),o.refreshColumnWidths(),o.calcInitFinalH(),s.createColDefs(),!1!==n?i._createHeader():o._isColumnWidthChanged(r)&&o._refreshTableWidths(r,{header:!0}),i._refreshHeaderSortIcons(),!1!==l&&i._refreshPager(),o.setHeaderHeight(),o.setContHeight(),!1!==a?s.generateView({source:t.source}):(o._refreshTableWidths(r,{table:!0}),s.setPanes()),i._saveDims(),s.scrollView(),o.refreshScrollbars(),"flex"==e.height&&o.setContAndGridHeightForFlex(),"flex"==e.width&&o.setContAndGridWidthForFlex(),o._refreshFrozenLine(),i._createCollapse(),e.dataModel.postDataOnce=void 0):d.addClass("pq-pending-refresh")},t.summaryTable=function(){var t=this.$summary,e=this.that,r=e.options.summaryData;r?(t=t||(this.$summary=v("<div class='pq-grid-summary'></div>").prependTo(e.$bottom)),e.createTable({data:r,$cont:t})):t&&t[0].innerHTML&&t.empty()},t.refreshVscroll=function(t){var e,r,o,i,n=this.that,a=n.iGenerateView,l=n.options;l.virtualY&&!l.scrollModel.smooth&&(e=n.initV,r=n.finalV,this.calcInitFinal(),o=e-n.initV,i=r-n.finalV,l.fullrefreshOnScroll||l.detailModel.init||n._mergeCells||1!=Math.abs(o)||1!=Math.abs(i)?e==n.initV&&r==n.finalV||a.generateView():-1==o?(a.removeTopRow(1),a.appendRow(n.finalV-r)):1==o&&(a.prependRow(),a.removeBottomRow(r-n.finalV)),n._saveDims(),a.scrollView(),this.setScrollVNumEles()<=1&&this.refreshScrollbars())},t._refreshTableWidths=function(t,e){var r,o=this.that,i=o.$tbl_header,n=e.header&&i,a=o.$tbl,e=e.table&&a,l=n?i.children().children(".pq-row-hidden"):null,s=n?o.$header.find(".pq-grid-col-resize-handle"):null,d=e&&a?a.children().children(".pq-row-hidden"):null,h=!1,c=0;e&&o.tables.length&&(e=o.tables[0].$tbl.children().children(".pq-row-hidden"),d=d?d.add(e):e);for(var u=o.iGenerateView.colDef,p=0,f=u.length;p<f;p++){var g=u[p],v=g.colIndx,w=g.column,g=t[v].outerWidth,w=w.outerWidth;w!==g&&(n&&l.find("td[pq-col-indx="+v+"]").width(w),d&&(r=d.find("td[pq-col-indx="+v+"]")).length&&(h=!0,r.width(w))),c+=w-g,n&&0!==c&&(g=s.filter("[pq-col-indx="+v+"]"),v=parseInt(g.css("left")),g.css("left",v+c))}h&&o._trigger("tableWidthChange"),o._saveDims()}}(jQuery),function(M){var y=M.paramquery,t=y.cClass,e={options:{flex:{on:!0,one:!1,all:!0},detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se glyphicon glyphicon-minus",collapseIcon:"ui-icon-triangle-1-e glyphicon glyphicon-plus"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check glyphicon-ok",rejectIcon:"ui-icon-closethick glyphicon-remove",topIcon:"ui-icon-circle-arrow-s glyphicon glyphicon-circle-arrow-down",bottomIcon:"ui-icon-circle-arrow-n glyphicon glyphicon-circle-arrow-up"},track:null,mergeModel:{flex:!1},realFocus:!0,sortModel:{on:!0,type:"local",multiKey:"shiftKey",number:!0,single:!0,cancel:!0,sorter:[],useCache:!0,ignoreCase:!1},filterModel:{on:!0,type:"local",mode:"AND",header:!1}},_create:function(){var t=this,e=t.options;t.listeners={},t._queueATriggers={},t.iHistory=new y.cHistory(t),t.iGroup=new y.cGroup(t),y.cMerge&&(t.iMerge=new y.cMerge(t)),t.iFilterData=new y.cFilterData(t),t.iSelection=new pq.Selection(t),t.iHeaderSearch=new r(t),t.iUCData=new y.cUCData(t),t.iMouseSelection=new y.cMouseSelection(t),t._super(),new o(t),t.iDragColumns=new y.cDragColumns(t),t.refreshToolbar(),"remote"===e.dataModel.location&&t.refresh({table:!0}),t.on("dataAvailable",function(){t.one("refreshDone",function(){t._trigger("ready"),setTimeout(function(){t.element&&t._trigger("complete")},0)})}),t.refreshDataAndView({header:!0})}};M.widget("paramquery.pqGrid",y._pqGrid,e),M.widget.extend=function(){var t,e,r=Array.prototype.shift,o=M.isPlainObject,i=M.isArray,n=M.widget.extend,a=r.apply(arguments);"boolean"==typeof a&&(t=a,a=r.apply(arguments));var l,s,d,h=arguments,c=0,u=h.length;for(null==t&&(t=1<u);c<u;c++)for(s in l=h[c])void 0!==(d=l[s])&&(e=!(0<c),o(d)?(a[s]=a[s]||{},n(e,a[s],d)):i(d)?a[s]=t&&e?d.slice():d:a[s]=d);return a},pq.grid=function(t,e){e=M(t).pqGrid(e);return e.data("paramqueryPqGrid")||e.data("paramquery-pqGrid")},y.pqGrid.regional={};e=y.pqGrid.prototype;y.pqGrid.defaults=e.options,e.focus=function(t){var e,r=(t=t||{}).$td,o=t.rowIndxPage,i=t.colIndx,t=document.activeElement;if(r)null!=o&&null!=i||(o=(l=this.getCellIndices({$td:r})).rowIndxPage,i=l.colIndx);else{if(null==o||null==i){if(t&&t!=document.body&&"pq-grid-excel"!=t.id&&"pq-grid-cont"!=t.className)return;var n=this._focusElement;if(!n)return;o=n.rowIndxPage,i=n.colIndx}var a,l=this.iMerge,n=o+this.rowIndxOffset;l.ismergedCell(n,i)&&(o=(a=l.getRootCell(n,i,"o")).rowIndxPage,i=a.colIndx),r=this.getCell({rowIndxPage:o,colIndx:i})}this.options.realFocus?(this._focusElement={$ele:r,rowIndxPage:o,colIndx:i},(a=r[0])&&"TD"==a.nodeName.toUpperCase()?!1===M(t).hasClass("pq-editor-focus")&&(a.setAttribute("tabindex",0),a.focus()):(e=this.options.dataModel.data)&&e.length||this.$cont.focus()):((e=this._focusElement)&&(this.removeClass({rowIndxPage:e.rowIndxPage,colIndx:e.colIndx,cls:"pq-focus",refresh:!1}),this.element.find(".pq-focus").removeClass("pq-focus")),r&&(this.addClass({rowIndxPage:o,colIndx:i,cls:"pq-focus"}),this._focusElement={$ele:r,rowIndxPage:o,colIndx:i}),i=this.$cont,document.activeElement!=i[0]&&i[0].focus())},e.onfocus=function(){var t,e;this.options.realFocus||(e=this._focusElement)&&(t=e.rowIndxPage,e=e.colIndx,this.addClass({rowIndxPage:t,colIndx:e,cls:"pq-focus"}))},e.onblur=function(){var t,e;this.options.realFocus||(e=this._focusElement)&&(t=e.rowIndxPage,e=e.colIndx,this.removeClass({rowIndxPage:t,colIndx:e,cls:"pq-focus"}))},e.range=function(t,e){return new pq.Range(this,t,"range",e)},e.rowExpand=function(t){this.iHierarchy.rowExpand(t)},e.rowInvalidate=function(t){this.iHierarchy.rowInvalidate(t)},e.rowCollapse=function(t){this.iHierarchy.rowCollapse(t)},e.saveState=function(t){t=t||{};for(var e,r,o=this.element,i=M.extend,n=this.options,a=i(!0,{},{sorter:n.sortModel.sorter}),l=n.pageModel,s={rPP:l.rPP,curPage:l.curPage},d=this.colModel,h=[],c=0,u=d.length,l=n.groupModel,l=i(!0,{},{dataIndx:l.dataIndx,dir:l.dir,collapsed:l.collapsed,merge:l.merge,grandSummary:l.grandSummary}),o=o[0].id;c<u;c++)r={width:(e=d[c]).width,dataIndx:e.dataIndx,hidden:e.hidden},(e=e.filter)&&(r.filter={value:e.value,value2:e.value2,on:e.on}),h[c]=r;n={colModel:h,height:n.height,datestamp:Date.now(),width:n.width,groupModel:l,pageModel:s,sortModel:a,freezeRows:n.freezeRows,freezeCols:n.freezeCols};return!1!==t.stringify&&(n=JSON.stringify(n),!1!==t.save&&"undefined"!=typeof Storage&&localStorage.setItem("pq-grid"+(o||""),n)),n},e.loadState=function(t){var e=this,r=e.element,o=M.widget.extend,i=M.extend,n=r[0].id,a=(t=t||{}).state||("undefined"==typeof Storage?void 0:localStorage.getItem("pq-grid"+(n||"")));if(!a)return!1;for(var l,s,d,h=(a="string"==typeof a?JSON.parse(a):a).colModel,c=[],u=[],p=[],f=[],g=[],r=e.options,n=1<e.depth,v=(n?e:r).colModel,w=0,m=h.length;w<m;w++)u[d=(l=h[w]).dataIndx]=!0,p[d]=w,c[d]=l.width,f[d]=l.filter,g[d]=l.hidden;n||v.sort(function(t,e){return p[t.dataIndx]-p[e.dataIndx]});for(w=0,m=v.length;w<m;w++)u[d=(s=v[w]).dataIndx]&&(s.width=c[d]||s.width,s.filter=i(s.filter,f[d]),s.hidden=g[d]);e.iColModel.init(),o(r.sortModel,a.sortModel),o(r.pageModel,a.pageModel);var o=a.groupModel;return e.groupOption(o,!1),o={freezeRows:a.freezeRows,freezeCols:a.freezeCols},isNaN(+r.height)||isNaN(+a.height)||(o.height=a.height),isNaN(+r.width)||isNaN(+a.width)||(o.width=a.width),e.option(o),!1!==t.refresh&&e.refreshDataAndView(),!0};var r=function(o){this.that=o;var i=this;function r(t,e,r){o.filter({data:[{dataIndx:t,value:e,value2:r}]})}this.dataHS={},o.on("headerKeyDown",function(t,e){var r=M(t.originalEvent.target);return!r.hasClass("pq-grid-hd-search-field")||i.onKeyDown(t,e,r)}),o.on("createHeader",function(t,e){return i._onCreateHeader()}),this.changeListener={change:function(t,e){r(e.dataIndx,e.value,e.value2)}},this.keyupListener={keyup:function(t,e){r(e.dataIndx,e.value,e.value2)}},this.clickListener={click:function(t,e){r(e.dataIndx,e.value)}}},t=r.prototype=new t;t.get$Ele=function(t,e){var r=this.that,o=r.options.freezeCols,i=M(r.$tbl_header[0]),e=".pq-grid-hd-search-field[name='"+e+"']",r=M(r.$tbl_header[2==r.$tbl_header.length?1:0]),e=(o<=t?r:i).find(e);return e},t.onKeyDown=function(t,e,r){var o=this.that;if(t.keyCode!==M.ui.keyCode.TAB)return!0;var i=r.attr("name"),n=o.getColIndx({dataIndx:i}),a=o.colModel,l=t.shiftKey;if("between"==(d=a[n]).filter.condition){o.scrollColumn({colIndx:n});var s=this.get$Ele(n,i);if(s[0]==r[0]?l||(c=s[1]):l&&(c=s[0]),c)return c.focus(),t.preventDefault(),!1}for(;;){if(l?n--:n++,n<0||n>=a.length)break;var d,h=(d=a[n]).filter;if(!d.hidden&&h){o.scrollColumn({colIndx:n});var i=d.dataIndx,c=this.get$Ele(n,i);if(c="between"==h.condition?M(l?c[1]:c[0]):c)return c.focus(),t.preventDefault(),!1;break}}},t._bindFocus=function(){var r=this.that,o=this;function t(t){var e=M(t.target).closest(".pq-grid-hd-search-field").attr("name");r.scrollColumn({dataIndx:e})&&(t=r.getColIndx({dataIndx:e}),o.get$Ele(t,e).focus())}for(var e=r.$header.find(".pq-grid-header-search-row"),i=0;i<e.length;i++)M(e[i]).on("focusin",t)},t._onCreateHeader=function(){var a=this.that,t=a.options;if(t.filterModel.header){this._bindFocus();var e=a.colModel,r=t.freezeCols,o=a.$tbl_header,i=M(o[0]),n=M(o[1]),l="input,select";if(1<o.length){i.find(l).css("visibility","hidden");for(var s=0;s<r;s++){l="*[name='"+(c=e[s]).dataIndx+"']";i.find(l).css("visibility","visible"),n.find(l).css("visibility","hidden")}}for(var d=a.iGenerateView.colDef,s=0,h=d.length;s<h;s++){var c,u=d[s],p=u.colIndx,f=(c=u.column).filter;if(f){var g=c.dataIndx,u=i,v=(u=r<=p&&1<o.length?n:u).find("*[name='"+g+"']");if(0!=v.length){var u=f.type,w=f.value,m=f.value2;"checkbox"==u&&"triple"==f.subtype?v.pqval({val:w}):"select"==u&&null!=w&&v.val(w);u=f.init;u&&u.call(v,{dataIndx:g,column:c});var x=f.listeners;if(x)for(var _=0;_<x.length;_++){var I,y=x[_];for(I in y="string"==typeof y?this[y+"Listener"]:y)!function(o,i,n){o.bind(I,function(t){var e=a.getColumn({dataIndx:n}),r=e.filter;return"checkbox"==r.type?w="triple"==r.subtype?o.pqval({incr:!0}):!!o.is(":checked"):"between"==r.condition?(w=M(o[0]).val(),m=M(o[1]).val()):w=o.val(),i.call(this,t,{column:e,dataIndx:n,value:w,value2:m})})}(v,y[I],g)}}}}}};function b(t,e){return["<div class='pq-from-div'>",t,"</div>","<span class='pq-from-to-center'>-</span>","<div class='pq-to-div'>",e,"</div>"].join("")}function v(t,e,r){for(var o=0,i=t.length;o<i;o++){for(var n=t[o],a={},l=0,s=e.length;l<s;l++){var d=e[l];a[d]=n[d]}r.push(a)}}function o(t){var r=this;r.that=t,r.findformulas(),t.on("columnChange",function(){r.findformulas()}).on("dataAvailable",function(){r._onDA()}).on(!0,"change",function(t,e){r._onchange(e)})}t.createDOM=function(t,e){var r=this.that,o=r.options,i=o.bootstrap.on?" ":" ui-corner-all",o=(this.dataHS,o.numberCell),n=b;t.push("<tr class='pq-grid-header-search-row'>"),o.show&&t.push(["<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='1'>","<div class='pq-td-div'>&nbsp;</div></td>"].join(""));for(var a=r.iGenerateView.colDef,l=0,s=a.length;l<s;l++){var d=a[l].column,h=e,c=d.halign;"right"==(c=c||d.align)?h+=" pq-align-right":"center"==c&&(h+=" pq-align-center");var u=d.cls;u&&(h=h+" "+u);var p,f,g,v,w,m,x,_,I=d.filter;I?(p=d.dataIndx,f=I.type,g=I.value,_=I.condition,v="pq-grid-hd-search-field "+((v=I.cls)||""),w=(w=I.style)||"",m=(m=I.attr)||"",c="","between"==_&&(x=null!=(x=I.value2)?x:""),"textbox"===f?(g=g||"",v=v+" pq-search-txt"+i,c="between"==_?n(this._input(p,g,v+" pq-from",w,m),this._input(p,x,v+" pq-to",w,m)):this._input(p,g,v,w,m)):"textarea"===f?(g=g||"",v=v+" pq-search-txt"+i,c="between"==_?n(this._textarea(p,g,v+" pq-from",w,m),this._textarea(p,x,v+" pq-to",w,m)):this._textarea(p,g,v,w,m)):"select"===f?I.cache?c=I.cache:("function"==typeof(u=I.options)&&(u=u.call(r,{column:d,value:g,dataIndx:p,cls:v,style:w,attr:m})),_=["name='",p,"' class='",v+=i,"' style='",w,"' ",m].join(""),c=y.select({options:u,attr:_,prepend:I.prepend,valueIndx:I.valueIndx,labelIndx:I.labelIndx,groupIndx:I.groupIndx}),I.cache=c):"checkbox"==f?c=["<input ",null==g||0==g?"":"checked=checked"," name='",p,"' type=checkbox class='"+v+"' style='"+w+"' "+m+"/>"].join(""):"string"==typeof f?c=f:"function"==typeof f&&(c=f.call(r,{width:d.outerWidth,value:g,value2:x,column:d,dataIndx:p,cls:v,attr:m,style:w})),t.push(["<td class='",h,"'><div class='pq-td-div' >","",c,"</div></td>"].join(""))):t.push(["<td class='",h,"'><div class='pq-td-div' >","&nbsp;","</div></td>"].join(""))}t.push("</tr>")},t._input=function(t,e,r,o,i){return['<input value="',e,"\" name='",t,"' type=text style='"+o+"' class='"+r+"' "+i+" />"].join("")},t._textarea=function(t,e,r,o,i){return["<textarea name='",t,"' style='"+o+"' class='"+r+"' "+i+" >",e,"</textarea>"].join("")},e.refreshToolbar=function(){var t,e,r,o,i=this,n=i.options,a=n.toolbar;i._toolbar&&(t=i._toolbar).destroy(),a&&(e=(e=a.cls)||"",r=(r=a.style)||"",o=(o=a.attr)||"",a=a.items,o=M("<div class='"+e+"' style='"+r+"' "+o+" ></div>"),t?t.widget().replaceWith(o):i.$top.append(o),t=pq.toolbar(o,{items:a,gridInstance:i,bootstrap:n.bootstrap}),n.showToolbar||o.css("display","none"),i._toolbar=t)},e.isLeftOrRight=function(t){this.options;return this.freezeCols<t?"right":"left"},e.ovCreateHeader=function(t,e){this.options.filterModel.header&&this.iHeaderSearch.createDOM(t,e)},e.filter=function(t){var e=this,r=this.options,o=void 0===t.apply||t.apply,i=void 0===t.sort||t.sort,n=r.dataModel,r=r.filterModel;if(null!=t)for(var a="replace"==t.oper,l=t.data,s=this.colModel,d=0,h=(s=o?s:M.extend(!0,[],s)).length,c=l.length,u=0;u<h;u++){for(var p=s[u],f=!1,g=0;g<c&&d!=c;g++){var v=l[g];if(v.dataIndx==p.dataIndx){f=!0,d++;var w=p.filter,m=v.condition,x=v.value;if(w?w.on=!0:w=p.filter={on:!0},m&&(w.condition=m),m=w.condition,w.value=x,"between"==m)w.value2=v.value2;else if("range"==m){var _=[];if(x)if("string"==typeof x){var I=w.options,v=x.indexOf('"'),m=x.lastIndexOf('"'),x=x.substr(v,m+1);if(x=JSON.parse("["+x+"]"),I)for(var y=0,b=I.length;y<b;y++){var C=I[y];-1!=M.inArray(C,x)&&_.push(C)}else _=x.split(",s*")}else"function"==typeof x.push&&(_=x);w.value=_}break}}a&&!f&&p.filter&&(p.filter.on=!1)}var q={header:!1,apply:o,sort:i,CM:s};if("remote"!=n.location||"local"==r.type)return q.source="filter",q.trigger=!1,e._onDataAvailable(q);this.remoteRequest({apply:o,CM:s,callback:function(){return e._onDataAvailable(q)}})},e._initTypeColumns=function(){for(var t=this.colModel,e=0,r=t.length;e<r;e++){var o=t[e],i=o.type;"checkBoxSelection"===i||"checkbox"==i?(o.type="checkbox",new y.cCheckBoxColumn(this,o)):"detail"===i&&(o.dataIndx="pq_detail",this.iHierarchy=new y.cHierarchy(this,o))}},e.refreshHeader=function(){this._createHeader(),this.iGenerateView.setPanes(),this._refreshHeaderSortIcons()},e._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()},e.getLargestRowCol=function(t){for(var e,r=0;r<t.length;r++){var o=t[r],i=o.rowIndx;null==e?e=o.rowIndx:e<i&&(e=i),e=o.rowIndx}},e.bringCellToView=function(t){this._bringCellToView(t)},e._setUrl=function(t){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=t?t:"")}}},e.pageData=function(){return this.pdata},e.getData=function(t){var e=(t=t||{}).dataIndx,r=e?e.length:0,o=t.data,i=this.options.dataModel,t=i.data,i=i.dataUF,n=[];if(!r)return t.concat(i||[]);o?v(o,e,n):(t&&v(t,e,n),i&&v(i,e,n));for(var a=[],l=0;l<r;l++){var s=e[l],d=this.getColumn({dataIndx:s});a.push({dataIndx:s,dir:"up",dataType:d.dataType,sortType:d.sortType})}for(var h=[],c=void 0,u=0,p=(n=this.iSort._sortLocalData(a,n)).length;u<p;u++){var f=n[u],g=JSON.stringify(f);g!==c&&(h.push(f),c=g)}return h},e.get_p_data=function(){var t=this.options,e="remote"==t.pageModel.type,r=t.dataModel.data,o=this.pdata,i=this.rowIndxOffset,n=t.groupModel,t=i&&e?new Array(i):[];return n.on&&n.dataIndx.length?i?(t=!e?r.slice(0,i):t).concat(o):o:i&&e?t.concat(o):r},e._onDataAvailable=function(t){var e=this.options,r=null==(t=t||{}).apply||t.apply,o=t.source,i=t.sort,n=[],a=e.filterModel,l=e.dataModel,s=e.sortModel,e=l.location;if(!1!==r&&!1!==t.trigger&&this._trigger("dataAvailable",t.evt,{source:o}),n=(a&&a.on&&("local"==e&&"remote"!=a.type||"remote"==e&&"local"==a.type)?this.iFilterData.filterLocalData(t):l).data,"local"==s.type&&!1!==i&&(r?this.sort({refresh:!1}):n=this.iSort.sortLocalData(n)),!1===r)return n;l.data=n,this.refreshView(t)},e.reset=function(t){var e,r,o,i=this,n=(t=t||{}).sort,a=0,l=i.options,s=M.extend,d=t.filter,h=t.group;if(n||d||h){if(n&&s(l.sortModel,!0===n?{sorter:[]}:n),d)for(r=(e=i.getColModel()).length;a<r;a++)(o=e[a].filter)&&(o.value=null,o.value2=null,o.cache=null);h&&i.groupOption(!0===h?{dataIndx:[]}:h,!1),!1!==t.refresh&&(d?(i.filter({oper:"replace",data:[]}),i.refreshHeader()):n?i.sort():i.refreshView())}},e._trigger=y._trigger,e.on=y.on,e.one=y.one,e.off=y.off,e.pager=function(){return this.pagerW},e.vscrollbar=function(){return this.vscroll},e.hscrollbar=function(){return this.hscroll},e.toolbar=function(){return this._toolbar.element};e=(y.cCompute=o).prototype;e.callRow=function(t,e,r){if(t)for(;r--;){var o=e[r],i=o.formula,o=o.column;t[o.dataIndx]=i.call(this.that,{rowData:t,column:o})}},e._onDA=function(){var t=this.formulas.length;if(t)for(var e=this.that.options.dataModel.data,r=e.length,o=this.formulas;r--;)this.callRow(e[r],o,t)},e._onchange=function(t){var e=this.formulas.length;if(e)for(var r=t.rowList,o=this.formulas,i=r.length;i--;)this.callRow(r[i].rowData,o,e)},e.findformulas=function(){for(var t,e,r=this.that.colModel,o=[],i=r.length;i--;)(e=(t=r[i]).formula)&&o.push({formula:e,column:t});this.formulas=o};e=(y.cColModel=function(t){this.that=t,this.init()}).prototype;e.extend=function(t,e){for(var r,o,i=M.extend,n=t.length;n--;){var a=t[n];for(r in e)void 0===a[r]&&(o=e[r],a[r]=o&&"object"==typeof o?i(!0,{},o):o)}},e.init=function(){var t=this.that,e=t.options,r=e.columnTemplate,o=e.colModel;o||(this._autoGenColumns(),o=e.colModel),e=this.nestedCols(o),t.depth=e.depth,e=(o=t.colModel=e.colModel).length,r&&this.extend(o,r),this.getHeadersCells(),this.alignColumns(o,e),this.assignRowSpan(),this._refreshDataIndices(),t._trigger("CMInit")},e.alignColumns=function(t,e){for(var r=0;r<e;r++){var o,i=t[r];i.align||(!(o=i.dataType)||"integer"!=o&&"float"!=o||(i.align="right"))}},e.nestedCols=function(t,e,r,o){for(var i=t.length,n=[],a=e=null==e?1:e,l=0,s=0,d=0,h=0;h<i;h++){var c=t[h];c.parent=o||void 0,!0===r&&(c.hidden=r);var u=c.colModel;u&&u.length?(u=this.nestedCols(u,e+1,c.hidden,c),n=n.concat(u.colModel),0<u.colSpan?(u.depth>a&&(a=u.depth),c.colSpan=u.colSpan,l+=u.colSpan):c.colSpan=0,d+=u.o_colspan,c.o_colspan=u.o_colspan,c.childCount=u.childCount,s+=u.childCount):(c.hidden?c.colSpan=0:(c.colSpan=1,l++),d++,c.o_colspan=1,c.childCount=0,s++,n.push(c))}return{depth:a,colModel:n,colSpan:l,width:0,childCount:s,o_colspan:d}},e.getHeadersCells=function(){for(var t=this.that,e=t.options.colModel,r=t.colModel.length,o=t.depth,i=[],n=0;n<o;n++){i[n]=[];for(var a,l=0,s=0,d=0;d<r;d++){if(0==n)a=e[l];else{var h=i[n-1][d],c=h.colModel;if(c&&0!=c.length){for(var u=d-h.leftPos,p=0,f=0,g=0;g<c.length;g++)if(u<(p+=0<c[g].childCount?c[g].childCount:1)){f=g;break}a=c[f]}else a=h}h=a.childCount||1;d==s?(a.leftPos=d,i[n][d]=a,s+=h,e[l+1]&&l++):i[n][d]=i[n][d-1]}}return t.headerCells=i},e.getDataType=function(){var t=this.colModel;if(t&&t[0])return"string"==typeof t[0].dataIndx?"JSON":"ARRAY"},e.assignRowSpan=function(){for(var t=this.that,e=t.colModel.length,r=t.headerCells,o=t.depth,i=0;i<e;i++)for(var n=0;n<o;n++){var a=r[n][i];if(!(0<i&&a==r[n][i-1])&&!(0<n&&a==r[n-1][i])){for(var l=1,s=n+1;s<o;s++)a==r[s][i]&&l++;a.rowSpan=l}}return r},e._autoGenColumns=function(){var t=this.that.options,e=t.columnTemplate||{},o=e.dataType,i=e.title,n=e.width,e=t.dataModel.data,a=pq.validation,l=[];e&&e.length&&(e=e[0],M.each(e,function(t,e){var r="string";a.isInteger(e)?r=-1<e+"".indexOf(".")?"float":"integer":a.isDate(e)?r="date":a.isFloat(e)&&(r="float"),l.push({dataType:o||r,dataIndx:t,title:i||t,width:n||100})})),t.colModel=l},e._refreshDataIndices=function(){for(var t=this.that,e="JSON"==this.getDataType(),r={},o={},i={},n=t.colModel,a=n.length,l=0;l<a;l++){var s=n[l],d=s.dataIndx;null==d&&("pq_detail"==(d="detail"==s.type?"pq_detail":e?"dataIndx_"+l:l)&&(s.dataType="object"),s.dataIndx=d),r[d]=s,o[d]=l,s.validations&&(i[d]=i)}t.columns=r,t.colIndxs=o,t.validations=i}}(jQuery),function(a){var d=a.paramquery,t=d._pqGrid.prototype;t.exportExcel=function(t){return(t=t||{}).format="xlsx",this.exportData(t)},t.exportCsv=function(t){return(t=t||{}).format="csv",this.exportData(t)},t.exportData=function(t){return new e(this,t).Export(t)};var e=d.cExport=function(t,e){this.that=t,this.templates={content_types:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Override PartName="/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/worksheet.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',workbook:['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets><sheet name="',e.sheetName||"ParamQuery Pro",'" sheetId="1" r:id="rId1"/></sheets></workbook>'].join(""),worksheet:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><%=content%></worksheet>',rels:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="workbook.xml"/></Relationships>',workbook_rels:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheet.xml"/></Relationships>'}},t=e.prototype;t.getTitle=function(t,e){var r=t.title;return r?"function"==typeof r&&(r=r.call(this.that,{colIndx:e,column:t,dataIndx:t.dataIndx,Export:!0})):r="",r},t.getRenderVal=function(t,e,r){var o=t.column,i=o.exportRender;return(e&&!1!==i||i)&&(o.render||o._render||o.format)?r.renderCell(t):t.rowData[t.dataIndx]},t.getXlsMergeCells=function(t,e,r,o){t=t.concat(r.getMergeCells(e,this.curPage,o));var i=[],n=d.toLetter,a=t.length;i.push('<mergeCells count="'+a+'">');for(var l=0;l<a;l++){var s=n((s=t[l]).c1)+(s.r1+1)+":"+n(s.c2)+(s.r2+1);i.push('<mergeCell ref="',s,'"/>')}return i.push("</mergeCells>"),a?i.join(""):""},t.getXlsCols=function(t,e){function r(t,e,r,o,i){t.push('<col min="',e,'" max="',r,'" hidden="',o,'" customWidth="1" width="',Math.ceil(i/7),'"/>')}var o,i,n,a,l=[],s=0;l.push("<cols>");for(var d=0;d<e;d++){var h=t[d],c=h.hidden?"1":"0",u=h._width;!1!==h.copy&&(s++,n===(u=u||((u=parseInt(h.width))||100))&&a===c?i=s:(null!=n&&(r(l,o,i,a,n),o=null),i=s,null==o&&(o=s)),n=u,a=c)}return r(l,o,i,a,n),l.push("</cols>"),l.join("")},t.getXlsHeader=function(t,e,r){for(var o=[],i=0;i<e;i++){var n=t[i];o.push("<row>");for(var a=0,l=n.length;a<l;a++){var s,d,h,c=n[a];!1!==c.copy&&(s=c.o_colspan,d=c.rowSpan,h=this.getTitle(c,a),0<i&&c==t[i-1][a]||0<a&&c==t[i][a-1]?h="":(1<s||1<d)&&r.push({r1:i,c1:a,r2:i+d-1,c2:a+s-1}),o.push('<c t="inlineStr"><is><t><![CDATA['+h+"]]></t></is></c>"))}o.push("</row>")}return o.join("")},t.getXlsBody=function(t,e,r,o,i,n,a,l,s){for(var d,h,c,u,p,f,g,v=[],w={integer:"Number",float:"Number",bool:"bool"},m=0;m<o;m++){for(f=(u=r[m]).pq_hidden?'hidden="1"':"",c={rowIndx:p=i?m+n:m,rowIndxPage:p-n,rowData:u,Export:!0},v.push("<row "+f+">"),d=0;d<e;d++)!1!==(g=t[d]).copy&&(h=void 0,a.ismergedCell(p,d)&&(a.isRootCell(p,d,"o")||(h=null)),void 0===h&&(c.colIndx=d,c.column=g,c.dataIndx=g.dataIndx,h=this.getRenderVal(c,l,s)),g=null==h?null:w[g.dataType],"string"==typeof h&&(g="String"),h=null==h?"":h,"String"==(g=g||"String")?v.push('<c t="inlineStr"><is><t><![CDATA['+h+"]]></t></is></c>"):"Number"!=g&&"bool"==g?v.push('<c t="b"><v>'+(h=h?"1":"0")+"</v></c>"):v.push("<c><v>"+h+"</v></c>"));v.push("</row>")}return v.join("\n")},t.getXlsContent=function(t,e,r,o,i,n,a,l,s,d,h,c){var u='<sheetViews><sheetView workbookViewId="0"><pane ySplit="<%=a%>" topLeftCell="A<%=b%>" activePane="bottomLeft" state="frozen"/></sheetView></sheetViews>',p=this.getXlsCols(t,e),f=[],g=c?o:0;return[u=(u=u.replace("<%=a%>",g)).replace("<%=b%>",g+1),p,"<sheetData>",c?this.getXlsHeader(r,o,f):"",this.getXlsBody(t,e,i,n,a,l,s,d,h),"</sheetData>",this.getXlsMergeCells(f,c?o:0,s,n)].join("")},t.getHtmlHeader=function(t,e){for(var r,o,i,n,a=[],l=0;l<e;l++){var s=t[l],d=null;a.push("<tr>");for(var h=0,c=s.length;h<c;h++)r=(n=s[h]).colSpan,!n.hidden&&r&&!1!==n.copy&&(o=n.rowSpan,0<l&&n==t[l-1][h]||d&&0<h&&n==d||(i=this.getTitle(n,h),n=(d=n).halign||n.align,a.push("<th colspan=",r," rowspan=",o," ",n=n?"align="+n:"",">",i,"</th>")));a.push("</tr>")}return a.join("")},t.getHtmlBody=function(t,e,r,o,i,n,a,l,s){for(var d,h,c,u,p,f,g,v,w,m=[],x=0;x<o;x++)if(!(p=r[x]).pq_hidden){for(u={rowIndx:f=i?x+n:x,rowIndxPage:f-n,rowData:p,Export:!0},m.push("<tr>"),d=0;d<e;d++)if(!(w=t[d]).hidden&&!1!==w.copy){if(h=null,v="",a.ismergedCell(f,d)){if(!(c=a.isRootCell(f,d)))continue;(h=a.getRootCell(f,d,"o")).Export=!0,g=this.getRenderVal(h,l,s),v="rowspan="+c.rowspan+" colspan="+c.colspan+" "}else u.colIndx=d,u.column=w,u.dataIndx=w.dataIndx,g=this.getRenderVal(u,l,s);v+=(w=w.align)?"align="+w:"",m.push("<td ",v,">",g=null==g?"":g,"</td>")}m.push("</tr>")}return m.join("")},t.getHtmlContent=function(t,e,r,o,i,n,a,l,s,d,h,c,u){var p=this.that,f=t.cssRules||"",g=p.element.find(".pq-grid-table"),v=g.css("font-family"),p=g.css("font-size"),g=[];return g.push("<!DOCTYPE html><html><head>",'<meta charset="utf-8" />',"<title>",t.title||"ParamQuery Pro","</title>","</head><body>","<style>","table{empty-cells:show;font-family:"+v+";font-size:"+p+";border-collapse:collapse;}","td,th{padding: 5px;border:1px solid #ccc;}",f,"</style>","<table>"),g.push(u?this.getHtmlHeader(o,i,e):""),g.push(this.getHtmlBody(e,r,n,a,l,s,d,h,c)),g.push("</table></body></html>"),g.join("")},t.getCsvHeader=function(t,e,r,o){for(var i,n,a=[],l=[],s=0;s<e;s++){for(var d=t[s],h=null,c=0,u=d.length;c<u;c++)(n=r[c]).hidden||!1===n.copy||(i=d[c],0<s&&i==t[s-1][c]||h&&0<c&&i==h?a.push(""):(n=(n=this.getTitle(i,c))?n.replace(/\"/g,'""'):"",h=i,a.push('"'+n+'"')));l.push(a.join(o)),a=[]}return l},t.getCSVContent=function(t,e,r,o,i,n,a,l,s,d,h,c,u){for(var p,f=t.separator||",",g=[],v=u?this.getCsvHeader(o,i,e,f):[],w=0;w<a;w++)if(!(p=n[w]).pq_hidden){for(var m,x,_,I={rowIndx:m=l?w+s:w,rowIndxPage:m-s,rowData:p,Export:!0},y=0;y<r;y++)(_=e[y]).hidden||!1===_.copy||(_=(_=((x=null)==(_=d.ismergedCell(m,y)?d.isRootCell(m,y)?((x=d.getRootCell(m,y,"o")).Export=!0,this.getRenderVal(x,h,c)):"":(I.colIndx=y,I.column=_,I.dataIndx=_.dataIndx,this.getRenderVal(I,h,c)))?"":_)+"").replace(/\"/g,'""'),g.push('"'+_+'"'));v.push(g.join(f)),g=[]}return v.join("\n")},t.getJsonContent=function(t,e){return t.nostringify?e:JSON.stringify(e,t.nopqdata?function(t,e){if(0!==(t+"").indexOf("pq_"))return e}:null,t.nopretty?null:2)},t.postRequest=function(t){var e,r,o=t.format,i=t.url,n=t.filename||"pqGrid";return t.zip&&"xlsx"!=o?((r=new JSZip).file(n+"."+t.format,t.data),e=r.generate({type:"base64",compression:"DEFLATE"}),r=!0,o="zip"):(r=!!t.decodeBase,e=t.data),i&&a.ajax({url:i,type:"POST",cache:!1,data:{pq_ext:o,pq_data:e,pq_decode:r,pq_filename:n},success:function(t){i=i+(0<i.indexOf("?")?"&":"?")+"pq_filename="+t,a(document.body).append("<iframe height='0' width='0' frameborder='0' src=\""+i+'"></iframe>')}}),e},t.Export=function(t){var e,r=this.that,o=r.options,i=this.templates,n=o.groupModel,a="remote"==o.pageModel.type,l=r.rowIndxOffset,s=r.iGenerateView,d=r.iMerge,h=r.colModel,c=h.length,u=r.headerCells,p=u.length,f=(this.curPage=n.on&&n.dataIndx.length||a)?r.pdata:o.dataModel.data,g=(f=o.summaryData?f.concat(o.summaryData):f).length,v=t.url,w=t.render,m=!t.noheader,x=t.format;return r._trigger("beforeExport",null,t),"xlsx"==x?(n=this.getXlsContent(h,c,u,p,f,g,a,l,d,w,s,m),(o=new JSZip).file("[Content_Types].xml",i.content_types),o.file("workbook.xml",i.workbook),o.file("worksheet.xml",i.worksheet.replace("<%=content%>",n)),(n=o.folder("_rels")).file(".rels",i.rels),n.file("workbook.xml.rels",i.workbook_rels),v?(t.data=o.generate({type:"base64",compression:"DEFLATE"}),t.decodeBase=!0):e=o.generate({type:"blob",compression:"DEFLATE"})):t.data="json"==x?this.getJsonContent(t,f):"csv"==x?this.getCSVContent(t,h,c,u,p,f,g,a,l,d,w,s,m):this.getHtmlContent(t,h,c,u,p,f,g,a,l,d,w,s,m),e=e||this.postRequest(t),r._trigger("exportData",null,t),e}}(jQuery),function(R){var P=R.paramquery,t={options:{items:[],gridInstance:null}};R.widget("paramquery.pqToolbar",t),(t=P.pqToolbar.prototype).refresh=function(){this.element.empty(),this._create()},t._create=function(){var t,e=this.options,r=e.gridInstance,o={button:"click",select:"change",checkbox:"change",textbox:"change"},i=e.bootstrap,n=i.on,a=r.colModel,l=e.items,s=this.element;s.addClass("pq-toolbar");for(var d=0,h=l.length;d<h;d++){var c,u,p,f=l[d],g=f.type,v=f.value,w=f.icon,m=f.options||{},x=f.label,_=(_=(c=f.listener)?[c]:f.listeners)||[function(){}],I=f.cls,y=I||"",y=(y=n&&"button"==g?i.btn+" "+y:y)?"class='"+y+"'":"",b=f.style,C=b?"style='"+b+"'":"",I=f.attr,b=I||"",I=(I=x&&"button"!=g?[y,b]:[y,b,C]).join(" ");f.options=m,"textbox"==g?p=R([x?"<label "+C+">"+x:"","<input type='text' "+I+">",x?"</label>":""].join("")):"textarea"==g?p=R([x?"<label "+C+">"+x:"","<textarea "+I+"></textarea>",x?"</label>":""].join("")):"checkbox"==g?p=R([x?"<label "+C+">":"","<input type='checkbox' ",v?"checked='checked' ":"",I,">",x?x+"</label>":""].join("")):"separator"==g?p=R("<span class='pq-separator' "+[b,C].join(" ")+"></span>"):"button"==g?(p=R("<button type='button' "+I+">"+(n?w?"<span class='glyphicon "+w+"'></span>":"":"")+x+"</button>"),R.extend(m,{label:x||!1,icons:{primary:n?"":w}}),p.button(m)):"select"==g?("function"==typeof m&&(m=m.call(r,{colModel:a})),u=P.select({options:m=m||[],attr:I,prepend:f.prepend,groupIndx:f.groupIndx,valueIndx:f.valueIndx,labelIndx:f.labelIndx}),p=R([x?"<label "+C+">"+x:"",u,x?"</label>":""].join(""))):"string"==typeof g?p=R(g):"function"==typeof g&&(u=g.call(r,{colModel:a,cls:y}),p=R(u)),p.appendTo(s),"checkbox"!==g&&void 0!==v&&(x?R(p[0].children[0]):p).val(v);for(var q=0,M=_.length;q<M;q++){var D={};for(t in"function"==typeof(c=_[q])?D[o[g]]=c:D=c,D)p.on(t,this._onEvent(r,D[t],f))}}},t._onEvent=function(e,r,o){return function(t){"checkbox"==o.type?o.value=R(t.target).prop("checked"):o.value=R(t.target).val(),r.call(e,t)}},t._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},t._disable=function(){null==this.$disable&&(this.$disable=R("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},t._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},t._setOption=function(t,e){"disabled"==t&&(1==e?this._disable():this._enable())},pq.toolbar=function(t,e){e=R(t).pqToolbar(e);return e.data("paramqueryPqToolbar")||e.data("paramquery-pqToolbar")}}(jQuery),function(C){var t=C.paramquery,e=t.pqGrid.prototype.options;e.trackModel=e.trackModel||{on:!1,dirtyClass:"pq-cell-dirty"};e=(t.cUCData=function(t){this.that=t,this.udata=[],this.ddata=[],this.adata=[],this.options=t.options;var r=this;t.on("dataAvailable",function(t,e){"filter"!=e.source&&(r.udata=[],r.ddata=[],r.adata=[])})}).prototype=new t.cClass;e.add=function(t){for(var e=this.that,r=this.adata,o=this.ddata,i=t.rowData,n=this.options.trackModel.dirtyClass,a=e.getRecId({rowData:i}),l=0,s=r.length;l<s;l++){var d=r[l];if(null!=a&&d.recId==a)throw"primary key violation";if(d.rowData==i)throw"same data can't be added twice."}for(l=0,s=o.length;l<s;l++)if(i==o[l].rowData)return void o.splice(l,1);var h,c=[];for(h in i)c.push(h);e.removeClass({rowData:i,dataIndx:c,cls:n});t={recId:a,rowData:i};r.push(t)},e.update=function(t){var e=this.that,r=this.options.trackModel.dirtyClass,o=t.rowData||e.getRowData(t),i=e.getRecId({rowData:o}),n=t.dataIndx,a=t.refresh,l=e.columns,s=e.getValueFromDataType,d=t.row,h=this.udata,c=h.slice(0),u=!1;if(null!=i){for(var p=0,f=h.length;p<f;p++){var g=h[p],v=g.oldRow;if(g.rowData==o){for(var n in u=!0,d){var w=l[n].dataType,m=s(m=d[n],w),x=s(x=v[n],w);v.hasOwnProperty(n)&&x===m?(e.removeClass(_={rowData:o,dataIndx:n,refresh:a,cls:r}),delete v[n]):(e.addClass(_={rowData:o,dataIndx:n,refresh:a,cls:r}),v.hasOwnProperty(n)||(v[n]=o[n]))}C.isEmptyObject(v)&&c.splice(p,1);break}}if(!u){v={};for(n in d){v[n]=o[n];var _={rowData:o,dataIndx:n,refresh:a,cls:r};e.addClass(_)}_={rowData:o,recId:i,oldRow:v};c.push(_)}this.udata=c}},e.delete=function(t){for(var e=this.that,r=t.rowIndx,o=t.rowIndxPage,i=e.rowIndxOffset,r=null==r?o+i:r,o=null==o?r-i:o,i="remote"==e.options.pageModel.type?o:r,n=this.adata,o=this.ddata,a=e.getRowData(t),l=0,s=n.length;l<s;l++)if(n[l].rowData==a)return void n.splice(l,1);o.push({indx:i,rowData:a,rowIndx:r})},e.isDirty=function(t){var e=this.that,r=this.udata,o=this.adata,i=this.ddata,n=!1,a=e.getRowData(t);if(a){for(var l=0;l<r.length;l++)if(a==r[l].rowData){n=!0;break}}else(r.length||o.length||i.length)&&(n=!0);return n},e.getChangesValue=function(t){for(var e=this.that,r=(t=t||{}).all,o=this.udata,i=this.adata,n=this.ddata,a=[],l=[],s=[],d=[],h=[],c=[],u=0,p=n.length;u<p;u++){var f=(m=n[u]).rowData,g={};for(w in h.push(f),f)0!=w.indexOf("pq_")&&(g[w]=f[w]);c.push(g)}for(u=0,p=o.length;u<p;u++){var v=(m=o[u]).oldRow,f=m.rowData;if(-1==C.inArray(f,h)&&-1==C.inArray(f,a)){g={};if(!1!==r)for(var w in f)0!=w.indexOf("pq_")&&(g[w]=f[w]);else{for(var w in v)g[w]=f[w];g[e.options.dataModel.recIndx]=m.recId}a.push(f),l.push(g),s.push(v)}}for(u=0,p=i.length;u<p;u++){var m,g={};for(w in f=(m=i[u]).rowData)0!=w.indexOf("pq_")&&(g[w]=f[w]);d.push(g)}return{updateList:l,addList:d,deleteList:c,oldList:s}},e.getChanges=function(){this.that;for(var t=this.udata,e=this.adata,r=this.ddata,o=C.inArray,i=[],n=[],a=[],l=[],s=0,d=r.length;s<d;s++){var h=(u=r[s]).rowData;l.push(h)}for(s=0,d=t.length;s<d;s++){var c=(u=t[s]).oldRow;-1==o(h=u.rowData,l)&&-1==o(h,i)&&(i.push(h),n.push(c))}for(s=0,d=e.length;s<d;s++){var u,h=(u=e[s]).rowData;a.push(h)}return{updateList:i,addList:a,deleteList:l,oldList:n}},e.getChangesRaw=function(){this.that;var t=this.udata,e=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]};return o.updateList=t,o.addList=e,o.deleteList=r,o},e.commitAdd=function(t,e){for(var r=this.that,o=r.colModel,i=o.length,n=this.adata,a=C.inArray,l=n.length,s=r.getValueFromDataType,d=[],h=t.length,c=[],u=0;u<h;u++)for(var p=t[u],f=0;f<l;f++){var g=!0;if(-1==a(y=n[f].rowData,c)){for(var v=0;v<i;v++){var w=o[v],m=w.hidden,x=w.dataType,w=w.dataIndx;if(!m&&w!=e)if(s(y[w],x)!==s(p[w],x)){g=!1;break}}if(g){var _={},I={};_[e]=p[e],I[e]=y[e],d.push({type:"update",rowData:y,oldRow:I,newRow:_}),c.push(y);break}}}for(var y,b=[],f=0;f<l;f++)-1==a(y=n[f].rowData,c)&&b.push(n[f]);return this.adata=b,d},e.commitUpdate=function(t,e){for(var r=this.that,o=this.options.trackModel.dirtyClass,i=(r.colModel.length,this.udata),n=i.length,a=t.length,l=[],s=0;s<n;s++){var d=i[s],h=d.rowData,c=d.oldRow;if(-1==C.inArray(h,l))for(var u=0;u<a;u++){var p=t[u];if(h[e]==p[e])for(var f in l.push(h),c)r.removeClass({rowData:h,dataIndx:f,cls:o})}}for(var g=[],s=0;s<n;s++){h=i[s].rowData;-1==C.inArray(h,l)&&g.push(i[s])}return this.udata=g,[]},e.commitDelete=function(t,e){for(var r,o,i,n,a=this.ddata,l=a.length,s=this.udata;l--&&(o=(r=a[l].rowData)[e],i=t.length);)for(;i--;)if(o==t[i][e]){for(t.splice(i,1),a.splice(l,1),n=s.length;n--;)s[n].rowData==r&&s.splice(n,1);break}},e.commitUpdateAll=function(){for(var t=this.that,e=this.options.trackModel.dirtyClass,r=this.udata,o=0,i=r.length;o<i;o++){var n,a=r[o],l=a.oldRow,s=a.rowData;for(n in l)t.removeClass({rowData:s,dataIndx:n,cls:e})}this.udata=[]},e.commitAddAll=function(){this.adata=[]},e.commitDeleteAll=function(){for(var t,e=this.ddata,r=this.udata,o=r.length,i=e.length,n=0;0<o&&n<i;n++){for(t=e[n].rowData;o--;)r[o].rowData==t&&r.splice(o,1);o=r.length}e.length=0},e.commit=function(t){var e,r,o=this.that,i=null!=(i=t?t.history:null)&&i,n=[],a=[],l=o.options.dataModel.recIndx;null==t?(this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll()):(r=t.type,t=t.rows,"add"==r?t?n=this.commitAdd(t,l):this.commitAddAll():"update"==r?t?a=this.commitUpdate(t,l):this.commitUpdateAll():"delete"==r&&(t?this.commitDelete(t,l):this.commitDeleteAll())),(e=n.concat(a)).length&&(o._digestData({source:"commit",checkEditable:!1,track:!1,history:i,rowList:e}),o.refreshView())},e.rollbackAdd=function(t,e){for(var r=this.adata,o=[],i=(t.type,0),n=r.length;i<n;i++){var a=r[i].rowData;o.push({type:"delete",rowData:a})}return this.adata=[],o},e.rollbackDelete=function(t,e){for(var r=this.ddata,o=[],i=(t.type,r.length-1);0<=i;i--){var n=r[i],a=(n.indx,n.rowIndx),n=n.rowData;o.push({type:"add",rowIndx:a,newRow:n})}return this.ddata=[],o},e.rollbackUpdate=function(t,e){for(var r=this.that,o=this.options.trackModel.dirtyClass,i=this.udata,n=[],a=0,l=i.length;a<l;a++){var s=i[a],d=s.recId,h=s.rowData,c={},s=s.oldRow;if(null!=d){var u,p=[];for(u in s)c[u]=h[u],p.push(u);r.removeClass({rowData:h,dataIndx:p,cls:o,refresh:!1}),n.push({type:"update",rowData:h,newRow:s,oldRow:c})}}return this.udata=[],n},e.rollback=function(t){var e,r=this.that,o=r.options.dataModel,i=r.options.pageModel,n=!t||null==t.refresh||t.refresh,a=t&&null!=t.type?t.type:null,l=[],s=[],t=[],o=o.data;null!=a&&"update"!=a||(s=this.rollbackUpdate(i,o)),null!=a&&"delete"!=a||(l=this.rollbackDelete(i,o)),null!=a&&"add"!=a||(t=this.rollbackAdd(i,o)),e=l.concat(t,s),r._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:e}),n&&r.refreshView()};t=t.pqGrid.prototype;t.getChanges=function(t){if(this.blurEditor({force:!0}),t){var e=t.format;if(e){if("byVal"==e)return this.iUCData.getChangesValue(t);if("raw"==e)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},t.rollback=function(t){this.blurEditor({force:!0}),this.iUCData.rollback(t)},t.isDirty=function(t){return this.iUCData.isDirty(t)},t.commit=function(t){this.iUCData.commit(t)},t.updateRow=function(t){for(var e=t.rowList||[{rowIndx:t.rowIndx,newRow:t.newRow||t.row,rowData:t.rowData,rowIndxPage:t.rowIndxPage}],r=[],o=0,i=e.length;o<i;o++){var n=this.normalize(e[o]),a=n.newRow,l=n.rowData,s={};if(l){for(var d in a)s[d]=l[d];n.oldRow=s,n.type="update",r.push(n)}}return!!r.length&&(!1!==this._digestData({source:t.source||"update",history:t.history,checkEditable:t.checkEditable,track:t.track,allowInvalid:t.allowInvalid,rowList:r})&&void(!1!==t.refresh&&(1<r.length?this.refresh():this.refreshRow({rowIndx:r[0].rowIndx}))))},t.getRecId=function(t){var e=this.options.dataModel;t.dataIndx=e.recIndx;t=this.getCellData(t);return null==t?null:t},t.getCellData=function(t){var e=t.rowData||this.getRowData(t),t=t.dataIndx;return e?e[t]:null},t.getRowData=function(t){if(!t)return null;var e,r=t.rowData;if(null!=r)return r;if(null==(e=t.recId)){var o=null!=(o=t.rowIndx)?o:t.rowIndxPage+this.rowIndxOffset;return i=this.get_p_data()[o]}for(var i,o=this.options.dataModel,n=o.recIndx,a=o.data,l=0,s=a.length;l<s;l++)if((i=a[l])[n]==e)return i;return null},t.deleteRow=function(t){for(var e=t.rowList||[{rowIndx:t.rowIndx,rowIndxPage:t.rowIndxPage}],r=[],o=0,i=e.length;o<i;o++){var n=this.normalize(e[o]),a=n.rowData;n.oldRow=a,n.type="delete",r.push(n)}if(!r.length)return!1;this._digestData({source:t.source||"delete",history:t.history,track:t.track,rowList:r}),!1!==t.refresh&&this.refreshView()},t.addRow=function(t){var e=t.rowList||[{rowIndx:t.rowIndx,rowIndxPage:t.rowIndxPage,newRow:t.newRow||t.rowData}],r=[],o=this.options.dataModel,i=o.data;null==i&&(o.data=[],i=o.data);for(var n=0,a=e.length;n<a;n++){var l=this.normalize(e[n]);l.type="add",r.push(l)}if(!r.length)return!1;if(!1===this._digestData({source:t.source||"add",history:t.history,track:t.track,checkEditable:t.checkEditable,rowList:r}))return!1;!1!==t.refresh&&this.refreshView();t=r[0].rowIndx;return null==t?i.length-1:t}}(jQuery),function(b){var t=function(t){this.focusSelection=null};t.prototype.inViewRow=function(t){var e=this.that,r=e.options.freezeRows,o=e.finalV;return t<r||t>=e.initV&&t<=o};function e(t){t=(this.that=t).options,this.options=t,this.selection=[],this.hclass=" pq-state-select "+(t.bootstrap.on?"":"ui-state-highlight")}b.paramquery.cRows=e;var r=function(t){var e=t.options;this.that=t,this.selection=[],this.hclass="pq-state-select "+(e.bootstrap.on?"":"ui-state-highlight")},r=(b.paramquery.cCells=r).prototype=new t,t=e.prototype=new t;t.isSelected=function(t){t=t.rowData||this.that.getRowData(t);return t?!0===t.pq_rowselect:null},t.selectRange=function(t){this.that;var e=t.range,r=e.r1,o=e.r2,e=t.evt,i=[];o<r&&(t=r,r=o,o=t);for(var n=r;n<=o;n++)i.push({rowIndx:n});this.add({rows:i,evt:e})},r.removeAll=function(t){t=t||{};var e=this.that,r=e.get_p_data(),t=this.hclass;if(r&&r.length){e.$tbl&&e.$tbl.children().children().children().removeClass(t);for(var o=0,i=r.length;o<i;o++){var n=r[o];n&&delete n.pq_cellselect}}},t.removeAll=function(t){var e=this.that,r=(t=t||{}).all,o=this.hclass;if((i=e.get_p_data())&&i.length){t.refresh&&e.$tbl&&e.$tbl.children().children().removeClass(o);for(var i,n=0,a=(i=r?i:e.pdata).length;n<a;n++){var l=i[n];l&&delete l.pq_rowselect}}},r.isSelected=function(t){var e=this.that,r=t.rowData||e.getRowData(t),o=t.dataIndx,t=t.colIndx;return null==t&&null==o||null==r?null:(o=null==o?e.colModel[t].dataIndx:o,1==(r.pq_cellselect&&r.pq_cellselect[o]))},t.getSelection=function(){for(var t=this.that,e=t.selection().address(),r=[],o=0,i=e.length;o<i;o++){var n=e[o];if("row"==n.type)for(var a=n.r1,l=n.r2,s=a;s<=l;s++){var d=t.getRowData({rowIndx:s});r.push({rowIndx:s,rowData:d})}}return r},r.getSelection=function(){for(var t=this.that,e=t.selection(),r=t.colModel,o=e.address(),i=[],n=0,a=o.length;n<a;n++){var l=o[n],s=l.type;if("block"==s||"cell"==s||"column"==s)for(var s=l.r1,d=l.r2,h=l.c1,c=l.c2,u=s;u<=d;u++)for(var p=t.getRowData({rowIndx:u}),f=h;f<=c;f++)i.push({rowIndx:u,rowData:p,colIndx:f,dataIndx:r[f].dataIndx})}return i},r.inViewCell=function(t,e){var r=this.that,o=r.options.freezeCols;return!!this.inViewRow(t)&&(e<o||e>=r.initH&&e<=r.finalH)},r._add=function(t){var e=this.that,r=e.normalize(t),o=r.rowIndxPage,i=r.rowData,n=r.colIndx,a=r.dataIndx,l=this.isSelected({rowData:i,dataIndx:a});if(null==l)return!1;var s,t=e.iMerge.ismergedCell(r.rowIndx,n)||this.inViewCell(o,n);return!1===l&&(!t||(s=e.getCell({rowIndxPage:o,colIndx:n}))&&s.addClass(this.hclass),s=(i.pq_cellselect=i.pq_cellselect||{})[a]=!0),s?r:void 0},t._add=function(t){var e=this.that,r=e.normalize(t),o=r.rowIndxPage,i=r.rowData,t=this.isSelected({rowData:i});if(r.rowIndxPage=o,null==t)return!1;r=this.inViewRow(o);!1===t&&(i.pq_hidden||!r||(o=e.getRow({rowIndxPage:o})).length&&o.addClass(this.hclass),i.pq_rowselect=!0)},r.add=function(t){this.that;this._add(t)},t.add=function(t){this.that;var e=t.rows;if(e&&"function"==typeof e.push)for(var r=0,o=e.length;r<o;r++){var i=e[r];i.trigger=!1,this._add(i)}else this._add(t)},t._remove=function(t){var e=this.that,r=e.normalize(t),o=r.rowIndx,i=r.rowIndxPage,n=r.rowData,t=r.$tr,r=(r.evt,this.isSelected({rowData:n}));if(r)return this.inViewRow(i)&&(t=e.getRow({rowIndxPage:i}))&&(t.removeClass(this.hclass),t.removeAttr("tabindex")),n.pq_rowselect=!1,{rowIndx:o,rowData:n}},t.remove=function(t){var e=t.rows;if(e&&"function"==typeof e.push)for(var r=0,o=e.length;r<o;r++){var i=e[r];i.trigger=!1,this._remove(i)}else this._remove(t)},r.selectBlock=function(t){for(var e=this.that,r=this.hclass,o=t.range,i=o.r1,n=o.c1,a=o.r2,l=o.c2,s=e.initH,d=e.finalH,h=e.options.freezeCols,c=[],u=e.colModel,p=[],f=!!t.remove,g=n;g<=l;g++)c[g]=u[g].dataIndx;for(var v=i;v<=a;v++){var w=e.normalize({rowIndx:v}),m=w.rowData,x=w.rowIndxPage;if(m){var _=m.pq_cellselect=m.pq_cellselect||{};if(this.inViewRow(x))for(g=n;g<=l;g++){var I,y=c[g];(f&&_[y]||!f&&!_[y])&&(!(g<h||s<=g&&g<=d)||(I=e.getCell({rowIndxPage:x,colIndx:g})).length&&p.push(I[0]),_[y]=!f||void 0)}else for(g=n;g<=l;g++)_[y=c[g]]=!f||void 0}}p.length&&b(p)[f?"removeClass":"addClass"](r)}}(jQuery),function(m){var n=!0;m(function(){var t=m("<input type='checkbox' style='position:fixed;left:-50px;top:-50px;'/>").appendTo(document.body);t[0].indeterminate=!0,t.on("change",function(){n=!1}),t.click(),t.remove()});var t=(m.paramquery.cCheckBoxColumn=function(t,r){var o=this;this.that=t,this.options=t.options;(this.column=r).cb=m.extend({},{all:!1,header:!1,select:!1,check:!0,uncheck:!1},r.cb),r._render=function(t){var e=t.rowData;if(!e.pq_gtitle&&!e.pq_gsummary)return"<input type='checkbox' "+(r.cb.check===t.cellData?"checked":"")+" />"},this.dataIndx=r.dataIndx;var e=t.element,i=t.eventNamespace;t.on("dataAvailable",function(){t.one("dataReady",function(){return o._onDataReady()})}).on("dataReady",function(){o.setValCBox()}),e.on("change"+i,function(t){var e=t.target;if("checkbox"==e.type&&m(e).closest(".pq-grid")[0]==this)return o.onCheckBoxChange(t)}),t.on("cellKeyDown",function(t,e){return o.onCellKeyDown(t,e)}),t.on("refreshHeader",function(t,e){return o.refreshHeader(t,e)})}).prototype=new m.paramquery.cClass;t.hasHeaderChkBox=function(){return this.column.cb.header},t.setValCBox=function(){if(this.hasHeaderChkBox()){var t=this.that,e=this.options,r=this.dataIndx,o=this.column.cb,i=o.all,n="remote"==e.pageModel.type,a=t.rowIndxOffset,a=n||!i?a:0,l=i?e.dataModel.data:t.pdata,e=null,s=0,d=0;if(l){for(var h=0,c=0,u=l.length;c<u;c++){var p=l[c],f=c+a;t.isEditableRow({rowIndx:f})&&t.isEditableCell({rowIndx:f,dataIndx:r})&&(h++,p[r]===o.check?s++:d++)}s==h&&h?e=!0:d==h&&(e=!1),this.$inp&&this.$inp.pqval({val:e})}}},t.onHeaderChange=function(t){for(var e=m(t.target),r=this.that,o=this.column,i=o.dataIndx,n=r.options,a=o.cb,l=a.all,s=l?n.dataModel.data:r.pdata,n="remote"==n.pageModel.type,d=r.rowIndxOffset,d=n||!l?d:0,h=[],o={column:o,dataIndx:i,source:"header"},c=e[0].checked,u=0,p=s.length;u<p;u++){var f=u+d,g=s[u],v={},w={};v[i]=c?a.check:a.uncheck,w[i]=g[i],h.push({rowIndx:f,rowData:g,newRow:v,oldRow:w,type:"update"})}e={rowList:h,source:"checkbox"};return e.history=e.track=!a.select&&null,o.check=c,o.rows=h,!1===r._trigger("beforeCheck",t,o)||!1===r._digestData(e)?(r.refreshHeader(),!1):(r.refresh({header:!1}),h=o.rows=e.rowList,r._trigger("check",t,o),void(a.select&&r.selection({type:"row",method:c?"add":"remove",rows:h})))},t.refreshHeader=function(t,e){var r,o,i=this;this.hasHeaderChkBox()&&(!(r=this.that).pdata||(r=r.getCellHeader({dataIndx:this.dataIndx}))&&(o=this.$inp=r.find("input"),this.setValCBox(),n&&o.on("click",function(t){null==o.data("pq_value")&&(o[0].checked=!0,o.data("pq_value",!0),i.onHeaderChange(t))}),o.on("change",function(t){i.onHeaderChange(t)})))},t._onDataReady=function(){var t=this.that,e=this.options,r=e.dataModel.data,o="remote"==e.pageModel.type?t.rowIndxOffset:0,e=this.column,i=e.cb,n=e.dataIndx;if(null!=n&&r){for(var a=[],l=0,s=r.length;l<s;l++)(d=r[l])[n]===i.check&&a.push({rowIndx:l+o,rowData:d});if(!1!==t._trigger("check",null,{rows:a,column:e,dataIndx:n,source:"dataAvailable"})&&i.select){for(var d,l=0;l<s;l++)(d=r[l])[n]===i.check&&(d.pq_rowselect=!0);t.selection().refresh()}}this.setValCBox()},t.rowSelect=function(t,e){var r=this.that,o=e.rows,i=e.rowData,n=this.dataIndx;if(o)for(var a=0,l=o.length;a<l;a++){var s=o[a],d=s.rowIndx;(i=s.rowData)[n]=!0,r.refreshCell({rowIndx:d,dataIndx:n})}else i&&(i[n]=!0,d=e.rowIndx,r.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},t.rowUnSelect=function(t,e){var r=this.that,o=e.rows,i=e.rowData,n=this.dataIndx;if(o)for(var a=0,l=o.length;a<l;a++){var s=o[a],d=s.rowIndx;(i=s.rowData)[n]=!1,r.refreshCell({rowIndx:d,dataIndx:n})}else i&&(i[n]=!1,d=e.rowIndx,r.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},t.onCheckBoxChange=function(t){var e=this.that,r=this.column.cb,o=m(t.target),i=o.closest(".pq-grid-cell");if(i.length){var n=e.getCellIndices({$td:i}),a=(n=e.normalize(n)).rowData,l=n.rowIndx,s=n.dataIndx;if(s==this.dataIndx){var d=o[0].checked,i={},o={};i[s]=d?r.check:r.uncheck,o[s]=a[s];o=[{rowData:a,rowIndx:l,oldRow:o,newRow:i,type:"update"}];if(n.check=d,n.rows=o,!1===e._trigger("beforeCheck",t,n))return e.refreshCell({rowIndx:l,dataIndx:s}),!1;i={source:"checkbox",rowList:o};if(i.history=i.track=!r.select&&null,!1===e._digestData(i))return e.refreshCell({rowIndx:l,dataIndx:s}),!1;e.refreshRow({rowIndx:l}),o=n.rows=i.rowList,e._trigger("check",t,n),r.select&&e.selection({type:"row",method:d?"add":"remove",rows:o}),this.setValCBox()}}},t.onCellKeyDown=function(t,e){if(e.dataIndx==this.dataIndx&&(13==t.keyCode||32==t.keyCode))return m(t.originalEvent.target).find("input").click(),!1}}(jQuery),function(){for(var r=0,t=["moz","webkit"],e=0;!window.requestAnimationFrame&&e<t.length;e++)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),e=Math.max(0,16-(e-r));return window.setTimeout(function(){r=(new Date).getTime(),t()},e)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(d){function t(r){this.that=r;var o=this;this.scrollTop=0,this.scrollLeft=0,this.borderRight=0,this.borderRightExtra=0,this.borderTop=0,this.borderTopExtra=0,this.borderLeft=0,this.borderLeftExtra=0,this.borderBottom=0,this.borderBottomExtra=0,this.maxBorder=5e3,this.rowht=r.options.rowHeight,this.colwd=60,r.on("contMouseDown",function(t,e){return o._onContMouseDown(t,e)}).on("mouseDrag",function(t,e){return o._onMouseDrag(t,e)}).on("mouseStop",function(t,e){return o._onMouseStop(t,e)}).on("mousePQUp",function(t,e){return o._onMousePQUp(t,e)}).on("rowMouseDown",function(t,e){return o._onRowMouseDown(t,e)}).on("cellMouseDown",function(t,e){return o._onCellMouseDown(t,e)}).on("refresh",function(t,e){setTimeout(function(){r.element&&r.focus()},0)}).on("cellMouseEnter",function(t,e){return o._onCellMouseEnter(t,e)}).on("rowMouseEnter",function(t,e){return o._onRowMouseEnter(t,e)})}var e=(d.paramquery.cMouseSelection=t).prototype=new d.paramquery.cClass;e.inViewPort=function(t){var e=this.that.iRefresh,r=e.getEContHt(),o=e.getEContWd()+1,i=t[0],e=this.marginTop,t=this.scrollLeft;if(r>=i.offsetTop+i.offsetHeight+e)return"TD"!=i.nodeName.toUpperCase()||(o>=i.offsetLeft+i.offsetWidth+t||void 0)},e._onCellMouseDown=function(t,e){var r=this.that,o=e.rowIndx,i=(e.rowIndxPage,r.iSelection),n=e.colIndx,a=r.options.selectionModel,l=a.type,a=a.mode;if("cell"==l){if(null!=n){i=i.address()[0];return t.shiftKey&&"single"!=a&&i?(a=i.firstR,i=i.firstC,r.range({r1:a,c1:i,r2:o,c2:n,firstR:a,firstC:i}).select()):(this.mousedown={r1:o,c1:n},r.range({r1:o,c1:n,firstR:o,firstC:n}).select()),r.focus(e),!0}}else r.focus(e)},e._onCellMouseEnter=function(t,e){var r=this.that,o=r.options.selectionModel,i=o.type,n=o.mode;if(this.mousedown&&"single"!=n){if("cell"==i){var a=this.mousedown,l=a.r1,o=a.c1,n=e.rowIndx,i=e.colIndx;if(l==n&&o==i)return;if(a.r2==n&&a.c2==i)return;this.mousedown.r2=n,this.mousedown.c2=i,r.scrollCell({rowIndx:n,colIndx:i}),r.range({r1:l,c1:o,r2:n,c2:i,firstR:l,firstC:o}).select()}r.focus(e)}},e._onRowMouseEnter=function(t,e){var r=this.that,o=r.options.selectionModel,i=o.type,o=o.mode;"row"==i&&this.mousedown&&"single"!=o&&((o=this.mousedown.r1)!=(e=e.rowIndx)?this.mousedown.r2!=e&&(this.mousedown.r2=e,r.scrollRow({rowIndx:e}),r.range({r1:o,r2:e,firstR:o},!1).select()):r.range({r1:o,firstR:o},!1).select())},e._onRowMouseDown=function(t,e){var r=this.that,o=e.rowIndx,i=r.iSelection,n=r.options.selectionModel,a=d(t.originalEvent.target).hasClass("pq-grid-number-cell"),l=n.mode,s=n.type;if(("row"==s||n.row&&a)&&null!=o){s=r.iSelection.address();return t.shiftKey&&"single"!=l?((n=s.length)&&"row"==s[n-1].type&&((n=s[n-1]).r1=n.firstR,n.r2=o,n.c1=n.c2=n.type=void 0),r.range(s).select()):(t.ctrlKey||t.metaKey)&&"single"!=l?i[r.iRows.isSelected({rowIndx:o})?"removeRow":"add"]({r1:o,firstR:o}):(this.mousedown={r1:o,y1:t.pageY,x1:t.pageX},r.range({r1:o,firstR:o},!1).select()),a&&setTimeout(function(){r.focus({rowIndxPage:e.rowIndxPage,colIndx:r.getFirstVisibleCI(!0)})},0),!0}},e._onContMouseDown=function(t,e){return this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown={x:t.pageX,y:t.pageY}),!0},e._onMousePQUp=function(t,e){this.that;this.mousedown=null},e._stopSwipe=function(t){t&&(this.swipedown=null,this.swipedownPrev=null),window.clearInterval(this.intID),window.cancelAnimationFrame(this.intID),this.intID=null},e._onMouseStop=function(t,e){var r,o,i,n,a,l,s,d,h,c,u=this,p=this.that;this.swipedownPrev&&(r=p.options.swipeModel,p=(i=this.swipedownPrev).ts,o=(new Date).getTime()-p,p=i.x,i=i.y,n=t.pageX,a=t.pageY,l=n-p,s=a-i,Math.sqrt(l*l+s*s)/o>r.ratio?(d=0,h=r.repeat,u._stopSwipe(),(c=function(){d+=r.speed,h--;var t=n+d*l/o,e=a+d*s/o;u._onMouseDrag({pageX:t,pageY:e}),0<h?u.intID=window.requestAnimationFrame(c):u._stopSwipe(!0)})()):(u.swipedown=null,u.swipedownPrev=null))},e._onMouseDrag=function(t,e){var r,o,i,n,a,l=this.that.options;return this.swipedown&&(o=(r=this.swipedown).x,i=r.y,n=t.pageX,a=t.pageY,this.swipedownPrev={x:o,y:i,ts:(new Date).getTime()},t=l.scrollModel.smooth,l.virtualY&&!t||(this.scrollVertSmooth(i,a),this.syncScrollBarVert()),l.virtualX&&!t||(this.scrollHorSmooth(o,n),this.syncScrollBarHor()),r.x=n,r.y=a),!0},e.updateTableY=function(t){if(0==t)return!1;var e=this.that,r=this.getTableForVertScroll(),o=e.iRefresh.getEContHt();if(!r||!r.length)return!1;var i=r.data("offsetHeight")-1,e=this.scrollTop-t,e=e<0?0:t<0&&0<o-i+e?i-o:e;return this.setScrollTop(e,r,o),!0},e.setScrollTop=function(t,e,r){0<=t&&(t=Math.round(t),this.scrollTop=t,e.parent("div").scrollTop(t))},e.getScrollLeft=function(t){return this.scrollLeft},e.getScrollTop=function(t){return this.scrollTop},e.setScrollLeft=function(t,e,r,o){0<=t&&(t=Math.round(t),this.scrollLeft=t,(r?r.parent():d()).add(e?e.parent("div"):d()).scrollLeft(t))},e.scrollVertSmooth=function(t,e){t!=e&&this.updateTableY(e-t)},e.scrollHorSmooth=function(t,e){var r,o,i,n;t!=e&&(r=(i=this.that).options,n=e-t,o=this.getTableForHorScroll(),e=this.getTableHeaderForHorScroll(),t=i.iRefresh.getEContWd(),(o||e)&&(i=o||e,i=r.virtualX?this.getScrollWidth(i):i.data("scrollWidth"),n=this.scrollLeft-n,this.setScrollLeft(n<0?0:i-t-n<0?i-t:n,o,e,t)))},e.syncViewWithScrollBarVert=function(t){var e,r;null!=t&&(r=this.that,(e=this.getTableForVertScroll())&&e.length&&(r.options.editModel.indices&&r.blurEditor({force:!0}),!(t=(e.data("offsetHeight")-(r=r.iRefresh.getEContHt()))*t)&&0!==t||this.setScrollTop(t=t<0?0:t,e,r)))},e.syncViewWithScrollBarHor=function(t){var e,r,o,i,n;null!=t&&(n=this.that,e=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll(),(e||r)&&((o=n.options).editModel.indices&&n.blurEditor({force:!0}),i=e||r,t=((i=o.virtualX?this.getScrollWidth(i):i.data("scrollWidth"))-(n=n.iRefresh.getEContWd()))*t,i&&n&&this.setScrollLeft(t=t<0?0:t,e,r,n)))},e.resetMargins=function(){this.scrollLeft=0,this.scrollTop=0},e.syncHeaderViewWithScrollBarHor=function(t){var e,r,o,i,n;null!=t&&(e=this.that,(r=this.getTableHeaderForHorScroll())&&(n=(i=e.options).freezeCols,i.editModel.indices&&e.blurEditor({force:!0}),o=r.data("scrollWidth"),i=e.iRefresh.getEContWd(),n=e.calcWidthCols(n,t+n),o&&i&&r.css("marginLeft",-(n=n<0?0:n))))},e.syncScrollBarVert=function(){var t,e=this.that,r=this.getTableForVertScroll();r&&r.length&&(t=r.data("offsetHeight"),r=e.iRefresh.getEContHt(),0<=(r=this.scrollTop/(t-r))&&r<=1&&e.vscroll.widget().hasClass("pq-sb-vert")&&e.vscroll.option("ratio",r))},e.syncScrollBarHor=function(){var t=this.that,e=t.options,r=this.getTableForHorScroll(),o=this.getTableHeaderForHorScroll();(r||o)&&(o=r||o,e=e.virtualX?this.getScrollWidth(o):o.data("scrollWidth"),o=t.iRefresh.getEContWd(),0<=(o=this.scrollLeft/(e-o))&&o<=1&&t.hscroll.widget().hasClass("pq-sb-horiz")&&t.hscroll.option("ratio",o))},e.getTableForVertScroll=function(){var t=this.that,e=t.pqpanes,t=t.$tbl;if(t&&t.length)return e.h&&e.v?t=d([t[2],t[3]]):e.v?t=d([t[0],t[1]]):e.h&&(t=d(t[1])),t},e.getTableForHorScroll=function(){var t=this.that,e=t.pqpanes,r=[],o=t.$tbl;if(o&&o.length)return e.h&&e.v?r.push(o[1],o[3]):e.v?r.push(o[1]):e.h?r.push(o[0],o[1]):r.push(o[0]),t.tables.length&&(t=t.tables[0].$tbl,e.v?r.push(t[1]):r.push(t[0])),d(r)},e.getTableHeaderForHorScroll=function(){var t=this.that,e=t.pqpanes,t=t.$tbl_header;if(t&&t.length)return(t=e.vH?d(t[1]):d(t[0])).parent()},e.scrollRowNonVirtual=function(t){var e,r=this.that,o=r.options,i=t.rowIndxPage,n=(r.iHierarchy,t.rowIndx),a=r.iRefresh.getEContHt();(i=null==i?n-r.rowIndxOffset:i)<parseInt(o.freezeRows)||(t=r.get$Tbl(i),(n=r.getRow({rowIndxPage:i})[0])&&(o=t[0].offsetTop+1,r=n.offsetHeight,i=this.getScrollTop(),o+(n=n.offsetTop-1)-i<0?(this.setScrollTop(e=(e=o+n+-1)<0?0:e,t,a),this.syncScrollBarVert()):a<n+r-i&&(this.setScrollTop(e=r+n-a,t,a),this.syncScrollBarVert())))},e.scrollColumnNonVirtual=function(t){var e,r,o,i=this.that,n=null==(n=t.colIndx)?i.getColIndx({dataIndx:t.dataIndx}):n,a=i.options.freezeCols;n<a||(e=i._calcRightEdgeCol(n).width,r=i._calcRightEdgeCol(n-1).width,o=i._calcRightEdgeCol(a-1).width,t=this.getTableForHorScroll(),n=this.getTableHeaderForHorScroll(),(a=i.iRefresh.getEContWd())<e-(i=this.scrollLeft)?(this.setScrollLeft(e-a,t,n,a),this.syncScrollBarHor()):r-o<i&&(this.setScrollLeft(r-o,t,n,a),this.syncScrollBarHor()))}}(jQuery),function(F){var n=null,a=!1,l="pq-grid-excel",O="",t=F.paramquery.pqGrid.prototype,e=t.options;e.pasteModel=e.pasteModel||{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"},e.copyModel=e.copyModel||{on:!0,header:!0,zIndex:1e4},e.cutModel=e.cutModel||{on:!0},t._setGlobalStr=function(t){O=t},t.canPaste=function(){return!!O},t.copy=function(){(n=new s(this)).copy(),n=null},t.paste=function(t){(n=new s(this)).paste(t),n=null},t.cut=function(){(n=new s(this)).copy({cut:!0,source:"cut"}),n=null},t.clear=function(){this.iSelection.clear()};var s=function(t,e){this.that=t},t=s.prototype;t.createClipBoard=function(){F("#pq-grid-excel-div");var t,e=this.that.options.copyModel,r=F("#"+l);0==r.length&&(t=F("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+e.zIndex+";'/>").appendTo(document.body),(r=F("<textarea id='"+l+"' autocomplete='off' spellcheck='false' style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(t)).css({opacity:0})),r.on("focusin",function(t){t.stopPropagation()}),r.select()},t.destroyClipBoard=function(){this.clearClipBoard();var t=this.that,e=F(window).scrollTop(),r=F(window).scrollLeft();t.focus();var o=F(window).scrollTop(),t=F(window).scrollLeft();e==o&&r==t||window.scrollTo(r,e)},t.clearClipBoard=function(){F("#"+l).val("")},t.copy=function(t){return this.that.iSelection.copy(t)},t.paste=function(t){var e=this.that,r=(t=t||{}).dest,o=t.clip,i=o?o.length?o.val():"":O,n=(i=i.replace(/\n$/,"")).split("\n"),a=n.length,l=e.colModel,o=e.options,s=e.readCell,o=o.pasteModel,d="row",h=!1,c=l.length;if(o.on&&0!=i.length&&0!=a){i={rows:n};if(!1===e._trigger("beforePaste",null,i))return!1;var u,p,f,g,v,w=o.type,r=(r?e.range(r):e.selection())._areas,r=r.length?r[0]:null,m=r&&e.getRowData({rowIndx:r.r1})?(d="row"==r.type?"row":"cell",u=r.r1,f=r.r2,p=r.c1,r.c2):(d="cell",p=f=u=0);"replace"==w?v=f-(g=u)+1<a?"extend":"repeat":"append"==w?(g=f+1,v="extend"):"prepend"==w&&(g=u,v="extend");for(var x,_,I="extend"==v?a:f-u+1,y=0,b=t.rowList||[],C=0,q=0;q<I;q++){var M=n[y],D=q+g,R="replace"==w?e.getRowData({rowIndx:D}):null,P=R?{}:null,T={};void 0===M&&"repeat"===v&&(M=n[y=0]),y++;var S=M.split("\t");if(!_)if("cell"==d){if(k=S.length,_="extend"==(x=m-p+1<S.length?"extend":"repeat")?k:m-p+1,isNaN(_))throw"lenH NaN. assert failed.";c<_+p&&(_=c-p)}else _=c,p=0;for(var k,H=0,E=0,$=0,V=_,z=S.length,E=0;E<V;E++){z<=H&&(H=0);var W=l[E+p],L=S[H],A=W.dataIndx;!1!==W.copy?(H++,T[A]=L,P&&(P[A]=s(R,W))):($++,"extend"==x&&V+p<c&&V++)}0==F.isEmptyObject(T)&&(k="update",null==R&&(h=!0,k="add"),b.push({newRow:T,rowIndx:D,rowData:R,oldRow:P,type:k}),C++)}t={rowList:b,source:"paste",allowInvalid:o.allowInvalid,validate:o.validate};e._digestData(t),e[h?"refreshView":"refresh"](),o.select&&("cell"==d?e.range({r1:g,c1:p,r2:g+C-1,c2:"extend"==x?p+_-1+$:m}):e.range({r1:g,r2:g+C-1})).select(),e._trigger("paste",null,i)}},F(document).unbind(".pqExcel").bind("keydown.pqExcel",function(t){if(t.ctrlKey||t.metaKey){if((o=F(t.target)).hasClass("pq-grid-row")||o.hasClass("pq-grid-cell")||o.is("#"+l)||o.hasClass("pq-grid-cont")){var e=o.closest(".pq-grid");if(n||o.length&&e.length){if(!n){try{var r=e.pqGrid("getInstance").grid;if(r.option("selectionModel.native"))return!0}catch(t){return!0}(n=new s(r,o)).createClipBoard()}"67"==t.keyCode||"99"==t.keyCode?n.copy({clip:F("#"+l)}):"88"==t.keyCode?n.copy({cut:!0,clip:F("#"+l)}):"86"==t.keyCode||"118"==t.keyCode?(a=!0,n.clearClipBoard(),window.setTimeout(function(){n&&(n.paste({clip:F("#"+l)}),n.destroyClipBoard(),n=null),a=!1},0)):(i=F("#"+l)).length&&document.activeElement==i[0]&&n.that._onKeyPressDown(t)}}}else{var o,r=t.keyCode,i=F.ui.keyCode;if(r==i.UP||r==i.DOWN||r==i.LEFT||r==i.RIGHT||r==i.PAGE_UP||r==i.PAGE_DOWN){if(d)return!1;((o=F(t.target)).hasClass("pq-grid-row")||o.hasClass("pq-grid-cell"))&&(d=!0)}}}).bind("keyup.pqExcel",function(t){var e=t.keyCode;a||!n||t.ctrlKey||t.metaKey||-1==F.inArray(e,[17,91,93,224])||(n.destroyClipBoard(),n=null),d&&((t=F(t.target)).hasClass("pq-grid-row")||t.hasClass("pq-grid-cell")||(d=!1))});var d=!1}(jQuery),function(a){var t=a.paramquery.pqGrid.prototype.options;t.historyModel=t.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};t=(a.paramquery.cHistory=function(t){var r=this;this.that=t,this.options=t.options,this.records=[],this.counter=0,this.id=0,t.on("keyDown",function(t,e){return r._onKeyDown(t,e)}).on("dataAvailable",function(t,e){"filter"!=e.source&&r.reset()})}).prototype=new a.paramquery.cClass;t._onKeyDown=function(t,e){var r="90",o="89",i=t.ctrlKey||t.metaKey;return i&&t.keyCode==r?(this.undo(),!1):i&&t.keyCode==o?(this.redo(),!1):void 0},t.resetUndo=function(){if(0==this.counter)return!1;this.counter=0,this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})},t.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[],this.counter=0,this.id=0,this.that._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})},t.increment=function(){var t=this.records,e=t.length;e?(e=t[e-1].id,this.id=e+1):this.id=0},t.push=function(t){var e=this.canRedo(),r=this.records,o=this.counter;r.length>o&&r.splice(o,r.length-o),r[o]=a.extend({id:this.id},t),this.counter++;var i,n,t=this.that;1==this.counter&&(i=!0),e&&this.counter==r.length&&(n=!1),t._trigger("history",null,{type:"add",canUndo:i,canRedo:n,num_undo:this.counter,num_redo:0})},t.canUndo=function(){return 0<this.counter},t.canRedo=function(){return this.counter<this.records.length},t.processCol=function(t,e){var r,o=this.that;t.length&&(r="add"==t.type,o[(r=e?r:!r)?"addColumn":"deleteColumn"]({colList:t,history:!1}))},t.undo=function(){var t=this.canRedo(),e=this.that,r=!1,o=this.options.historyModel,i=this.records;if(!(0<this.counter))return!1;this.counter--;for(var n,a,l=i[this.counter],s=(s=l.rowList)||[],i=(i=l.colList)||[],d=[],h=(l.id,0),c=s.length;h<c;h++){var u=s[h],p=u.newRow,f=u.rowData,g=u.type,v=u.oldRow,u=u.rowIndx;"update"==g?(u=e.getRowIndx({rowData:f}).rowIndx,d.push({type:g,rowIndx:u,rowData:f,oldRow:p,newRow:v})):"add"==g?(r=!0,d.push({type:"delete",rowData:p})):"delete"==g&&(r=!0,d.push({type:"add",rowIndx:u,newRow:f}))}return i.length?this.processCol(i):(e._digestData({history:!1,source:"undo",checkEditable:o.checkEditable,checkEditableAdd:o.checkEditableAdd,allowInvalid:o.allowInvalid,rowList:d}),e[r?"refreshView":"refresh"]({source:"undo"})),0==this.counter&&(a=!1),e._trigger("history",null,{canUndo:a,canRedo:n=!1===t?!0:n,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},t.redo=function(){var t=this.canUndo(),e=this.that,r=this.options.historyModel,o=this.counter,i=this.records;if(o==i.length)return!1;for(var n,a,l=!1,s=i[o],d=(d=s.rowList)||[],o=(o=s.colList)||[],h=[],c=(s.id,0),u=d.length;c<u;c++){var p=d[c],f=p.newRow,g=p.rowData,v=p.type,w=p.oldRow,p=p.rowIndx;"update"==v?(p=e.getRowIndx({rowData:g}).rowIndx,h.push({type:v,rowIndx:p,rowData:g,oldRow:w,newRow:f})):"add"==v?(l=!0,h.push({type:"add",rowIndx:p,newRow:f})):"delete"==v&&(l=!0,h.push({type:"delete",rowData:g}))}return o.length?this.processCol(o,!0):(e._digestData({history:!1,source:"redo",checkEditable:r.checkEditable,checkEditableAdd:r.checkEditableAdd,allowInvalid:r.allowInvalid,rowList:h}),e[l?"refreshView":"refresh"]({source:"redo"})),this.counter<i.length&&this.counter++,this.counter==this.records.length&&(a=!1),e._trigger("history",null,{canUndo:n=0==t?!0:n,canRedo:a,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},a.paramquery.pqGrid.prototype.history=function(t){var e=t.method;return this.iHistory[e](t)}}(jQuery),function(b){var o,C=b.paramquery;C.filter={conditions:o={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}},getAllConditions:function(){var t,e=[];for(t in o)e.push(t);return e}(),getConditions:function(t){var e,r=[];for(e in o)o[e][t]&&r.push(e);return r},getTRConditions:function(){var t,e=[];for(t in o)o[t].TR&&e.push(t);return e}(),getWTRConditions:function(){var t,e=[];for(t in o)o[t].TR||e.push(t);return e}()},C.filter.rules={},C.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"};function l(e){(this.that=e).on("load",function(){var t=e.options.dataModel.dataUF;t&&(t.length=0)})}var t=(C.cFilterData=l).prototype;l.conditions={equal:function(t,e){if(t==e)return!0},contain:function(t,e){if(-1!=t.indexOf(e))return!0},notcontain:function(t,e){if(-1==t.indexOf(e))return!0},empty:function(t){if(0==t.length)return!0},notempty:function(t){if(0<t.length)return!0},begin:function(t,e){if(0==(t+"").indexOf(e))return!0},notbegin:function(t,e){if(0!=t.indexOf(e))return!0},end:function(t,e){var r=t.lastIndexOf(e);if(-1!=r&&r+e.length==t.length)return!0},notend:function(t,e){var r=t.lastIndexOf(e);if(-1==r||r+e.length!=t.length)return!0},regexp:function(t,e){if(e.test(t))return!(e.lastIndex=0)},notequal:function(t,e){if(t!=e)return!0},great:function(t,e){if(e<t)return!0},gte:function(t,e){if(e<=t)return!0},between:function(t,e,r){if(e<=t&&t<=r)return!0},range:function(t,e){if(-1!=b.inArray(t,e))return!0},less:function(t,e){if(t<e)return!0},lte:function(t,e){if(t<=e)return!0}},l.convert=function(t,e){return t=null==t?"":t,"string"==e?t=b.trim(t).toUpperCase():"date"==e?t=Date.parse(t):"integer"==e?t=parseInt(t):"float"==e?t=parseFloat(t):"bool"==e&&(t=String(t).toLowerCase()),t},t.isMatchCellSingle=function(t,e){var r=t.dataIndx,o=t.dataType,i=t.value,n=t.value2,a=t.condition,t=t.cbFn,r=e[r];return!!t(r="regexp"==a?null==r?"":r:l.convert(r,o),i,n)},t.isMatchRow=function(t,e,r){if(0==e.length)return!0;for(var o=0;o<e.length;o++){var i=e[o],i=this.isMatchCell(i,t);if("OR"==r&&i)return!0;if("AND"==r&&!i)return!1}return"AND"==r||"OR"!=r&&void 0},t.getQueryStringFilter=function(){var t=this.that,e=t.options,r=e.stringify,o=e.filterModel,i=o.mode,e=t.colModel,t=this.getFilterData({CM:e,location:"remote"}),e="";return e=o&&o.on&&t?t.length?!(t={mode:i,data:t})===r?t:JSON.stringify(t):"":e},t.filterLocalData=function(t){var e=this.that,r=(t=t||{}).apply,o=(r=null==r||r)?e.colModel:t.CM,i=this.getFilterData({CM:o}),n=e.options,a=n.dataModel,t=e.iSort,l=a.data,s=[],d=[],h=a.dataUF,o=n.filterModel,n=o.multiple,c=o?o.mode:null,l=l||(a.data=[]),h=h||(a.dataUF=[]);if(!1===r&&(l=l.slice()),h.length){for(var u=0,p=h.length;u<p;u++)l.push(h[u]);0==t.readSorter().length&&t.sortLocalData(l),h=a.dataUF=[]}else{if(!i.length)return{data:l,dataUF:h};t.saveOrder()}if(this.isMatchCell=n?this.isMatchCellMultiple:this.isMatchCellSingle,o.on&&c&&i&&i.length){if(l.length)for(u=0,p=l.length;u<p;u++){var f=l[u];(this.isMatchRow(f,i,c)?s:d).push(f)}l=s,h=d,r&&(a.data=l,a.dataUF=h)}return r&&(e._queueATriggers.filter={ui:{type:"local",filter:i}}),{data:l,dataUF:h}},t.getFilterData=function(t){var e=t.CM;if(!e)throw"CM N/A";function r(t,e){return"remote"==s?(t=null==t?"":t).toString():u.convert(t,e)}for(var o,i,n,a=this.that,l=e.length,s=t.location,d=(a.options.filterModel.multiple,C.filter.getAllConditions),h=C.filter.getTRConditions,c=[],u=C.cFilterData,p=0;p<l;p++){var f=e[p],g=f.filter;if(g&&g.on){var v=f.dataIndx,w=(w=f.dataType)&&"stringi"!=w&&"function"!=typeof w?w:"string",m=g.value,f=g.value2,x=g.condition;if(i=m,n=f,"function"==typeof(o=x)||("between"==o?null!=i&&""!==i||null!=n&&""!==n:-1==b.inArray(o,d)||(null!=i&&""!==i||-1==b.inArray(o,h)))){if("between"==x)""===m||null==m?(x="lte",m=r(f,w)):""===f||null==f?(x="gte",m=r(m,w)):(m=r(m,w),f=r(f,w));else if("regexp"==x){if("remote"==s)m=m.toString();else if("string"==typeof m)try{var _=(_=g.modifiers)||"gi",m=new RegExp(m,_)}catch(t){m=/.*/}}else if("range"==x){if(null==m)continue;if("string"==typeof m)m=(m=r(m,w)).split(/\s*,\s*/);else if(m&&"function"==typeof m.push){if(0==m.length)continue;for(var I=0,y=(m=m.slice()).length;I<y;I++)m[I]=r(m[I],w)}}else m=r(m,w);g="remote"==s?"":"function"==typeof x?x:u.conditions[x];c.push({dataIndx:v,value:m,value2:f,condition:x,dataType:w,cbFn:g})}}}return c}}(jQuery),function(){var t=jQuery.paramquery,e=t.cSort=function(t){this.that=t,this.sorters=[],this.tmpPrefix="pq_tmp_",this.cancel=!1};t.pqGrid.prototype.sort=function(t){t=t||{};var e,r,o,i,n,a=this,l=this.options,s=l.dataModel,d=s.data,h=l.sortModel.type;(d&&d.length||"local"!=h)&&(e=l.editModel,n=(r=this.iSort).getSorter(),o=t.evt,i=null==t.single?r.readSingle():t.single,l=r.readCancel(),((l=t.sorter?t.addon?(t.single=i,t.cancel=l,r.addon(t)):t.sorter:r.readSorter()).length||n.length)&&(e.indices&&a.blurEditor({force:!0}),!(n={dataIndx:l.length?l[0].dataIndx:null,oldSorter:n,sorter:l,source:t.source,single:i})!==a._trigger("beforeSort",o,n)?(r.resumeSort(),"local"==h&&r.saveOrder(),r.setSorter(l),r.setSingle(i),r.writeSorter(l),r.writeSingle(i),"local"==h?(s.data=r.sortLocalData(d),!(this._queueATriggers.sort={evt:o,ui:n})!==t.refresh&&this.refreshView()):"remote"==h&&(this._queueATriggers.sort={evt:o,ui:n},t.initByRemote||this.remoteRequest({initBySort:!0,callback:function(){a._onDataAvailable()}}))):r.cancelSort()))};e=e.prototype;e.cancelSort=function(){this.cancel=!0},e.resumeSort=function(){this.cancel=!1},e.readSorter=function(){var t,e=this.that,r=e.options,o=e.columns,e=[],i=r.sortModel.sorter;if(i&&(t=i.length)){for(;t--;)null==o[i[t].dataIndx]&&i.splice(t,1);e=e.concat(i)}return e=pq.arrayUnique(e,"dataIndx")},e.setSingle=function(t){this.single=t},e.getSingle=function(){return this.single},e.readSingle=function(){return this.that.options.sortModel.single},e.writeSingle=function(t){this.that.options.sortModel.single=t},e.setCancel=function(t){this.cancel=t},e.getCancel=function(){return this.cancel},e.readCancel=function(){return this.that.options.sortModel.cancel},e.writeCancel=function(t){this.that.options.sortModel.cancel=t},e.writeSorter=function(t){this.that.options.sortModel.sorter=t},e.addon=function(t){var e,r,o=(t=t||{}).sorter,i=o[0].dataIndx,n=o[0].dir,a=t.single,l=t.cancel,o=this.readSorter();if(null==a)throw"sort single N/A";return null!=i&&(a&&!t.tempMultiple?(o=o.length?[o[0]]:[])[0]&&o[0].dataIndx==i?""===(r="up"===(e=o[0].dir)?"down":l&&"down"===e?"":"up")?o.length--:o[0].dir=r:o[0]={dataIndx:i,dir:r=n||"up"}:-1<(r=this.inSorters(o,i))?"up"==(e=o[r].dir)?o[r].dir="down":(!l||"down"!=e)&&1==o.length?o[r].dir="up":o.splice(r,1):o.push({dataIndx:i,dir:"up"})),o},e.saveOrder=function(t){var e=this.that.options.dataModel,t=e.data;if(t&&t.length&&!(e.dataUF&&e.dataUF.length||this.getSorter().length&&null!=t[0].pq_order))for(var r=0,o=t.length;r<o;r++)t[r].pq_order=r},e.getQueryStringSort=function(){if(this.cancel)return"";var t=this.that,e=this.sorters,t=t.options.stringify;return e.length?!1===t?e:JSON.stringify(e):""},e.getSorter=function(){return this.sorters},e.setSorter=function(t){this.sorters=t.slice(0)},e.inSorters=function(t,e){for(var r=0;r<t.length;r++)if(t[r].dataIndx==e)return r;return-1},e.sortLocalData=function(t){var e=this.sorters;return e.length||(e=[{dataIndx:"pq_order",dir:"up",dataType:"integer"}]),this._sortLocalData(e,t)},e.compileSorter=function(t,e){var r=this.that,o=r.columns,i=r.options,n=[],a=[],l=[],s=this.tmpPrefix,r=i.sortModel,d=r.useCache,h=r.ignoreCase,c=t.length;e=e||i.dataModel.data;for(var u=0;u<c;u++){var p=t[u],f=p.dataIndx,g=o[f]||{},v="up"==(p.dir=p.dir||"up")?1:-1,w=g.sortType,w=pq.getFn(w),m="string"==(m=g.dataType||p.dataType||"string")&&h?"stringi":m,g=d&&"date"==m,p=g?s+f:f;a[u]=p,l[u]=v,n[u]=w?function(i,n){return function(t,e,r,o){return n(t,e,r,o,i)}}(w,x.sort_sortType):"integer"==m||"float"==m?x.sort_number:"function"==typeof m?function(i,n){return function(t,e,r,o){return n(t,e,r,o,i)}}(m,x.sort_dataType):"date"==m?x["sort_date"+(g?"_fast":"")]:"bool"==m?x.sort_bool:"stringi"==m?x.sort_locale:x.sort_string,g&&this.useCache(e,m,f,p)}return this._composite(n,a,l,c)},e._composite=function(i,n,a,l){return function(t,e){for(var r=0,o=0;o<l&&0==(r=i[o](t,e,n[o],a[o]));o++);return r}},e._sortLocalData=function(t,e){if(!e)return[];if(!e.length||!t||!t.length)return e;var r=this.that,o=r.options.sortModel,i=this.compileSorter(t),n={sort_composite:i};return!1!==r._trigger("customSort",null,n)?e.sort(i):e=n.data,o.useCache&&setTimeout(this.removeCache(t,e),0),e},e.useCache=function(t,e,r,o){for(var i=x["get_"+e],n=t.length;n--;){var a=t[n];a[o]=i(a[r])}},e.removeCache=function(i,n){var a=this.tmpPrefix;return function(){for(var t=i.length;t--;){var e=i[t],r=a+e.dataIndx,o=n.length;if(o&&n[0].hasOwnProperty(r))for(;o--;)delete n[o][r]}}};var x={get_date:function(t){var e;return!t||isNaN(e=Date.parse(t))?0:e},sort_number:function(t,e,r,o){t=t[r],r=e[r];return((t=t?+t:0)-(r=r?+r:0))*o},sort_date:function(t,e,r,o){t=t[r],r=e[r];return((t=t?Date.parse(t):0)-(r=r?Date.parse(r):0))*o},sort_date_fast:function(t,e,r,o){return(t[r]-e[r])*o},sort_dataType:function(t,e,r,o,i){return i(t[r],e[r])*o},sort_sortType:function(t,e,r,o,i){return i(t,e,r)*o},sort_string:function(t,e,r,o){t=t[r]||"",e=e[r]||"",r=0;return e<t?r=1:t<e&&(r=-1),r*o},sort_locale:function(t,e,r,o){t=t[r]||"",r=e[r]||"";return t.localeCompare(r)*o},sort_bool:function(t,e,r,o){t=t[r],e=e[r],r=0;return t&&!e||!1===t&&null===e?r=1:(e&&!t||!1===e&&null===t)&&(r=-1),r*o}};pq.sortObj=x}(),function(t){function e(t){this.that=t,this.mc=null;var r=this,o=t.options;this.DM=o.dataModel,t.on("dataReady columnOrder groupShowHide",function(t,e){o.mergeCells&&"pager"!==e.source&&r.init()})}var r=(t.paramquery.cMerge=e).prototype=new t.paramquery.cClass;function y(t,e,r){var o=0,i=t.length;r=i<r?i:r;for(var n=e;n<r;n++)!0!==t[n].hidden&&o++;return o}function b(t,e,r){var o=0,i=t.length;r=i<r?i:r;for(var n=e;n<r;n++)!0!==t[n].pq_hidden&&o++;return o}r.init=function(){for(var t=this.that,e=t.colModel,r=t.options.mergeCells||[],o=t.get_p_data(),i=[],n=[],a=0,l=r.length;a<l;a++){var s,d,h=r[a],c=h.r1,u=c,p=o[c],f=h.c1,g=f,v=e[f],w=h.rc,m=h.cc;if(v&&p&&(v.hidden&&(g=function(t,e,r){for(var o=e;o<e+r;o++){var i=t[o];if(!i)return-1;if(!i.hidden)return o}}(e,f,m)),s=y(e,f,f+m),p.pq_hidden&&(u=function(t,e,r){for(var o=e;o<e+r;o++){var i=t[o];if(!i)return-1;if(!i.pq_hidden)return o}}(o,c,w)),!((d=b(o,c,c+w))<1||s<1))){i.push({r1:c,c1:f,rc:w,cc:m,e_rc:d,e_cc:s}),n[u]=n[u]||[];for(var x={show:!(n[u][g]={show:!0,rowspan:d,colspan:s,o_rowspan:w,o_colspan:m,style:h.style,cls:h.cls,attr:h.attr,r1:c,c1:f,v_r1:u,v_c1:g}),r1:c,c1:f,v_r1:u,v_c1:g},_=c;_<c+w;_++){n[_]=n[_]||[];for(var I=f;I<f+m;I++)_==u&&I==g||(n[_][I]=x)}}}t._mergeCells=0<n.length,this.mc=n,this.mc2=i},r.isHidden=function(t,e){this.that;var r,o=this.mc;return!(!(o&&o[t]&&(r=o[t][e]))||r.show)},r.setData=function(t,e,r){this.that;var o,i=this.mc;i[t]&&(o=i[t][e])&&(o.data=r)},r.getData=function(t,e,r){this.that;var o=this.mc;if(o[t]&&(i=o[t][e])){var i=i.data;return i?i[r]:null}},r.removeData=function(t,e,r){this.that;var o,i=this.mc;i&&i[t]&&(o=i[t][e])&&((o=o.data)&&(o[r]=null))},r.ismergedCell=function(t,e){this.that;var r=this.mc;if(r&&r[t]&&(i=r[t][e])){var o=i.v_r1,i=i.v_c1,i=r[o][i];return t!=i.r1||e!=i.c1||{rowspan:i.o_rowspan,colspan:i.o_colspan}}return!1},r.isRootCell=function(t,e,r){this.that;var o=this.mc;if(o&&o[t]&&(a=o[t][e])){if("o"==r)return t==a.r1&&e==a.c1;var i,n=a.v_r1,a=a.v_c1;return"a"==r?(i=o[n][a]).a_r1==t&&i.a_c1==e:n==t&&a==e?{rowspan:(i=o[n][a]).rowspan,colspan:i.colspan}:void 0}},r.getRootCell=function(t,e,r){var o,i=this.that,n=this.mc;if(n&&n[t]&&(o=n[t][e])){"a"==r?(t=o.v_r1,e=o.v_c1,(a=n[t][e]).a_r1&&(t=a.a_r1,e=a.a_c1)):e="o"==r?(t=o.r1,o.c1):(t=o.v_r1,o.v_c1);var n=i.colModel[e],a=i.rowIndxOffset,r=t-a;return r<0&&(r=0,t=a),{rowIndxPage:r,colIndx:e,column:n,dataIndx:n.dataIndx,rowData:i.getRowData({rowIndx:t}),rowIndx:t,rowspan:o.rowspan,colspan:o.colspan}}return i.normalize({rowIndx:t,colIndx:e})},r.inflateRange=function(t,e,r,o){var i=this.that,n=!1,a=i.options,l=a.groupModel.on?i.rowIndxOffset+i.pdata.length-1:a.dataModel.data.length-1,s=i.colModel.length-1,d=this.mc2;if(!d)return[t,e,r,o];t:for(var h=0,c=d.length;h<c;h++){var u=d[h],p=u.r1,f=u.c1,g=l<(g=p+u.rc-1)?l:g,u=s<(u=f+u.cc-1)?s:u;if((p<t&&t<=g||p<=r&&r<g)&&e<=u&&f<=o||(f<e&&e<=u||f<=o&&o<u)&&t<=g&&p<=r){n=!0,t=p<t?p:t,e=f<e?f:e,r=r<g?g:r,o=o<u?u:o;break t}}return n?this.inflateRange(t,e,r,o):[t,e,r,o]},t.paramquery.pqGrid.prototype.calcVisibleRows=b,r.renderCell=function(t){var e=this.that,r=t.rowIndx,o=t.rowIndxPage,i=t.colIndx,n=this.mc;if(n[r]&&(x=n[r][i])){var a=x.v_r1,l=x.v_c1,s=x.r1,d=x.c1,h=e.options,c=e.colModel,u=e.rowIndxOffset,p=h.freezeCols,f=h.freezeRows,g=f?f+u:0,v=e.initH,w=e.initV;if(!(x.show||i==l&&o==w&&g<=a||i==l&&r==w&&g<=a||r==a&&i==v&&p<=l||r==w&&i==v&&p<=l&&g<=a))return null;var m=s-u,x=e.pdata,o=e.get_p_data(),h={rowData:o[s],rowIndx:s,colIndx:d,column:c[d],rowIndxPage:m},e=n[a][l],s=e.colspan,d=e.rowspan,m=y(c,i,p),n=b(x,r-u,f);p&&i<p&&m<s?(v=s-y(c,p,v),s=Math.max(v,m)):s-=y(c,l,i),f&&u<r&&r<g&&n<d?(w=d-b(x,f,w),d=Math.max(w,n)):d-=b(o,a,r),e.a_r1=r,e.a_c1=i,h.rowspan=d,h.colspan=s,h.style=e.style,h.attr=e.attr,h.cls=e.cls}return h||t},r.getMergeCells=function(t,e,r){for(var o,i,n,a=this.that,l=a.options.mergeCells,s=a.rowIndxOffset,d=s+r,h=[],c=l?l.length:0,u=0;u<c;u++)i=(o=l[u]).r1,n=o.c1,(!e||s<=i&&i<d)&&(e&&(i-=s),h.push({r1:i+=t,c1:n,r2:i+o.rc-1,c2:n+o.cc-1}));return h}}(jQuery),function(){pq.extend=function(t,e,r){function o(){}o.prototype=t.prototype;var i,n=e.prototype=new o,a=t.prototype;for(i in r){var l=a[i],s=r[i];n[i]=l?function(r,o){return function(){var t,e=this._super;return this._super=function(){return r.apply(this,arguments)},t=o.apply(this,arguments),this._super=e,t}}(l,s):s}n.constructor=e,n._base=t,n._bp=function(t){var e=arguments;return Array.prototype.shift.call(e),a[t].apply(this,e)}};var i=pq.Range=function(t,e,r,o){if(null==t)throw"invalid param";if(this.that=t,this instanceof i==0)return new i(t,e,r,o);this._type=r||"range",this.init(e,o)},t=i.prototype;t._areas=[],t.init=function(t,e){if(e=!1!==e,t)if("function"==typeof t.push)for(var r=0,o=t.length;r<o;r++)this.init(t[r],e);else{var i,n=this._normal(t,e);n&&((i=this._areas).length?i.push(n):this._areas=[n])}},t.address=function(){return this.dirty&&this.refresh(),this._areas},t.areas=function(t){this.dirty&&this.refresh();var e=this.that,r=this._areas,r=null==t?r:r[t];return pq.Range(e,r,"area")},t.merge=function(t){t=t||{};var e,r,o=this.that,i=o.options.mergeCells,n=this._areas[0];n&&(e=n.r2-n.r1+1,r=n.c2-n.c1+1,(1<e||1<r)&&(n.rc=e,n.cc=r,i.push(n),!1!==t.refresh&&o.refreshView()))},t.unmerge=function(t){t=t||{};var e=this.that,r=e.options.mergeCells,o=this._areas[0];if(o){for(var i=0;i<r.length;i++){var n=r[i];if(n.r1==o.r1&&n.c1==o.c1){r.splice(i,1);break}}!1!==t.refresh&&e.refreshView()}},t.hide=function(t){t=t||{};for(var e=this.that,r=e.colModel,o=e.get_p_data(),i=this._areas,n=0,a=i.length;n<a;n++){var l=i[n],s=l.type,d=l.r1,h=l.r2,c=l.c1,u=l.c2;if("column"==s)for(var p=c;p<=u;p++)r[p].hidden=!0;else if("row"==s)for(p=d;p<=h;p++)o[p].pq_hidden=!0}!1!==t.refresh&&e.refreshView()},t.unhide=function(t){t=t||{};for(var e=this.that,r=e.colModel,o=e.get_p_data(),i=this._areas,n=0,a=i.length;n<a;n++){var l=i[n],s=l.type,d=l.r1,h=l.r2,c=l.c1,u=l.c2;if("column"==s)for(var p=c;p<=u;p++)r[p].hidden=!1;else if("row"==s)for(p=d;p<=h;p++)o[p].pq_hidden=!1}!1!==t.refresh&&e.refreshView()},t.select=function(){var t=this.that,e=t.iSelection,r=e._areas[0],o=this._areas,i=o[0];if(!i)return this;var n=i.r1,a=i.c1;if(e.dirty||1!=o.length||"block"!=o[0].type||!r||"cell"!=r.type&&"block"!=r.type||n!=r.r1||a!=r.c1){e.removeAll({trigger:!1});for(var l=0,s=o.length;l<s;l++)e.add(o[l],!1);e._trigger()}else{var d=r.r1,h=r.c1,c=r.r2,u=r.c2,r=i.r2,i=i.c2,t=t.iCells;if(r==c&&i==u)return this;u<i?t.selectBlock({range:{r1:n,c1:u+1,r2:r,c2:i}}):i<u&&t.selectBlock({range:{r1:Math.max(n,d),c1:i+1,r2:Math.max(r,c),c2:u},remove:!0}),c<r?t.selectBlock({range:{r1:c+1,c1:a,r2:r,c2:i}}):r<c&&t.selectBlock({range:{r1:r+1,c1:Math.max(a,h),r2:c,c2:Math.max(i,u)},remove:!0}),e._areas=o,e._trigger()}return this},t.resize=function(t,e){var r=this._areas[0],e={r1:r.r1,c1:r.c1,rc:t,cc:e};return i(this.that,e)},t.cut=function(t){return(t=t||{}).cut=!0,this.copy(t)},t.copy=function(t){t=t||{},this.dirty&&this.refresh();var e=this.that,r=t.dest,o=!!t.cut,i=null==t.copy||t.copy,n=t.source||(o?"cut":"copy"),a=null==t.history||t.history,l=null==t.allowInvalid||t.allowInvalid,s=[],d=[],h=e.get_p_data(),c=e.colModel,u=e.readCell,p=e.iMerge,f=this._areas;if(f.length){for(var g=this._areas[0],v=g.type,w=g.r1,m=g.c1,x="cell"==v?w:g.r2,_="cell"==v?m:g.c2,I=0;;){for(var y=w;y<=x;y++){for(var b=[],C=h[y],q={},M={},D=m;D<=_;D++){var R,P=c[D],T=P.dataIndx;!1!==P.copy&&(R=C[T],i&&b.push(u(C,P,p,y,D)),o&&(q[T]=void 0,M[T]=R))}o&&s.push({rowIndx:y,rowData:C,oldRow:M,newRow:q,type:"update"});var S=b.join("\t"),b=[];d.push(S)}if(g=f[++I],"row"!=v||!g||"row"!=g.type)break;w=g.r1,m=g.c1,x=g.r2,_=g.c2}i&&(S=d.join("\n"),t.clip?((t=t.clip).val(S),t.select()):e._setGlobalStr(S)),r?e.paste({dest:r,rowList:s,history:a,allowInvalid:l}):o&&!1!==e._digestData({rowList:s,source:n,history:a,allowInvalid:l})&&e.refresh({source:"cut"})}},t.clear=function(){return this.copy({copy:!1,cut:!0,source:"clear"})},t.add=function(t){this.init(t)},t._countArea=function(t){this.that;var e=t.type,r=t.r1,o=t.c1,i=t.r2,t=t.c2;return"cell"==e?1:(i-r+1)*(t-o+1)},t.count=function(){this.dirty&&this.refresh();this.that;for(var t="range"==this._type,e=this._areas,r=0,o=e.length,i=0;i<o;i++)r+=t?this._countArea(e[i]):1;return r},t.rows=function(t){this.dirty&&this.refresh();var e=this.that,r=[],o=this._areas[0];if(o)for(var i=o.r1,n=o.c1,a=o.r2,l=o.c2,s=o.type,d=null==t?a:i+t,h=null==t?i:i+t;h<=d;h++)r.push({r1:h,c1:n,r2:h,c2:l,type:s});return pq.Range(e,r,"row")},t.columns=function(t){this.dirty&&this.refresh();var e=this.that,r=[],o=this._areas[0];if(o)for(var i=o.r1,n=o.c1,a=o.r2,l=o.c2,s=o.type,d=null==t?l:n+t,h=null==t?n:n+t;h<=d;h++)r.push({r1:i,c1:h,r2:a,c2:h,type:s});return pq.Range(e,r,"column")},t.cell=function(t,e){this.dirty&&this.refresh();var r=this.that,o=[],i=this._areas[0];return i&&(o=[t=i.r1+t,e=i.c1+e,t,e]),pq.Range(r,o,"cell")},t.item=function(t){this.dirty&&this.refresh();this.that;for(var e,r,o,i=0,n=!1,a=this._areas,l=0,s=a.length;l<s;l++){var d=a[l],h=this._countArea(d);if(t<i+h){n=!0,t-=i;break}i+=h}if(n)return d&&(r=d.r1,o=d.c1,e=d.c2-o+1,r+=Math.floor(t/e),o+=t%e),{r1:r,c1:o}},t._normal=function(t,e){if(t.type)return t;if("function"==t.push){for(var r=[],o=0,i=t.length;o<i;o++){var n=this._normal(t[o],e);n&&r.push(n)}return r}var a,l,s=this.that,d=s.get_p_data().length-1,h=s.colModel.length-1,c=d<(c=t.r1)?d:c,u=h<(u=t.c1)?h:u,p=t.rc,f=t.cc,g=d<(g=t.r2)?d:g,v=h<(v=t.c2)?h:v,g=p?c+p-1:g,v=f?u+f-1:v;return h<0||d<0?null:(g<c&&(a=c,c=g,g=a),v<u&&(a=u,u=v,v=a),null!=c||null!=u?(null==c?(c=0,g=d,v=null==v?u:v,l="column"):null==u?(u=0,g=null==g?c:g,v=h,l="row"):null==g?(l="cell",g=c,v=u):l="block",e&&(c=(r=s.iMerge.inflateRange(c,u,g,v))[0],u=r[1],g=r[2],v=r[3]),t.r1=c,t.c1=u,t.r2=g,t.c2=v,t.type=t.type||l,t):void 0)},t.getValue=function(){var t,e,r,o,i,n,a,l,s,d,h=this.address(),c=[],u=this.that;if(h.length){for(o=(h=h[0]).r1,i=h.c1,n=h.r2,a=h.c2,d=u.get_p_data(),l=o;l<=n;l++)for(t=d[l],e=c[l-o]=[],s=i;s<=a;s++)r=t[u.colModel[s].dataIndx],e.push(r);return c}},t.value=function(t){var e=this.that,r=e.colModel,o=[],i=this.address();if(void 0===t)return this.getValue();for(var n="function"==typeof t.push,a=0;a<i.length;a++)for(var l,s=(l=i[a]).r1,d=l.c1,h=l.r2,c=l.c2,u=s;u<=h;u++){for(var p=e.normalize({rowIndx:u}),f=p.rowData,p=p.rowIndx,g={},v={},w=n?t[u-s]:t,m=d;m<=c;m++){var x=r[m].dataIndx,_=n?w[m-d]:t;v[x]=_,g[x]=f[x]}o.push({rowData:f,rowIndx:p,type:"update",newRow:v,oldRow:g})}return o.length&&(e._digestData({rowList:o,source:"range"}),e.refresh()),this};var o=pq.Selection=function(t,e){if(null==t)throw"invalid param";if(this instanceof o==0)return new o(t,e);(this.that=t).options;var r=this;t.on("dataReady columnOrder addColumn deleteColumn",function(t,e){"pager"!=e.source&&r.renew()}),this._base(t,e)},e={renew:function(){this.dirty=!0},isDirty:function(){return this.dirty}},r=function(t){t.shiftKey&&"pqGrid:mousePQUp"!=t.type||(this._trigger("selectEnd",null,{selection:this.selection()}),this.off("mousePQUp",r),this.off("keyUp",r))};e._trigger=function(){var t=this.that;this.dirty&&this.refresh(),t._trigger("selectChange",null,{selection:this}),t.off("mousePQUp",r),t.off("keyUp",r),t.on("mousePQUp",r),t.on("keyUp",r)},e.removeAll=function(t){t=t||{};var e=this.that;e.iCells.removeAll({refresh:!0}),e.iRows.removeAll({refresh:!0,all:!0}),!(this._areas=[])!==t.trigger&&this._trigger()},t.indexOf=function(t){this.dirty&&this.refresh(),t=this._normal(t);this.that;for(var e=t.type,r=t.r1,o=t.c1,i=t.r2,n=t.c2,a=this._areas,l=0,s=a.length;l<s;l++){var d=a[l];if(e==d.type&&r>=d.r1&&i<=d.r2&&o==d.c1&&n==d.c2)return l}return-1},e.add=function(t,e){var r=this.that,o=this._normal(t,!0),i=r.iCells,n=r.iRows,a=o.r1,l=o.c1,s=o.r2,t=o.type;0<=this.indexOf(o)||("row"==t?(!(r=this._areas).length||"row"==(t=(r=r[r.length-1]).type)&&a<=r.r2&&(this.dirty=!0),a<s?n.selectRange({range:o}):n.add({rowIndx:a})):"column"==t||"block"==t?i.selectBlock({range:o}):"cell"==t&&i.add({rowIndx:a,colIndx:l}),this._super(o),!1!==e&&this._trigger())},e._adjust=function(t){var e=this.that,r=e.get_p_data().length-1,o=e.colModel.length-1,i=t.r1,n=t.c1,a=r<(a=t.r2)?r:a,e=o<(e=t.c2)?o:e;return o<0||r<0||a<i||e<n?null:(t.r1=i,t.r2=a,t.c1=n,t.c2=e,t)},t.removeRow=function(t,e){var r,o=t.r1,i=t.r2,n=this._areas,a=this._areas[e],l=a.r1,t=a.r2;o==l&&i==t?n.splice(e,1):l<o?(a.r2=o-1,i<t&&(r=this._normal({r1:i+1,r2:t}),n.splice(e+1,0,r))):i<t&&(l<o&&(r=this._normal({r1:i+1,r2:t}),n.splice(e,0,r)),a.r1=i+1)},e.removeRow=function(t,e){var r=this.that,o=this._normal(t),i=this.indexOf(o);-1<i&&"row"==o.type&&o.r1==o.r2&&(r.iRows.remove({rowIndx:o.r1}),this._super(t,i),!1!==e&&this._trigger())},e.selectAll=function(t){var e,r=(t=t||{}).type,o=this.that,i=o.colModel,n=t.all,a=n?0:o.rowIndxOffset,t=n?o.options.dataModel.data.length-1:o.pdata.length-1,i=i.length-1,t=a+t;return"cell"==r?((e={r1:a,c1:0}).r2=t,e.c2=i,o.range(e).select()):((e={r1:a}).r2=t,n||this.removeRows({all:!1,trigger:!1}),o.iRows.selectRange({range:e}),(n=n?[]:this._areas).push({r1:a,c1:0,r2:t,c2:i,type:"row"}),this._areas=n,this._trigger()),this},e.removeRows=function(t){var e=this.that,r=(t=t||{}).all;e.iRows.removeAll({refresh:!0,all:t.all}),r?this._areas=[]:this.refresh(),!1!==t.trigger&&this._trigger()},e.refresh=function(){for(var t=this.that,e=[],r=t.colModel.length-1,o=t.get_p_data(),i=0,n=o.length;i<n;i++){var a,l=o[i];l&&(l.pq_cellselect=void 0,l.pq_rowselect?a?a.r2=i:a={r1:i,r2:i,c1:0,c2:r,type:"row"}:a&&(e.push(a),a=null))}a&&e.push(a),this.dirty=!1,this._areas=e},pq.extend(i,o,e)}(),function(g){var t=g.paramquery;t.pqGrid.defaults.groupModel={on:!1,title:[],titleDefault:"{0} ({1})",header:!0,headerMenu:!0,menuItems:["merge","fixCols","grandSummary"],fixCols:!0,icon:["ui-icon-triangle-1-se","ui-icon-triangle-1-e"],dataIndx:[],collapsed:[],dir:[],showSummary:[],calcSummary:[],summaryInTitleRow:"collapsed",summaryEdit:!0,refreshOnChange:!0},pq.aggregate={sum:function(t){for(var e,r=0,o=t.length;o--;)null!=(e=t[o])&&(r+=+e);return r},avg:function(t,e){return this.sum(t,e,!0)/t.length},max:function(t,e){e=e.dataType,t="float"==e||"integer"==e?Math.max.apply(Math,t):"date"==e?(t.sort(function(t,e){return t=Date.parse(t),e=Date.parse(e),isNaN(t)&&(t=0),(e=isNaN(e)?0:e)-t}),t[0]):(t.sort(),t[t.length-1]);return t},min:function(t,e){var r,o,i,n,e=e.dataType;if("integer"==e||"float"==e)r=Math.min.apply(Math,t);else if("date"==e){for(n=t.length,o=[];n--;)(i=t[n])&&o.push({dateO:i,dateP:Date.parse(i)});o.sort(function(t,e){return t.dateP-e.dateP}),r=o.length?o[0].dateO:void 0}else t.sort(),r=t[0];return r},count:function(t){return t.length}};var v=t.cGroup=function(t){(this.that=t).options.groupModel.on&&this.init()},e=v.prototype;e.init=function(){var t,e,r,o,i=this;i._init||(i.mc=[],i.tree=[],i.summaryData=[],t=(r=(o=i.that).options).groupModel,e=r.bootstrap.on,i.groupRemoveIcon="pq-group-remove "+(r=e?"glyphicon ":"ui-icon ")+(e?"glyphicon-remove":"ui-icon-close"),i.toggleIcon="pq-group-toggle "+r,o.on("cellClick",i.onCellClick(i)).on("cellKeyDown",i.onCellKeyDown(i,t)).on(!0,"cellMouseDown",i.onCellMouseDown()).on("change",i.onChange(i,t)).on("dataReady",i.onDataReady(i,o)).on("columnDragDone",i.onColumnDrag(i)).on("columnOrder",i.onColumnOrder(i)),i._init=!0)},e.onCellClick=function(r){return function(t,e){e.rowData.pq_gtitle&&g(t.originalEvent.target).hasClass("pq-group-icon")&&r.toggleRow(e.rowIndxPage,t)}},e.onChange=function(t,e){return function(){t.saveState(e.refreshOnChange)}},e.onCellMouseDown=function(){return function(t,e){e.rowData.pq_gtitle&&g(t.originalEvent.target).hasClass("pq-group-icon")&&t.stopImmediatePropagation()}},e.onCellKeyDown=function(r,o){return function(t,e){if(e.rowData.pq_gtitle&&0<=g.inArray(e.dataIndx,o.dataIndx)&&t.keyCode==g.ui.keyCode.ENTER)return r.toggleRow(e.rowIndxPage,t),!1}},e.showRows=function(){this.that.options.dataModel.data.forEach(function(t){t.pq_hidden&&(t.pq_hidden=void 0)})},e.removeGroup=function(t){for(var e=0,r=this.that.options.groupModel.dataIndx;e<r.length;e++)if(t===r[e]){r.splice(e,1);break}r.length||(this.showRows(),this.mc.length=0),this._triggerChange=!0,this.refreshFull()},e.addGroup=function(t,e){var r=this.that.options.groupModel,r=r.dataIndx=r.dataIndx||[];null!=t&&-1===g.inArray(t,r)&&(null==e?r.push(t):r.splice(e,0,t),this._triggerChange=!0,this.refreshFull())},e._initHeadSortable=function(){var t=this.that,e=this.$header,t=t.options;e.sortable({axis:"x",distance:3,tolerance:"pointer",cancel:".pq-group-menu",stop:this.onSortable(this,t)})},e.onColumnDrag=function(o){return function(t,e){var r=e.column,e=r.colModel;e&&e.length||!1===r.groupable?o.acceptDrop=!1:o._initHeadDroppable()}},e._initHeadDroppable=function(){var e=this,r=e.that,t=e.$header;t&&(t.droppable({accept:function(t){t=+t.attr("pq-col-indx");if(!isNaN(t)&&r.colModel[t])return e.acceptDrop},tolerance:"pointer",hoverClass:"pq-drop-hover",drop:e.onDrop(r,e)}),e.acceptDrop=!0)},e.onDrop=function(r,o){return function(t,e){e=+e.draggable.attr("pq-col-indx"),e=r.colModel[e].dataIndx;o.addGroup(e),o.acceptDrop=!1}},e.onSortable=function(d,h){return function(){for(var t=[],e=h.groupModel,r=e.dataIndx,o=[],i=!1,n=g(this).find(".pq-group-item"),a=0;a<n.length;a++){var l=g(n[a]),s=l.data("indx"),l=l.data("dir");r[a]!==s&&(i=!0),t.push(s),o.push(l)}i&&(e.dataIndx=t,e.dir=o,d._triggerChange=!0,d.refreshFull())}},e._initHeader=function(t,e){var r,o;this.$header&&(o=(r=this.$header).find(".pq-group-item"),r.data("uiSortable")||this._initHeadSortable(),o.length||r.append("<span class='pq-group-placeholder'>"+t.strGroup_header+"</span>"),e.headerMenu&&this._initHeaderMenu())},e.createHeader=function(){for(var t=this.that,e=this.$header,r=t.options,o=r.bootstrap,i=t.columns,n=o.on,a=r.groupModel,l=a.dataIndx,s=l.length;s--;)null==i[l[s]]&&l.splice(s,1);if(s=l.length,a.header&&a.on){if(e?e.empty():(e=this.$header=g("<div class='pq-group-header ui-helper-clearfix' ></div>").appendTo(t.$top)).on("click",".pq-group-item",v.onGroupItemClick(this)),s){for(var d=[],h=0;h<s;h++){var c=l[h],u=i[c],p=a.collapsed,f=(n?o.groupModel:a).icon,p=p[h]?f[1]:f[0],f=a.dir[h];d.push("<div tabindex='0' class='pq-group-item' data-indx='",c,"' data-dir='",f,"'>","<span class='",this.toggleIcon,p,"' ></span>",u.pqtitle||("string"==typeof u.title?u.title:c),"<span class='",this.groupRemoveIcon,"' ></span></div>")}e[0].innerHTML=d.join("")}this._initHeader(r,a)}else e&&(e.remove(),this.$header=null)},v.onGroupItemClick=function(o){return function(t){var e=g(t.target),r=g(this).data("indx");e.hasClass("pq-group-remove")?o.removeGroup(r):o.toggleLevel(r,t)}},e._initHeaderMenu=function(){for(var t,r=this.that,e=r.BS_on,o=r.options,i=this.$header,n=["<ul class='pq-group-menu'><li>",e?"<span class='glyphicon glyphicon-chevron-left'></span>":"","<ul>"],a=o.groupModel,l=a.menuItems,s=0,d=l.length;s<d;s++)t=l[s],n.push("<li data-option='",t,"' class='pq-menu-item'>","<label>","<input type='checkbox' ",a[t]?"checked":"","/>",o["strGroup_"+t],"</label></li>");n.push("</ul></li></ul>"),(i=g(n.join("")).appendTo(i)).menu({icons:{submenu:"ui-icon-carat-1-w"},position:{my:"right top",at:"left top"}}),i.change(function(t){var e;"INPUT"==t.target.nodeName&&((e={})[t=g(t.target).closest("li").data("option")]=!o.groupModel[t],r.groupOption(e))})},e.setOption=function(){this._init&&(this.refreshColumns(),this.summaryData.length=0,this.tree.length=0,this._initmerge())},e.onDataReady=function(r,o){return function(){r.tree.length=0;var t=o.options.groupModel,e=t.dataIndx.length;t.on&&(e||t.grandSummary)&&(r._groupData(),r.refreshColumns(),e&&(r._initcollapsed(),r._initmerge())),r.createHeader()}},e.onColumnOrder=function(t){return function(){t._initmerge()}},e.toggleLevel=function(t,e){var r=this.that.options.groupModel,o=r.collapsed,r=g.inArray(t,r.dataIndx),e=e.ctrlKey?"All":"";this[(o[r]?"expand":"collapse")+e](r)},e.collapseTo=function(t){this.expandTo(t,!0)},e.expandTo=function(t,e){var r,o,i,n,a=this.that,l=!!e,s=t.split(","),d=s.length,h=this.tree,c=0,u=a.pdata;if(!(d>h.length)){for(var p=0;p<d;p++){if(n=+s[p]+c,!(i=h[p][n])){if(0==p)return;break}i=i.rip,(!l||l&&p==d-1)&&(r=u[i]).pq_close!=l&&((o=r).pq_close=l),c=function(t,e,r,o){var i,n=t[e],a=o;if(n){for(;i=n[a].rip,a++,i<r;);return a-1}}(h,p+1,i,n)}o&&!1!==a._trigger("group",null,{indx:n,close:l})&&this.saveState(!0)}},e._editorSummary=function(t,s){var d=t.summaryOptions,h=this;return function(t){var e=t.rowData;if(e.pq_gsummary||e.pq_gtitle){var r,o,i,n=pq.aggregate,a=t.column,e=a.summary,e=e?e.edit:null,a=a.dataType,l=[""];if(-1<g.inArray(t.dataIndx,s.dataIndx))return!1;if(!s.summaryEdit&&!e||!1===e)return!1;for(i in"integer"==a||"float"==a?a="number":"date"!==a&&(a="string"),o=d[a].split(","),r=g.inArray,n)-1<r(i,o)&&l.push(i);return 1==l.length?!1:{type:"select",prepend:s.prepend,options:s.options||l,valueIndx:s.valueIndx,labelIndx:s.labelIndx,init:s.init||h._editorInit,getData:s.getData||h._editorGetData}}}},e._editorInit=function(t){var e=(t.column.summary||(t.column.summary={})).type;t.$cell.find("select").val(e)},e._editorGetData=function(t){var r=t.column,o=r.dataType,t=t.$cell.find("select").val();return r.summary.type=t,this.one("beforeValidate",function(t,e){e.allowInvalid=!0,e.track=!1,e.history=!1,r.dataType="string",this.one(!0,"change",function(t,e){r.dataType=o})}),t},e._renderTitle=function(t,n){var a=this.that,e=t.bootstrap,t=e.on,e=(t?e.groupModel:n).icon,l=t?["glyphicon "+e[0],"glyphicon "+e[1]]:["ui-icon "+e[0],"ui-icon "+e[1]];return function(t){var e,r,o,i=t.rowData;if(i.pq_gtitle&&null!=t.cellData)return e=i.pq_close,r=i.pq_level,o="function"==typeof(o=(o=n.title)[r]||n.titleDefault)?o.call(a,t):o.replace("{0}",t.cellData).replace("{1}",i.pq_items),{text:(t.Export?"":"<span class='pq-group-icon "+l[e?1:0]+"'></span>")+o,cls:"pq-group-title-cell",style:"text-align:left;"}}},e._renderSummary=function(i){var n=this.that;return function(t){var e,r,o=t.rowData;if(o.pq_gsummary||o.pq_gtitle)return r=(e=t.column).summary.type,"function"==typeof(o=i.summaryTitle[r])?o.call(n,t):("number"!=typeof(r=null==(r=t.formatVal)?null==(r=t.cellData)?"":r:r)||e.format||parseInt(r)===r||(r=r.toFixed(2)),o?o.replace("{0}",r):r)}},e.refreshColumns=function(){for(var t,e,r,o,i,n,a=this.that,l=a.options,s=l.groupModel,d=s.on,h=s.fixCols,c=s.dataIndx,u=c.length,p=a.colModel,f=p.length;f--;)(r=(o=p[f])._render)&&(r==o._renderGT?(delete o._renderGT,delete o._render):r==o._renderGS&&(delete o._renderGS,delete o._render)),o._nodrag&&(delete o._nodrag,delete o._nodrop),d&&(i=o.summary)&&i.type&&(e=e||this._renderSummary(l),o._render=o._renderGS=e);if(l.geditor=d?this._editorSummary(l,s):void 0,d)for(f=u-1;0<=f;f--)o=a.getColumn({dataIndx:c[f]}),t=t||this._renderTitle(l,s),o._renderGT=o._render=t;if(h&&d)for(f=0;f<u;f++)(o=p[n=a.getColIndx({dataIndx:c[f]})])._nodrag=o._nodrop=!0,n!=f&&(a.iDragColumns.moveColumn(n,f,!0),a.iColModel.init())},e.refreshFull=function(){var t=this.that;this.refreshColumns(),this._triggerChange&&(t._trigger("groupChange"),this._triggerChange=!1),t.refreshView()},e.refreshView=function(){this.that.refreshView()},e.collapseAll=function(t){this.expandAll(t,!0)},e.expandAll=function(t,e){!1!==this.trigger({all:!0,close:!!e,level:t||0})&&this.that.refreshView()},e.collapse=function(t){this.expand(t,!0)},e.expand=function(t,e){!1!==this.trigger({close:!!e,level:t||0})&&this.that.refreshView()},e.showHideRows=function(t,e,r){for(var o,i=this.that.pdata,n=t,a=i.length;n<a;n++)if((o=i[n]).pq_gsummary)r.merge||r.summaryInTitleRow?o.pq_level>=e&&(o.pq_hidden=!0):o.pq_level>e&&(o.pq_hidden=!0);else if(o.pq_gtitle){if(o.pq_level<=e)break;o.pq_hidden=!0}else o.pq_hidden=!0},v.beforeTrigger=function(e,r){return function(t){return!1===r._trigger("beforeGroupExpand",e,t)}},e.trigger=function(t){var e,r=t.evt,o=t.rd,i=t.level,n=t.all,a=t.close,l=this.that,s=l.options.groupModel,d=s.dataIndx,h=s.collapsed,c=v.beforeTrigger(r,l),t={};if(o){if(r=o[d[s=o.pq_level]],c(t={level:s,close:a=!o.pq_close,group:r}))return!1;o.pq_close=a}else if(n){if(c(t={all:!0,close:a,level:i}))return!1;for(e=i;e<d.length;e++)h[e]=a}else if(null!=i){if(c(t={level:i,close:a}))return!1;h[i]=a}return l._trigger("group",null,t)},e.toggleRow=function(t,e){t=this.that.pdata[t];!1!==this.trigger({evt:e,rd:t})&&this.saveState(!0)},e.saveState=function(t){var e=this.that,r=e.options.groupModel;if(r.on&&r.dataIndx.length){for(var o=e.pdata,i=o.length,n=new Array(i),a=0;a<i;a++)n[a]=o[a];this.pdata=n,t&&e.refreshView()}},e._initmerge=function(){for(var t,e,r,o,i,n=this.that,a=n.options,l=a.groupModel,s=l.dataIndx,d=n.colIndxs,h=l.merge,c=this.tree,u=n.rowIndxOffset,p=n.colModel.length,f=[],g=n.pdata,v=0;v<c.length;v++)for(var w=c[v],m=d[s[v]],x=0,_=w.length;x<_&&null!=(e=(t=w[x]).rip);x++)h?(r=t.rip2,f.push({r1:o=e+u,rc:r-e,c1:m,cc:1})):(o=e+u,i=g[e],(r=l.summaryInTitleRow)&&(i.pq_close||"collapsed"!==r)||f.push({r1:o,rc:1,c1:m,cc:p-m}));f.length?(this.mc=a.mergeCells=f,n.iMerge.init()):this.mc.length&&(this.mc.length=0,n.iMerge.init())},e._initcollapsed=function(){var t,e,r,o,i=this.that,n=i.options.groupModel,a=n.merge,l=this.pdata,s=i.pdata;if(s){for(var d=0,h=s.length;d<h;d++)void 0!==(t=s[d]).pq_gtitle&&(r=t.pq_level,(o=(o=null)==(o=l&&null!=(e=(e=l[d])?e.pq_close:null)?t.pq_close=e:o)?t.pq_close:o)?this.showHideRows(d+1,r,n):a&&(t.pq_hidden=!0));delete this.pdata}},e.setSumCols=function(r){var o=g.inArray,i=[],n=[];return this.that.colModel.forEach(function(t){var e=t.summary;e&&e.type&&(e=t.dataIndx,-1===o(e,r)&&(i.push(t),n.push(e)))}),this._sumCols=i,this._sumDIs=n,[i,n]},e.getSumCols=function(){return this._sumCols},e.getSumDIs=function(){return this._sumDIs},e.group=function(l){return function(t,o,i){var n={},a=[];return t.forEach(function(t){t.pq_hidden=void 0;var e=l(t,o,i),r=n[e];null==r&&(n[e]=r=a.length,a[r]=[e,[]]),a[r][1].push(t)}),a}},e.summary=function(a,t){var l=pq.aggregate,s=a.map(function(t){return t.summary.type});return function(e,i,n){t.forEach(function(r,t){var o=[];e.forEach(function(t,e){o[e]=t[r]}),t=l[s[t]](o,a[t]),i[r]=t,n&&(n[r]=t)})}},e.flatten=function(r,o,i,p){var f=i.dataIndx,g=this.concat(),v=this.tree=[],w=f.length,m=[];return function n(t,e,a){if(!w)return t;var l=e||0,s=f[l],d=i.collapsed[l],h=!1!==i.calcSummary[l],c=i.showSummary[l],u=v[l]=v[l]||[];return o(t,s,r[s]).forEach(function(t){var e=t[1],r=c?{pq_gsummary:!0,pq_level:l,pq_rowcls:"pq-summary-row"}:0,o=e.length,i=m.length,o={pq_gtitle:!0,pq_level:l,pq_close:d,pq_items:o,pq_children:[]};o[s]=t[0],m.push(o),a&&a.push(o),h&&p(e,o,r),l+1<w?n(e,l+1,o.pq_children):m=g(m,e,o),r&&m.push(r),u.push({rip:i,rip2:m.length})}),m}},e.concat=function(){return function(e,t,r){return t.forEach(function(t){e.push(t)}),r.pq_children=t,e}},e._getVal=function(o){var i=g.trim;return function(t,e,r){e=t[e],r=r.groupChange;return r?(r=pq.getFn(r))(e):(e=i(e),o?e.toUpperCase():e)}},e._groupData=function(){var t=this.that,e=t.options,r=e.groupModel,o=this._getVal(r.ignoreCase),i=r.dataIndx,n=t.pdata,a=t.columns,l=this.setSumCols(i),i=this.summary(l[0],l[1]);r.grandSummary?(i(n,l={pq_grandsummary:!0,pq_gsummary:!0}),this.summaryData=e.summaryData=[l]):this.summaryData.length=0,t.pdata=this.flatten(a,this.group(o),r,i)(n)};t=t.pqGrid.prototype;t.group=function(t){var e=this.iGroup;if(null==t)return e;e.expandTo(t.indx)},t.groupOption=function(t,e){var r=t.dataIndx,o=r?r.length:0,i=this.iGroup,n=this.options.groupModel,r=n.dataIndx;(t.on||null==t.on&&n.on)&&i.init(),n.on&&r.length&&(!1===t.on||0===o)&&i.showRows(),g.extend(n,t),i.setOption(),!1!==e&&this.refreshView()}}(jQuery),function(i){var t=i.paramquery;i(document).on("pqGrid:bootup",function(t,e){new r(e.instance)});var r=t.cScroll=function(t){var e=i(document);(this.that=t).one("refresh",this.oneRefresh(t,this,e,".pqgrid-csroll"))},t=(t.cScroll=r).prototype;t.oneRefresh=function(t,e,r,o){return function(){t.$cont.on("mousedown",function(t){i(t.target).closest(".pq-sb").length||(r.on("mousemove"+o,function(t){e.onMouseDrag(t)}),r.on("mouseup"+o,function(){r.off(o)}))})}},t.onMouseDrag=function(t){var e=this.that.$cont,r=e[0].offsetHeight,o=e[0].offsetWidth,i=e.offset(),n=i.top,a=i.left,l=n+r,s=a+o,d=t.pageY,e=t.pageX,i=d-l,r=e-s,o=n-d,t=a-e;a<e&&e<s&&(0<i||0<o)?0<i?this.scrollV(i,!0):0<o&&this.scrollV(o):n<d&&d<l&&(0<r?this.scrollH(r,!0):0<t&&this.scrollH(t))},t.scrollH=function(t,e){this[this.that.options.virtualX?"scrollVirtual":"scrollNV"](t,e,!0)},t.scrollV=function(t,e){this[this.that.options.virtualY?"scrollVirtual":"scrollNV"](t,e)},t.scrollVirtual=function(t,e,r){var o=this.that,i=r?o.hscrollbar():o.vscrollbar(),r=i.options,o=r.cur_pos,r=r.num_eles,t=Math.ceil(t/10);(o=o+Math.pow(5,t-1)*(e?1:-1))<0?o=0:r<=o&&(o=r-1),i.option("cur_pos",o).scroll()},t.scrollNV=function(t,e,r){var o=this.that,i=o.$tbl[0][r?"offsetWidth":"offsetHeight"],o=r?o.hscrollbar():o.vscrollbar(),i=(o.options.ratio*i+(e?t:-t))/i;1<i?i=1:i<0&&(i=0),o.option("ratio",i).drag()}}(jQuery),function(u){var t=u.paramquery;u(document).on("pqGrid:bootup",function(t,e){e=e.instance;e.iFillHandle=new r(e)}),t.pqGrid.defaults.fillHandle="all",t.pqGrid.defaults.autofill=!0;var r=t.cFillHandle=function(t){var e=this;e.$wrap,e.locked,e.sel,(e.that=t).on("selectChange",e.onSelectChange(e)).on("selectEnd",e.onSelectEnd(e)).on("refresh refreshRow",e.onRefresh(e))},t=r.prototype;t.onSelectChange=function(t){return function(){this.options.fillHandle&&t.create()}},t.onSelectEnd=function(t){return function(){this.options.fillHandle&&(t.setDraggable(),t.setDoubleClickable())}},t.onRefresh=function(t){var e;return function(){this.options.fillHandle&&(clearTimeout(e),e=setTimeout(function(){t.that.element&&(t.create(),t.setDraggable())},300))}},t.remove=function(){var t=this.$wrap;t&&t.remove()},t.create=function(){var t,e,r,o,i;this.locked||(this.remove(),1===(t=(i=this.that).selection().address()).length&&(e={rowIndx:r=(t=t[0]).r2,colIndx:o=t.c2},r=(t=i.iMerge).ismergedCell(r,o)?t.getRootCell(r,o,"a"):e,(o=i.getCell(r)).length&&!1!==i._trigger("beforeFillHandle",null,i.normalize(r))&&(e=o[0],o=(r=(i=o.closest(".pq-grid-cont-inner"))[0]).offsetTop,r=r.offsetLeft,r=e.offsetLeft+e.offsetWidth-8-r,o=e.offsetTop+e.offsetHeight-8-o,(i=u("<div class='pq-fill-handle'></div>").appendTo(i)).css({position:"absolute",top:o,left:r,height:10,width:10,background:"#333",cursor:"crosshair",border:"2px solid #fff"}),this.$wrap=i)))},t.setDoubleClickable=function(){var t=this.$wrap;t&&t.on("dblclick",this.onDblClick(this.that,this))},t.setDraggable=function(){var e=this,t=e.$wrap,r=e.that.$cont;t&&t.draggable({helper:function(){return"<div style='height:10px;width:10px;cursor:crosshair;'></div>"},appendTo:r,start:function(){e.onStart()},drag:function(t){e.onDrag(t)},stop:function(){e.onStop()}})},t.patternDate=function(r,o){var i=this;return function(t){var e=new Date(r);return e.setDate(e.getDate()+(o?1-t:t-1)),i.formatDate(e)}},t.formatDate=function(t){return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},t.patternDate2=function(r,t){var e,o=new Date(r),t=new Date(t),i=this,n=t.getDate()-o.getDate(),a=t.getMonth()-o.getMonth(),l=t.getFullYear()-o.getFullYear();return!a&&!l||!n&&!a||!l&&!n?function(t){var e=new Date(r);return n?e.setDate(e.getDate()+n*(t-1)):a?e.setMonth(e.getMonth()+a*(t-1)):e.setFullYear(e.getFullYear()+l*(t-1)),i.formatDate(e)}:(o=Date.parse(o),e=Date.parse(t)-o,function(t){t=new Date(o+e*(t-1));return i.formatDate(t)})},t.pattern=function(t,e,r){var o,i,n,a=t.length,e="date"===e;return 1===a?(o=t[0],e?this.patternDate(o,r):function(t){return o+(r?1-t:t-1)}):2===a?e?this.patternDate2(t[0],t[1]):(o=t[1]-t[0],i=t[0]-o,function(t){return o*t+i}):3===a&&(o=(t[2]-2*t[1]+t[0])/2,i=t[1]-t[0]-3*o,n=t[0]-o-i,function(t){return o*t*t+i*t+n})},t.autofillVal=function(t,e,r){var o,i,n,a,l,s,d=this.that,h=t.r1,c=t.c1,u=t.r2,p=t.c2,f=e.r2,e=e.r1,g=[],v=0;if(e<h){for(s=f-e+2,n=e;n<=h-1;n++)for(o=g[v++]=[],s--,i=0,a=c;a<=p;a++)o[i]=r[i](s),i++;l={r1:e,r2:h-1,c1:c,c2:p}}else if(u<f){for(s=u-h+1,n=u+1;n<=f;n++)for(o=g[v++]=[],s++,i=0,a=c;a<=p;a++)o[i]=r[i](s),i++;l={r1:u+1,r2:f,c1:c,c2:p}}return l&&d.range(l).value(g),!0},t.autofill=function(t,e){var r,o,i,n,a,l,s=this.that,d=s.colModel,h=s.get_p_data(),c=[],u=t.r1,s=t.c1,p=t.r2,f=t.c2,g=e.r1<u;if(e.c1==s&&e.c2==f){for(a=s;a<=f;a++){if("date"!=(l=(r=d[a]).dataType)&&"integer"!=l&&"float"!=l)return;if(i=r.dataIndx,o=[],g)for(n=p;u<=n;n--)o.push(h[n][i]);else for(n=u;n<=p;n++)o.push(h[n][i]);if(!(l=this.pattern(o,l,g)))return;c.push(l)}return this.autofillVal(t,e,c)}},t.onStop=function(){var t=this.that,e=t.options.autofill,r=this.sel,o=t.selection().address()[0];this.locked=!1,e&&this.autofill(r,o)||t.range(r).copy({dest:o})},t.onStart=function(){this.locked=!0,this.sel=this.that.selection().address()[0]},t.onDrag=function(t){var r,e,o=this.that,i=o.options.fillHandle,n="all"==i,a=n||"horizontal"==i,l=n||"vertical"==i,s=t.clientX-10,d=t.clientY,h=document.elementFromPoint(s,d),c=u(h).closest(".pq-grid-cell");c.length&&(e=o.getCellIndices({$td:c}),t=(i=this.sel).r1,s=i.c1,d=i.r2,h=i.c2,r={r1:t,c1:s,r2:d,c2:h},c=function(t,e){r[t]=e,o.range(r).select()},i=e.rowIndx,e=e.colIndx,n&&i<=d&&t<=i||a&&!l?h<e?c("c2",e):e<s&&c("c1",e):l&&(d<i?c("r2",i):i<t&&c("r1",i)))},t.onDblClick=function(l,s){return function(){var t=l.options,e=t.fillHandle;if("all"==e||"vertical"==e){for(var r,o=l.selection().address()[0],e=o.c2,i=o.r2+1,n=t.dataModel.data,a=l.getColModel()[e].dataIndx;r=n[i];){if(null!=r[a]&&""!==r[a]){i--;break}i++}s.onStart(),l.range({r1:o.r1,c1:o.c1,r2:i,c2:e}).select(),s.onStop()}}}}(jQuery);